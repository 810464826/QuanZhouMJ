require=function e(t,r,a){function s(o,n){if(!r[o]){if(!t[o]){var c="function"==typeof require&&require;if(!n&&c)return c(o,!0);if(i)return i(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var l=r[o]={exports:{}};t[o][0].call(l.exports,function(e){var r=t[o][1][e];return s(r?r:e)},l,l.exports,e,t,r,a)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<a.length;o++)s(a[o]);return s}({_node_hall_click:[function(e,t,r){"use strict";cc._RFpush(t,"f4051ImP89GALLJc26VKuDe","_node_hall_click"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){this.roomCradClickMsg="购买房卡请加微信：Xmaswell\n并附上您的玩家ID"},node_toggleBtnClick:function(){audio.play("waterClick")},node_createBtnClick:function(){audio.play("waterClick");var e=cc.find("createRoomAlert/alertContent/toggleGroup/toggle_size1",this.node).getComponent(cc.Toggle).isChecked,t=e?1:2,r=cc.find("createRoomAlert/alertContent/optionsGroup/zeRen",this.node).getComponent(cc.Toggle).isChecked,a=cc.find("createRoomAlert/alertContent/optionsGroup/yaoJiu",this.node).getComponent(cc.Toggle).isChecked,s=cc.find("createRoomAlert/alertContent/optionsGroup/xuanFeng",this.node).getComponent(cc.Toggle).isChecked,i=cc.find("createRoomAlert/alertContent/optionsGroup/baiJiu",this.node).getComponent(cc.Toggle).isChecked,o=cc.find("createRoomAlert/alertContent/optionsGroup/40Arim",this.node).getComponent(cc.Toggle).isChecked,n=[];r&&n.push(1),a&&n.push(2),s&&n.push(3),i&&n.push(4),o&&n.push(5),clientUser?clientUser.send({message:{ju:t,opt:n},type:"create"}):getGI("hall").errorReminder("未连接到服务器!")},node_helpAlert:function(e,t){if(audio.play("waterClick"),t="show"===t){var r=cc.find("helpAlert/alertContent/rulesContent/view/content",this.node);r.getChildByName("item1").getComponent(cc.Label).string=window.rules1,r.getChildByName("item2").getComponent(cc.Label).string=window.rules2,r.getChildByName("item3").getComponent(cc.Label).string=window.rules3}this.node.getChildByName("helpAlert").active=t,this.node.getChildByName("main").active=!t,t&&e.target.setScale(1)},node_recordAlertShow:function(e){audio.play("waterClick"),clientUser?clientUser.send({type:"record"}):getGI("hall").errorReminder("未连接到服务器!")},node_recordAlertBack:function(e){audio.play("waterClick"),getGI("hall").showRecordAlert("hide")},node_reminderAlert:function(e,t){audio.play("waterClick");var t="show"===t;if(e){var r=e.target.name;"addHouseCard"===r||"houseCardBox"===r?cc.find("reminderAlert/alertContent/reminderContent",this.node).getComponent(cc.Label).string=this.roomCradClickMsg:"headBox"===r&&(cc.find("reminderAlert/alertContent/reminderContent",this.node).getComponent(cc.Label).string=this.headClickMsg)}this._toggleAlert_("reminderAlert",t)},node_settingAlert:function(e,t){audio.play("waterClick"),t="show"===t,this._toggleAlert_("settingAlert",t)},node_addRoomAlert:function(e,t){audio.play("waterClick"),t="show"===t,this._toggleAlert_("addRoomAlert",t),t?e.target.setScale(1):getGI("hall").inputNumPanel.reset()},node_createRoomAlert:function(e,t){audio.play("waterClick"),t="show"===t,this._toggleAlert_("createRoomAlert",t),t&&e.target.setScale(1)},_toggleAlert_:function(e,t){var r=this.node.getChildByName(e);t?(cc.find("main/womanStar",this.node).active=!t,cc.find("main/operateBg",this.node).active=!t,TOOL.alertToggleAni(r,r.getChildByName("alertContent"),t)):TOOL.alertToggleAni(r,r.getChildByName("alertContent"),t,function(){cc.find("main/womanStar",this.node).active=!t,cc.find("main/operateBg",this.node).active=!t}.bind(this))}}),cc._RFpop()},{}],_node_login:[function(e,t,r){"use strict";cc._RFpush(t,"7d4a5SAC/lOTqh4HE/9kTrI","_node_login");var a=(logConfig(4),e("ajax"),e("audioPlay"));e("sendMessageMng"),e("controllerMap");cc.Class({"extends":cc.Component,properties:{audio_clip:cc.AudioClip},onLoad:function(){if(!audio){window.audio=new a({audio_clip:this.audio_clip,persons:["m1","g1"],others:"otherAudio"});var e=window.location.href.match(/state=(\d{6})/);e&&window.userInfo&&(window.userInfo.roomId=e[1]),TOOL.createSocket({type:"login",message:window.userInfo}),cc.director.preloadScene("room");window.addEventListener("online",function(){if(console.log("上线了"),console.log(socket),clientUser){var e=clientUser.attr("openId");TOOL.createSocket({type:"reConnect",openId:e},"reLink")}else TOOL.createSocket({type:"login",message:window.userInfo},"reLink");getGI("offlineAlert").showOfflineAlert("hide")}),window.addEventListener("offline",function(){console.log("下线了"),console.log(socket),getGI("offlineAlert").showOfflineAlert("show")})}}}),cc._RFpop()},{ajax:"ajax",audioPlay:"audioPlay",controllerMap:"controllerMap",sendMessageMng:"sendMessageMng"}],_node_operatePanelEvent:[function(e,t,r){"use strict";cc._RFpush(t,"3c798h6vqFKcqSiT342YgUF","_node_operatePanelEvent");var a=logConfig(4),s=cc.Class({"extends":cc.Component,properties:{operateNode:cc.Node},_addOperateClick_:function(){for(var e=this.operateNodeArr.length,t=0;t<e;t++)"touches"in cc.sys.capabilities?(a.log1("operatePanelEvent---touches"),this.operateNodeArr[t].on("touchstart",this._operateClickDown_,this),this.operateNodeArr[t].on("touchend",this._operateClickUp_,this)):"mouse"in cc.sys.capabilities&&(a.log1("operatePanelEvent---mouse"),this.operateNodeArr[t].on("mousedown",this._operateClickDown_,this),this.operateNodeArr[t].on("mouseup",this._operateClickUp_,this))},_operateClickDown_:function(e){clientUser.attr("isCanOperateClick")&&(this.startTime=new Date)},_operateClickUp_:function(e){if(clientUser.attr("isCanOperateClick")&&!(new Date-this.startTime>600)){var t=e.target.name.slice(-1);a.log1("选择的是 "+t+" 个");var r=clientUser.attr("operateArr")[t];return a.log1("选择的是 ",r),this.selectIndex=t,this.view=clientUser.mahjongMng.mahView,this.operateName=r.operateName,"chi"===this.operateName||"specialGang"===this.operateName?void this.view.setChiBox("toggle"):"specialBuGang"===this.operateName?void this.view.setSpecialBuBox("toggle"):void this._process_(r)}},specialBuClick:function(e){var t=e.target.name.slice(4);a.log1("选择的是 "+t+" 个");var r=clientUser.attr("operateArr"),s=r[this.selectIndex].operateCard[t],i=r[this.selectIndex].operateCard[s],o=r[this.selectIndex].from,n={operateName:this.operateName,from:o,operateCard:s,index:i};this._process_(n)},chiBoxClick:function(e){var t=e.target.name.slice(-1);a.log1("选择的是 "+t+" 个");var r=clientUser.attr("operateArr"),s=r[this.selectIndex].cards[t],i=r[this.selectIndex].operateCard,o=r[this.selectIndex].from,n={operateName:this.operateName,from:o,operateCard:i,cards:s};this._process_(n)},mahRunBack:function(e){clientUser&&clientUser.mahjongMng&&clientUser.mahjongMng.mahView&&clientUser.mahjongMng.mahView.mahRunBack()},_process_:function(e){switch(clientUser.attr("chooseIten",e),this.view.hidePanel(),e.operateName){case"guo":clientUser.attr("finishCheckClick")||(clientUser.send({type:"operateClick"}),clientUser.attr("finishCheckClick",!0)),this.view.outCardEventAttr("isCanOperate",!0),clientUser.mahjongMng.animate.processCardAni(e.operateName);break;case"hu":clientUser.attr("finishCheckClick")?"fromMe"===e.cardFromWho&&clientUser.operateItem(e):(clientUser.send({message:TOOL.convertOutCardClick(e),type:"operateClick"}),clientUser.attr("finishCheckClick",!0)),this.view.outCardEventAttr("isCanOperate",!1);break;case"chi":case"mingGang":case"pong":clientUser.attr("finishCheckClick")||(clientUser.send({message:TOOL.convertOutCardClick(e),type:"operateClick"}),clientUser.attr("finishCheckClick",!0)),this.view.outCardEventAttr("isCanOperate",!1);break;case"ting":clientUser.operateItem(e);break;case"buGang":clientUser.send({type:e.operateName,message:TOOL.convertOutCardClick(e)}),this.view.outCardEventAttr("isCanOperate",!1);break;case"specialBuGang":clientUser.send({type:e.operateName,message:TOOL.convertOutCardClick(e)}),this.view.outCardEventAttr("isCanOperate",!1);var t=clientUser.mahjongMng;t.mahModel.operateCard(e.operateCard,1,"sub");var r=t.mahModel.getHandCard();t.mahView.displayHand(r),t.animate.processCardAni(e.operateName);break;case"anGang":clientUser.operateItem(e),this.view.outCardEventAttr("isCanOperate",!0),this.view.outCardEventAttr("isCanPlay",!1);break;case"specialGang":e.childType=e.cards.name,clientUser.operateItem(e),clientUser.send({message:e,type:"specialGang"})}},onLoad:function(){this.startTime=null,this.operateNodeArr=this.operateNode.children,this._addOperateClick_()}});t.exports=s,cc._RFpop()},{}],ajax:[function(e,t,r){"use strict";cc._RFpush(t,"2e945eOiDxH6YIyWiFisvms","ajax");var a={async:!0,method:"POST",dataType:"JSON",url:"",ajax:function(e){if(e.async=e.async||this.async,e.method=e.method.toUpperCase()||this.method,e.dataType=e.dataType||this.dataType,e.url=e.url||this.url,!e.url)return!1;var t=null;if(t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHttp"),"GET"==e.method.toUpperCase()){var r=e.data?"?"+this.getStr(e.data):"";t.open(e.method,e.url+r,e.async),t.send(null)}else t.open(e.method,e.url,e.async),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(this.getStr(e.data));return t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){var r=t.responseText;"JSON"===e.dataType.toUpperCase()?"function"==typeof e.success&&e.success(JSON.parse(r)):"function"==typeof e.success&&e.success(r)}else"function"==typeof e.error&&e.error(t)},!0},getStr:function(e){var t;if(null==e)return"";if("string"==typeof e)return e;if("obj"==typeof e){t=[];for(var r in e)t.push(r+"="+e[r]);return t.join("&")}}};t.exports=a,cc._RFpop()},{}],animate_countDown:[function(e,t,r){"use strict";cc._RFpush(t,"dd6efLeyzBEH4GztYLlGM7x","animate_countDown");var a=logConfig(4),s=cc.Class({name:"Animate_countDown",ctor:function(){arguments[0];this.compon=getGI("roomGlobalRes"),this.timeBackNode=cc.find("Canvas/playingLayer/TimeBack"),this.timeLabel=this.timeBackNode.getChildByName("time").getComponent(cc.Label),this.timeBackArr=this.timeBackNode.children,this.callback=null,this.activeIndex=0},reset:function(){a.log4("animate_countDown.js重置了。"),this.stopTime(),this.activeIndex=0},timeShow:function(e){e="show"===e,this.timeBackNode.active=e;var t=cc.find("Canvas/bg/arithmetic");t.active=!0;var r=t.getComponent(cc.Widget);e?(r.isAlignRight=!1,r.isAlignTop=!1,r.isAlignVerticalCenter=!0,r.isAlignHorizontalCenter=!0,r.horizontalCenter=-121.1,r.verticalCenter=18.1,room.displayRoomInfo("arithmetic","changeAdd")):(r.isAlignRight=!0,r.isAlignTop=!0,r.isAlignVerticalCenter=!1,r.isAlignHorizontalCenter=!1,r.top=37.95,r.right=115.06,room.displayRoomInfo("arithmetic","changeSub"))},displayPointer:function(e,t){this.totalTime=30,this.callback&&this.compon.unschedule(this.callback),this.activeIndex!==-1&&(this.timeBackArr[this.activeIndex].stopAction(this.blinkAct),this.timeBackArr[this.activeIndex].stopAction(this.audioAct),this.blinkAct=null,this.audioAct=null),this.activeIndex=e;for(var r=0;r<4;r++)e===r?this.timeBackArr[r].active=!0:this.timeBackArr[r].active=!1;e===-1?this.timeLabel.string=this.totalTime:(this.callback=this._timerCallback_.bind(this),this.compon.schedule(this.callback,1))},_timerCallback_:function(){this.timeLabel.string=this.totalTime--,this.totalTime<=0&&(audio.play("naozhong"),this.compon.unschedule(this.callback),this.blinkAct=this.timeBackArr[this.activeIndex].runAction(cc.repeatForever(cc.blink(20,20))),this.audioAct=this.timeBackArr[this.activeIndex].runAction(cc.repeatForever(cc.sequence(cc.delayTime(10),cc.callFunc(function(){audio.play("naozhong")})))),this.totalTime=0)},stopTime:function(){this.compon.unschedule(this.callback)}});t.exports=s,cc._RFpop()},{}],animate_head:[function(e,t,r){"use strict";cc._RFpush(t,"50062crUahHQYS1LhucDD39","animate_head");var a=logConfig(4),s=cc.Class({name:"Animate_head",ctor:function(){this.originalP=[],this._recordOriginalP_()},recoverOriginalP:function(){a.log4("执行了函数 recoverOriginalP");for(var e,t,r=0;r<4;r++){e=cc.find("Canvas/bg/user"+r).getComponent(cc.Widget),t=this.originalP[r];for(var s in t)e[s]=t[s]}},reset:function(){console.log(12121212),a.log4("animate_head.js重置了。"),this.recoverOriginalP()},runHead:function(){a.log4("执行了函数 runHead");var e=cc.find("Canvas").getComponent(cc.Animation);e.off("finished",this.finishedFunc),e.play("userHeadMove")},offFinish:function(){var e=cc.find("Canvas").getComponent(cc.Animation);e.off("finished",this.finishedFunc)},runHeadNoTime:function(e){this.finishedFunc=e;var t=cc.find("Canvas").getComponent(cc.Animation);e&&t.on("finished",e);var r=t.getAnimationState("userHeadMove").duration;t.play("userHeadMove",r)},_recordOriginalP_:function(){for(var e,t=0;t<4;t++)switch(e=cc.find("Canvas/bg/user"+t).getComponent(cc.Widget),t){case 0:this.originalP.push({left:e.left,bottom:e.bottom});break;case 1:case 2:this.originalP.push({left:e.left,top:e.top});break;case 3:this.originalP.push({right:e.right,top:e.top})}}});t.exports=s,cc._RFpop()},{}],animate_operate:[function(e,t,r){"use strict";cc._RFpush(t,"7c57fv+MitG4bBGchrIAL35","animate_operate");var a=logConfig(4),s=cc.Class({name:"Animate_operate",ctor:function(){var e=arguments[0];this.userNode=e.userSelf.attr("userNode"),this.mainGame_Atlas=e.userSelf.attr("gameMain_Atlas"),this.others_Atlas=e.userSelf.attr("others_Atlas"),this.operateCardNode=this.userNode.getChildByName("operateWord")},reset:function(){a.log4("animate_operate.js重置了。"),this._processCardAniReset_()},processCardAni:function(e,t){a.log1("碰.杠.胡、吃的动画///////////////////",e),this._processCardAniReset_(),this._setOperateWord_(this.operateCardNode,e);var r=cc.callFunc(function(){audio.play("down"),t&&t(),a.log1("操作动画完成....")},this);this.operateCardNode.runAction(cc.sequence(cc.scaleTo(.8,1.2/this.userNode.scaleX,1.2/this.userNode.scaleX),cc.delayTime(.8),cc.fadeOut(1.5),r))},_processCardAniReset_:function(){this.operateCardNode.scaleX=0,this.operateCardNode.scaleY=0,this.operateCardNode.opacity=255,this.operateCardNode.active=!0},_setOperateWord_:function(e,t){var r;switch(t){case"guo":r="button_guo";break;case"pong":r="eff_peng";break;case"chi":r="eff_chi";break;case"buGang":case"anGang":case"mingGang":r="eff_gang";break;case"specialGang":r="liangxiAni";break;case"specialBuGang":r="effect_buGang";break;case"hu":r="eff_hu";break;case"ting":r="button_ting"}"ting"===t||"guo"===t||"specialGang"===t||"specialBuGang"===t?e.getComponent(cc.Sprite).spriteFrame=this.mainGame_Atlas.getSpriteFrame(r):e.getComponent(cc.Sprite).spriteFrame=this.others_Atlas.getSpriteFrame(r)}});t.exports=s,cc._RFpop()},{}],animate_outCard:[function(e,t,r){"use strict";cc._RFpush(t,"df9306hKk9LapY1wJMUSbPB","animate_outCard");var a=logConfig(4),s=cc.Class({name:"Animate_outCard",ctor:function(){var e=arguments[0];this.userSelf=e.userSelf,this.userNode=e.userSelf.attr("userNode"),this.cards_Atlas=e.userSelf.attr("cards_Atlas"),this.outCardPosition=null,this.nextNode=null,this.handCardHeight=cc.p(0,cc.find("hand/handmah_0",this.userNode).height/2),this.outCardBig=this.userNode.getChildByName("outCard"),this.outCardCoord=this.outCardBig.getPosition(),this.outCardScaleX=this.outCardBig.scaleX,this.outCardScaleY=this.outCardBig.scaleY,this.out1Node=this.userNode.getChildByName("out1"),this.scale=this.out1Node.getChildByName("mingmah_0").width/this.outCardBig.width},reset:function(){a.log4("animate_outCard.js重置了。"),this._outCardReset_()},outCardAni:function(e,t,r){this.nextNode=e,this.callback=r,this.outCardPosition=e.getPosition(),this._outCardReset_(),this.outCardBig.getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame("mingmah_"+t),this.outCardBig.active=!0,this.outCardBig.runAction(cc.sequence(cc.delayTime(.8),cc.spawn(cc.moveTo(.4,this._calcChildToGrand_(this.nextNode.parent,this.outCardPosition)),cc.scaleTo(.4,this.out1Node.scaleX,this.out1Node.scaleX)),cc.callFunc(this._outCardAniFinish_,this)))},_calcChildToGrand_:function(e,t){return t.mul(e.scaleX).add(e.getPosition())},_outCardAniFinish_:function(){a.log1("出牌动画完成、、、、"),audio.play("give");var e="mingmah_"+this.userSelf.mahjongMng.mahView.getOutPointerIndex();this.nextNode.active=!0;var t=this;this.nextNode.name!==e&&setTimeout(function(){t.nextNode.active=!1,room.finishOutSkipAni()},200),this.outCardBig.active=!1;var r;r=-1!==this.userNode.name.search(/[013]/)?this.outCardPosition.add(this.handCardHeight.mul(.5)):this.outCardPosition.add(this.handCardHeight);var s=this._calcChildToGrand_(this.nextNode.parent,r),i=this._calcChildToGrand_(this.userNode,s),o=this._calcChildToGrand_(this.userNode.parent,i);this.callback&&this.callback(o)},_outCardReset_:function(){this.outCardBig.setPosition(this.outCardCoord),this.outCardBig.scaleX=this.outCardScaleX,this.outCardBig.scaleY=this.outCardScaleY}});t.exports=s,cc._RFpop()},{}],animate_skip:[function(e,t,r){"use strict";cc._RFpush(t,"98c8aenePxOrbRgp9nTNJ4u","animate_skip");var a=cc.Class({name:"Animate_skip",ctor:function(){this.animState=null,this.jumpNode=cc.find("Canvas/playingLayer/jump"),this.animateNode=this.jumpNode.getChildByName("play_biaoji")},reset:function(){this.finishOutSkipAni(),this.animState=null},playOutSkipAni:function(e){this.animState&&this.animState.isPlaying?this.jumpNode.setPosition(e):(this.jumpNode.active=!0,this.jumpNode.setPosition(e),this.animState=this.animateNode.getComponent(cc.Animation).play("play_biaoji"))},finishOutSkipAni:function(){this.animateNode.getComponent(cc.Animation).stop("play_biaoji"),this.jumpNode.active=!1}});t.exports=a,cc._RFpop()},{}],audioMng:[function(e,t,r){"use strict";cc._RFpush(t,"e01a17A4LlMQbbkpcRE7BCC","audioMng");var a=cc.Class({name:"AudioMng",ctor:function(){var e=arguments[0];this.dir=e.dir,this.extend=e.extend,this.volumeEffectArr=[]},play:function(e,t,r){t=t||!1,e.match(/\./)||(e+=this.extend),this[e]=cc.audioEngine.play(this.dir+"/"+e,t,r),"playingBg.mp3"===e&&this.volumeEffectArr.push(this[e])},setDir:function(e){e&&(this.dir=e)},stop:function(e){void 0!==this[e]&&(cc.audioEngine.stop(this[e]),delete this[e])},setBgVolume:function(e){for(var t=this.volumeEffectArr,r=0;r<t.length;r++)cc.audioEngine.setVolume(t[r],e)},stopBgMusic:function(){for(var e=this.volumeEffectArr,t=0;t<e.length;t++)cc.audioEngine.stop(e[t]);e.length=0}});t.exports=a,cc._RFpop()},{}],audioPlay:[function(e,t,r){"use strict";cc._RFpush(t,"ada51gpEIJP2pELrYxqLUib","audioPlay");var a=e("log"),s=new a(4);s.setOutLevel(4);var i=e("audioMng"),o=cc.Class({name:"AudioPlay",ctor:function(){var e=arguments[0];this.audioDir=this._getDir(e.audio_clip,2),s.log1("所有音频的根目录: "+this.audioDir),this.sizeVolume=getGI("sizeVolume"),this.effectVolume=getGI("effectVolume");for(var t=0;t<e.persons.length;t++)this["audioMng"+e.persons[t].toUpperCase()]=new i({dir:this.audioDir+e.persons[t],extend:e.extension||getGI("extension")});this.audioMng=new i({dir:this.audioDir+e.others,extend:e.extension||getGI("extension")})},play:function(e,t,r,a){"string"==typeof arguments[1]?(a="playingBg.mp3"===t?a||this.effectVolume:a||this.sizeVolume,this._playMah(e,t,r,a)):(a="playingBg.mp3"===t?r||this.effectVolume:r||this.sizeVolume,this.audioMng.play(e,t,a))},setBgVolume:function(e){this.audioMng.setBgVolume(e)},stopBgMusic:function(){this.audioMng.stopBgMusic()},_playMah:function(e,t,r,a){switch(e.toUpperCase()){case"M1":this.audioMngM1.play(t,r,a);break;case"G1":this.audioMngG1.play(t,r,a);break;default:this.audioMngM1.play(t,r,a)}},_getDir:function(e,t){for(var r=e.split("/"),a=0;a<t;a++)r.pop();var s=r.join("/")+"/";return s}});t.exports=o,cc._RFpop()},{audioMng:"audioMng",log:"log"}],buGangCheck_controller:[function(e,t,r){"use strict";cc._RFpush(t,"42b5aleTAhH3pFt72I9vYsq","buGangCheck_controller");var a=logConfig(4),s=cc.Class({name:"BuGangCheck_controller",ctor:function(){},wantBuGang_controller:function(e){a.log2("执行 wantBuGang_controller...");var t=e.message.m,r={};r.operateName=e.type,r.operateCard=t.c,r.index=t.index,r.from=t.from;var s=e.message.p;if(!room.msgIsMeSend(s)){if("specialBuGang"===window.messageType[t.t]){var i=room.getUser(s),o=i.mahjongMng;o.mahModel.operateCard(r.operateCard,1,"sub");var n=o.mahModel.getHandCard();o.mahView.displayHand(n)}clientUser.othersBuGangCheck({type:50,message:r,openId:s})}room.displayPointer(-1),socket.finishMsg("wantBuGang")}});t.exports=s,cc._RFpop()},{}],calcHuMngFlow:[function(e,t,r){"use strict";cc._RFpush(t,"451ef7NH6RGB4n8t6GMDCSW","calcHuMngFlow");var a=logConfig(4),s=e("cardFace_common"),i=e("cardsHu_pair"),o=cc.Class({name:"calcHuMngFlow",ctor:function(){var e=arguments[0];this.cardsMng=e.cardsMng,this.cardsHu_pair=new i({cardsMng:this.cardsMng}),this.cardFace_common=new s({cardsMng:this.cardsMng}),this.hasCalcHuFirst=!1,this.statisticsArr=[],this.allHuCardsArr=[]},reset:function(){a.log4("calcHuMng.js重置了。")},getAllCanHuCards:function(){this.cardsMng.cardSpecialGang();this.hasCalcHuFirst=!0,this.allHuCardsArr.length=0;var e=this.cardFace_common.getJiao();if(e.isNeedContinue)this.allHuCardsArr.push(e.resultArr[0]),a.log1("对对胡胡牌的结果："+this.allHuCardsArr);else if("true"===this._calcOnce_())this._calcPairType(!0),a.log1("平胡胡牌的结果：",this.allHuCardsArr);else if("oneNineFalse"===this._calcOnce_()){this._calcPairType(!0);for(var t=[],r=0;r<this.allHuCardsArr.length;r++)for(var s=this.allHuCardsArr[r].huCard,i=0;i<s.length;i++)"1"!==s[i].charAt(1)&&"9"!==s[i].charAt(1)||t.push(this.allHuCardsArr[r]);this.allHuCardsArr=t,a.log1("缺1、9时平胡胡牌的结果：",this.allHuCardsArr)}return this._convertToJiaoArr(),a.log1("getAllCanHuCards： 本次教的检查的结果：",this.allHuCardsArr),this.allHuCardsArr},_calcOnce_:function(){var e=this.cardsMng.cardHaveThreeColor(),t=this.cardsMng.cardHaveOneNine(),r=this.cardsMng.cardHaveArrow(),a="false";return e&&(a=t||r?"true":"oneNineFalse"),a},getAllJiao:function(){return this.statisticsArr.length>0&&this.statisticsArr},checkHasHu:function(e){for(var t=0;t<this.statisticsArr.length;t++)if(this.statisticsArr[t]===e)return!0;return!1},huResultForEach:function(e,t){t=t||this;for(var r,a=this.allHuCardsArr,s={type:"",huCardArr:null,huDetail:null,i:0},i=0;i<a.length;i++)switch(s.type=a[i].name,s.huCardArr=a[i].huCard,s.huDetail=a[i],s.i=i,r=e.call(t,s)){case"break":break;case"continue":continue}},_calcPairType:function(e){var t=0;this.cardsMng.forEach(function(r){if("continueInner"===this._skip.call(this,r))return"continueInner";var s=this.cardsHu_pair.checkHasHu(r.cardName,e);a.log2("getAllCanHuCards：检查的结果是：",s),s&&(t++,s.huCard=[r.cardName],s.name="jiang"+t,this.allHuCardsArr.push(s))},this)},_convertToJiaoArr:function(){var e=this.allHuCardsArr;if(this.statisticsArr=[],e.length>0)for(var t=0;t<e.length;t++)this.statisticsArr=this.statisticsArr.concat(e[t].huCard)},_skip:function(e){var t=(e.i,e.j),r=e.typeName,a=e.arr;if(!("o"!==r&&"t"!==r&&"w"!==r||0!==e.num&&3!==e.num)){if(!(0!==a[t-1]&&void 0!==a[t-1]||0!==a[t+1]&&void 0!==a[t+1]))return"continueInner";if(!(0!==a[t-1]&&void 0!==a[t-1]||0!==a[t+2]&&void 0!==a[t+2]))return"continueInner";if(!(0!==a[t-2]&&void 0!==a[t-2]||0!==a[t+1]&&void 0!==a[t+1]))return"continueInner"}}});t.exports=o,cc._RFpop()},{cardFace_common:"cardFace_common",cardsHu_pair:"cardsHu_pair"}],calcHuMng:[function(e,t,r){"use strict";cc._RFpush(t,"4996fXJudhDhbPJN2ph/dzs","calcHuMng");var a=logConfig(0),s=e("cardsHu_pair"),i=e("cardsHu_other"),o=cc.Class({name:"calcHuMng",ctor:function(){var e=arguments[0];this.cardsMng=e.cardsMng,this.cardsHu_pair=new s({cardsMng:this.cardsMng}),this.cardsHu_other=new i({cardsMng:this.cardsMng}),this.hasCalcHuFirst=!1,this.statisticsArr=[],this.allHuCardsArr=[]},reset:function(){a.log4("calcHuMng.js重置了。")},getAllCanHuCards:function(){this.hasCalcHuFirst=!0,a.log1("getAllCanHuCards-手中的牌是： "+this.cardsMng.getAllCardsStr()),this.allHuCardsArr.length=0;var e=this.cardsHu_other.getJiao();return e.isNeedContinue?(this._calcPairType(),this._convertToJiaoArr(),a.log1("cardsHu: 有教的计算结果："),a.log1(this.allHuCardsArr),this.allHuCardsArr):void this.allHuCardsArr.push(e.resultArr)},getAllJiao:function(){return this.statisticsArr.length>0&&this.statisticsArr},checkHasHu:function(e){for(var t=0;t<this.statisticsArr.length;t++)if(this.statisticsArr[t]===e)return!0;return!1},huResultForEach:function(e,t){t=t||this;for(var r,a=this.allHuCardsArr,s={type:"",huCardArr:null,huDetail:null,i:0},i=0;i<a.length;i++)switch(s.type=a[i].name,s.huCardArr=a[i].huCard,s.huDetail=a[i],s.i=i,r=e.call(t,s)){case"break":break;case"continue":continue}},_calcPairType:function(){var e=0;this.cardsMng.forEach(function(t){if("continueInner"===this._skip.call(this,t))return"continueInner";var r=this.cardsHu_pair.checkHasHu(t.cardName);a.log2("getAllCanHuCards：检查的结果是：",r),r&&(e++,r.huCard=[t.cardName],r.name="jiang"+e,this.allHuCardsArr.push(r))},this)},_convertToJiaoArr:function(){var e=this.allHuCardsArr;if(this.statisticsArr=[],e.length>0)for(var t=0;t<e.length;t++)this.statisticsArr=this.statisticsArr.concat(e[t].huCard)},_skip:function(e){var t=(e.i,e.j),r=e.typeName,a=e.arr;if(!("o"!==r&&"t"!==r&&"w"!==r||0!==e.num&&3!==e.num)){if(!(0!==a[t-1]&&void 0!==a[t-1]||0!==a[t+1]&&void 0!==a[t+1]))return"continueInner";if(!(0!==a[t-1]&&void 0!==a[t-1]||0!==a[t+2]&&void 0!==a[t+2]))return"continueInner";if(!(0!==a[t-2]&&void 0!==a[t-2]||0!==a[t+1]&&void 0!==a[t+1]))return"continueInner"}}});t.exports=o,cc._RFpop()},{cardsHu_other:"cardsHu_other",cardsHu_pair:"cardsHu_pair"}],calcHuType:[function(e,t,r){"use strict";cc._RFpush(t,"18a80NkhC9JnIJMVxhDPr7t","calcHuType");var a=e("log"),s=new a(4);s.setOutLevel(1);var i=cc.Class({name:"CalcHuType",ctor:function(){var e=arguments[0];this.handCards=e.handCards,this.operateCards_operate=e.operateCards_operate,this.isSameClr=!1,this.whichSameColor=""},reset:function(){},isZiPaiOne:function(){var e=!0;return this.handCards.multiCardTypeForEach("f","j",function(t){if(1!==t.num)return e=!1,"breakOuter"}),e},isSameColor:function(){var e,t,r,a,s=this.operateCards_operate.staticsCardsShow();return e=s[1]||this.handCards.getCardNumFromType("o")?1:0,r=s[2]||this.handCards.getCardNumFromType("t")?1:0,e+r<=1&&(t=s[3]||this.handCards.getCardNumFromType("w")?1:0,e+r+t<=1&&(a=s[0]||this.handCards.getCardNumFromType("f")||this.handCards.getCardNumFromType("j")?1:0,e+r+t+a<=1))?(1===e&&(this.whichSameColor="o"),1===r&&(this.whichSameColor="t"),1===t&&(this.whichSameColor="w"),1===a&&(this.whichSameColor="z"),this.isSameClr=!0,this.whichSameColor):(this.isSameClr=!1,!1)},isPengPengHu:function(){var e=!0;return this.handCards.forEach(function(t){if(1===t.num||4===t.num)return e=!1,"breakOuter"}),e=e&&!this.operateCards_operate.isHasOperate("chi")}});t.exports=i,cc._RFpop()},{log:"log"}],calcScore:[function(e,t,r){"use strict";cc._RFpush(t,"94aaftRV31IQ78BIULnWe2q","calcScore");var a=logConfig(4),s=cc.Class({name:"CalcScore",ctor:function(){var e=arguments[0];this.userSelf=e.userSelf,this.mahjongMng=this.userSelf.mahjongMng,this.mahModel=this.mahjongMng.mahModel,this.huTypeObj={color:"other_color",fourNum:0,type:null,card:null,from:null},this.typeResult={optType:"normal",huCardState:"",isHasOutCard:!1,isQianShao:!1,isTing:!1,isZhuang:!1}},reset:function(){this.huTypeObj={color:"other_color",fourNum:0,type:null,card:null,from:null},this.typeResult={optType:"normal",huCardState:"",isHasOutCard:!1,isQianShao:!1,isTing:!1,isZhuang:!1}},getHuType:function(){var e=this.huTypeObj,t=this.userSelf.attr("huInfoArr");return t[0]?(e.card=t[0].huCard,e.from=t[0].cardFrom,this.mahModel.huResultForEach(function(t){for(var r=t.huCardArr,a=0;a<r.length;a++)if(r[a]===e.card)return this._setType_(e,t.type),this._setColor(e),this._setFourNum_(e),"break"},this),e):e},getType:function(e){var t=this.typeResult;t.isTing=this.userSelf.attr("ting"),t.isZhuang=this.userSelf.attr("zhuang");var r=this.userSelf.attr("firstOutCard");t.isHasOutCard=""!==r;var a=0;room.forEach(function(e,t){return e.attr("firstOutCard")!==r?"break":void a++}),t.isQianShao=4===a;var s=this.userSelf.attr("huInfoArr"),i=s[0];return i?"jiePao"===i.huType?t.optType="jiePao":"zimo"===i.huType&&(t.optType="zimo",this.mahModel.operateCard(i.huCard,1,"sub")):e&&e.message.from===this.userSelf.attr("openId")?t.optType="fangPao":t.optType="normal",t},_setFourNum_:function(e){var t=this.mahModel.staticsCardsHand();a.log3("4个的统计：",t),e.fourNum=t[4]},_setType_:function(e,t){switch(t){case"thirty":this.mahModel.operateCard(e.card,1,"add"),this.mahModel.isZiPaiOne()?e.type="sevenThirty":e.type="thirty",this.mahModel.operateCard(e.card,1,"sub");break;case"sevenPair":e.type="sevenPair";break;case"jiaHu":e.type="jiaHu";break;default:this.mahModel.operateCard(e.card,1,"add"),this.mahModel.isPengPengHu()?e.type="pengPengHu":e.type="pingHu",this.mahModel.operateCard(e.card,1,"sub")}if(console.log("所有的教是： ",this.mahModel.getAllJiao()),"pengPengHu"!==e.type){var r=this.mahModel.getAllJiao().length;1===r?e.type="jHu":e.type="piHu"}a.log1("胡牌的类型："+e.type)},_setColor:function(e){var t;(t=this.mahModel.isSameColor())?"z"===t?e.color="word_color":e.color="same_color":e.color="other_color",a.log1("胡牌的清一色计算： "+e.color)}});t.exports=s,cc._RFpop()},{}],cardFace_common:[function(e,t,r){"use strict";cc._RFpush(t,"8f1e7ROFQBJAakCd38HDLho","cardFace_common");var a=logConfig(4),s=(e("tools"),cc.Class({name:"cardFace_common",ctor:function(){var e=arguments[0];this.cardsMng=e.cardsMng},getJiao:function(){var e,t={isNeedContinue:!1,resultArr:[]},r=this.cardsMng.cardFaceHaveCats();return r||((e=this._isDaDuiHu())?(t.resultArr.push(e),t.isNeedContinue=!0):(e=this._isDaDanDiao())&&(t.resultArr.push(e),t.isNeedContinue=!0)),a.log1("getJiao最后的输出：",t),t},_isDaDanDiao:function(){var e=!0,t=!1,r=[];return r.name="duiduihu",this.cardsMng.forEach(function(a){if(0!==a.num)if(1===a.num){if(t!==!1)return e=!1,"breakOuter";t=!0,r.huCard=[a.cardName],r.push({name:a.cardName,num:++a.num})}else{if(3!==a.num)return e=!1,"breakOuter";r.push({name:a.cardName,num:a.num})}}),e&&r},_isDaDuiHu:function(){var e=!0,t=0,r=[];return r.name="duiduihu",r.huCard=[],this.cardsMng.forEach(function(a){if(0!==a.num)if(2===a.num){if(!(t<2))return e=!1,"breakOuter";t+=1,r.huCard.push(a.cardName),r.push({name:a.cardName,num:++a.num})}else{if(3!==a.num)return e=!1,"breakOuter";r.push({name:a.cardName,num:a.num})}}),e&&r},_isSevePair:function(){var e=!0,t=!1,r=[];return r.name="seven",13===this.cardsMng.getLen()?this.cardsMng.forEach(function(a){if(0!==a.num)if(1===a.num||3===a.num){if(t!==!1)return e=!1,"breakOuter";t=!0,r.huCard=[a.cardName],r.push({name:a.cardName,num:++a.num})}else 0!==a.num&&r.push({name:a.cardName,num:a.num})}):e=!1,e&&r}}));t.exports=s,cc._RFpop()},{tools:"tools"}],cardFace:[function(e,t,r){"use strict";cc._RFpush(t,"79a47r0qExN5am4UVHkMoX5","cardFace");var a=cc.Class({name:"cardFace",ctor:function(){var e=arguments[0];this.operateCards=e.operateCards,this.handCards=e.handCards,this.operateCards_operate=e.operateCards_operate},getHaveAllCard:function(){for(var e=[],t=this.handCards.getHandCard(),r=this.operateCards.cardsOperateArr,a=0;a<r.length;a++)if("chi"===r[a].type)for(var s=r[a].msg.cards,i=0;i<s.length;i++)e.push(s[i]);else if("specialGang"===r[a].type)for(var s=r[a].msg.cards,i=0;i<s.length;i++)e.push(s[i]);else e.push(r[a].cardName);for(var o=0;o<t.length;o++)e.push(t[o]);return e},cardHaveThreeColor:function(){console.log("第一次输出手上的牌"+this.getHaveAllCard());var e=this.handCards.getCardHaveNumFromType(this.getHaveAllCard(),"o"),t=this.handCards.getCardHaveNumFromType(this.getHaveAllCard(),"t"),r=this.handCards.getCardHaveNumFromType(this.getHaveAllCard(),"w");return e>0&&t>0&&r>0},cardHaveOneNine:function(){var e=this.handCards.getHaveCardFromType(this.getHaveAllCard(),"o"),t=this.handCards.getHaveCardFromType(this.getHaveAllCard(),"t"),r=this.handCards.getHaveCardFromType(this.getHaveAllCard(),"w");return e===!0||t===!0||r===!0},cardHaveArrow:function(){var e=this.handCards.getCardHaveNumFromType(this.getHaveAllCard(),"z"),t=this.handCards.getCardHaveNumFromType(this.getHaveAllCard(),"f"),r=this.handCards.getCardHaveNumFromType(this.getHaveAllCard(),"b");return e>0&&t>0&&r>0},cardHandHaveTwains:function(){var e=!1;return this.handCards.forEach(function(t){if(t.num>=2)return e=!0,"breakOuter"}),e},cardFaceHaveBars:function(){
var e=!1;return this.operateCards.forEach(function(t){if("pong"===t.type||"mingGang"===t.type||"anGang"===t.type||"buGang"===t.type)return e=!0,"break"}),e},cardSpecialGang:function(){var e=!1;return this.operateCards.forEach(function(t){if("specialGang"===t.type)return e=!0,"break"}),e},cardFaceHaveCats:function(){var e=!1;return this.operateCards.forEach(function(t){if("chi"===t.type)return e=!0,"break"}),e}});t.exports=a,cc._RFpop()},{}],cardHandMng:[function(e,t,r){"use strict";cc._RFpush(t,"76fa9SUsVxOwpWl+V8BibS1","cardHandMng");var a=logConfig(4),s=cc.Class({name:"CardHandMng",ctor:function(){var e=arguments[0];this.handNode=e.userSelf.attr("handNode"),this.cards_Atlas=e.userSelf.attr("cards_Atlas"),this.cardNodes=this.handNode.children,this.cardNodes.sort(function(e,t){return e.name.match(/_(.*)$/)[1]-t.name.match(/_(.*)$/)[1]}),this.cardsHandOrder=e.userSelf.attr("cardsHandOrder")},reset:function(){a.log4("cardHandMng.js重置了。"),this.hideHand()},displayHand:function(e,t){var r,a="handmah";r="number"==typeof e?e:e.length;var s=r-1;if(14===r||"inCard"===t||"wantOutCard"===t)var i=this.cardNodes.length-1;else{var i=this.cardNodes.length-2;this.cardNodes[i+1].active=!1}for(var o=i;o>-1;o--)if(s>-1){if("object"==typeof e){var n=e[s];a="handmah_"+n,this._recordCardName_(this.cardNodes[o].name,n)}this.cardNodes[o].getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame(a),this.cardNodes[o].active=!0,s--}else this.cardNodes[o].active=!1},inCard:function(e){var t=this.cardNodes.length-1,r="handmah";e&&(r="handmah_"+e,this._recordCardName_(this.cardNodes[t].name,e)),this.cardNodes[t].getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame(r),this.cardNodes[t].active=!0},hideHand:function(){for(var e=0;e<this.cardNodes.length;e++)this.cardNodes[e].active=!1},hideTingMask:function(){for(var e=0;e<this.cardNodes.length;e++)this.cardNodes[e].getChildByName("mashMask").active=!1},_recordCardName_:function(e,t){this.cardsHandOrder[e]=t},_getCardNameFromNode_:function(e){return this.cardsHandOrder[e]}});t.exports=s,cc._RFpop()},{}],cardsAll:[function(e,t,r){"use strict";cc._RFpush(t,"68ebeIWp1JCPLxK97lWL5p3","cardsAll");var a=logConfig(4),s=cc.Class({name:"CardsAll",ctor:function(){var e=arguments[0];this.handCards=e.handCards,this.outCards=e.outCards,this.operateCards=e.operateCards,this.operateCards_operate=e.operateCards_operate},setOutCards:function(e){this.outCards.setOutCards(e)},getOutCards:function(){return this.outCards.cardsOut},setOperateCards:function(e){this.operateCards.setOperateCards(e)},reset:function(){a.log4("cardsAll.js重置了。")},outCard:function(e){this.outCards.pushCard(e),this.handCards.operateCard(e,1,"sub")},inCard:function(e){this.handCards.operateCard(e,1,"add")},pong:function(e,t){this.operateCards.pong(e,t),this.handCards.operateCard(e,2,"sub")},anGang:function(e,t){this.operateCards.anGang(e,t),this.handCards.operateCard(e,4,"sub")},mingGang:function(e,t){this.operateCards.mingGang(e,t),this.handCards.operateCard(e,3,"sub")},chi:function(e,t){this.operateCards.chi(e,t);for(var r=t.cards,a=0;a<r.length;a++)r[a]!==e&&this.handCards.operateCard(r[a],1,"sub")},specialGang:function(e,t,r){var a=this.operateCards.specialGang(e,t);if(e)"notSub"!==r&&this.handCards.operateCard(e,1,"sub");else for(var s=t.cards,i=0;i<s.length;i++)this.handCards.operateCard(s[i],1,"sub");return a},buGang:function(e,t){this.operateCards.buGang(e,t),this.handCards.operateCard(e,1,"sub")},getSpecialGang:function(){for(var e,t=this.handCards.getSpecialGangAll.apply(this.handCards,arguments),r=[],a=0;a<t.length;a++)e=this.operateCards_operate.isHasSpecialGang(t[a].name),!e&&r.push(t[a]);return r},checkCard:function(e,t,r){var a=this.handCards.checkHandCard(e,t,r);if("fromMe"===t){if(room.attr("restCardNum")<=0)return a;a=a.concat(this.operateCards_operate.checkBuGang());var s=this.operateCards_operate.checkSpecialBuGang();s.hasBuGang&&a.push(s)}return a},checkPong:function(e){return this.handCards.checkHandCard(e,"fromOther",!1)},specialCheck:function(){if(room.attr("restCardNum")<=0)return[];var e=this.operateCards_operate.checkBuGang();this.handCards.checkAnGang(e);var t=this.operateCards_operate.checkSpecialBuGang();return t.hasBuGang&&e.push(t),e}});t.exports=s,cc._RFpop()},{}],cardsHu_other:[function(e,t,r){"use strict";cc._RFpush(t,"36cddnPzJJMhqAgEUPlfJvY","cardsHu_other");var a=e("log"),s=new a(0);s.setOutLevel(1);var i=(e("tools"),e("cardsHu_pair"),cc.Class({name:"CardsHu_other",ctor:function(){var e=arguments[0];this.cardsMng=e.cardsMng},getJiao:function(){var e,t={isNeedContinue:!0,resultArr:[]};return(e=this._isThirteenMessy())?(t.resultArr.push(e),t.isNeedContinue=!1):(e=this._isJiaHu())?(t.resultArr.push(e),t.isNeedContinue=!1):(e=this._isSevePair())&&(t.resultArr.push(e),t.isNeedContinue=!0),t},_isJiaHu:function(){var e=this.cardsMng.isSameColor();if(e){switch(e){case"o":case"t":case"w":for(var t=[],r=1;r<=9;r++)t.push(e+r);break;case"z":var t=["e","s","x","n","z","f","b"]}var a=[];return a.name="jiaHu",a.huCard=t,a}return!1},_isSevePair:function(){var e=!0,t=!1,r=[];return r.name="seven",13===this.cardsMng.getLen()?this.cardsMng.forEach(function(a){if(1===a.num||3===a.num){if(t!==!1)return e=!1,"breakOuter";t=!0,r.huCard=[a.cardName],r.push({name:a.cardName,num:++a.num})}else 0!==a.num&&r.push({name:a.cardName,num:a.num})}):e=!1,e&&r},_isThirteenMessy:function(){var e=!0,t={wordCards:[],ordinalCards:[]},r=[];return 13===this.cardsMng.getLen()?this.cardsMng.forEach(function(r){if(r.num>1)return e=!1,"breakOuter";"f"!==r.typeName&&"j"!==r.typeName||0===r.num&&t.wordCards.push(r.cardName);var a=r.j;if(1===r.num&&("o"===r.typeName||"t"===r.typeName||"w"===r.typeName)){if(0!==r.arr[a+1]&&void 0!==r.arr[a+1]||0!==r.arr[a+2]&&void 0!==r.arr[a+2])return e=!1,"breakOuter";for(var s=a+3;s<r.arr.length&&0===r.arr[s];s++)t.ordinalCards.push(r.cardName)}}):e=!1,!!e&&(r.name="thirty",r.huCard=t.wordCards.concat(t.wordCards),r)}}));t.exports=i,cc._RFpop()},{cardsHu_pair:"cardsHu_pair",log:"log",tools:"tools"}],cardsHu_pair:[function(e,t,r){"use strict";cc._RFpush(t,"8d8b7ufpFdPkIB2iTl45gXm","cardsHu_pair");var a=logConfig(0),s=cc.Class({name:"CardsHu_pair",ctor:function(){var e=arguments[0];this.isZFBOrder=room.attr("isZFBOrder"),this.cardsMng=e.cardsMng},reset:function(){a.log4("cardsHu_pair.js重置了。")},checkHasHu:function(e,t){this.cardsMng.operateCard(e,1,"add");var r=this._subTwo(this._checkDiffPair,t);return this.cardsMng.operateCard(e,1,"sub"),r},_subTwo:function(e,t,r){var s=[];r=r||this;var i=t?2:0;return this.cardsMng.forEach(function(t){if(t.num>=i){t.arr[t.j]-=i,a.log2("_subTwo-start/////////////////////////////////去掉将牌后，手中牌是："+this.cardsMng.getAllCardsStr());var o=[],n=e.call(r,o);t.arr[t.j]+=i,a.log2("_subTwo-将牌和结果是："+t.cardName+"  ",n),a.log1("_subTwo-huArr: ",o),a.log2("_subTwo-end/////////////////////////////////加上将牌后，手中牌是："+this.cardsMng.getAllCardsStr()),n===!1?a.log3("-----false----"):(a.log3("-----true----"),o.push({name:t.cardName,num:2}),o.jiangCard=t.cardName,s.push(o))}},this),a.log2("_subTwo-检查是否胡牌的结果 calcHuArr: ",s),0!==s.length&&s},_checkDiffPair:function(e){var t=!0,r=this;return this.cardsMng.outerForEach(function(s){if(t=r._checkAllCards(s.arr,s.typeName,e),a.log4("_checkDiffPair-传入_checkAllCards的数据是：",s.arr,s.typeName,s.j),a.log4("_checkDiffPair-本次检查的是"+s.typeName+"牌, 结果是："+t),t===!1)return"break"}),t},_checkAllCards:function(e,t,r){a.log3("_checkAllCards-分割前的传入的3个参数是: ",e,t,r);var s=!0,i=null;if("f"===t||"j"===t){if(i=TOOL.getNoZeroArr(e),a.log3("_checkAllCards-分割(去零)的结果splitAll: ",i),s=this._checkAllCard(i,t,r),a.log3("_checkAllCards-对于本次分割的计算结果result: ",s),s===!1)return!1}else{i=TOOL.getSplitAll(e),a.log3("_checkAllCards-分割(真的分割)的结果splitAll: ",i);for(var o=0;o<i.length;o++)if(a.log4("_checkAllCards-对于本次分割的片段"+o+": ",i[o],t,r),s=this._checkAllCard(i[o],t,r),a.log4("_checkAllCards-对于本次分割的片段: "+o+"的计算结果result是: ",s),a.log4("_checkAllCards-计算后的3个参数是: ",i[o],t,r),s===!1)return!1}return!0},_justHasOneCard:function(e,t,r){return 3===e[0]&&(r.push({name:this.cardsMng.getCardName(t,e.index0),num:e[0]}),!0)},_justHasTwoCard:function(e,t,r){return 3===e[0]&&3===e[1]&&(r.push({name:this.cardsMng.getCardName(t,e.index0),num:e[0]}),r.push({name:this.cardsMng.getCardName(t,e.index1),num:e[1]}),!0)},_justHasThreeCard:function(e,t,r){var a,s,i;return this.isZFBOrder||"j"!==t?e[0]===e[1]&&e[0]===e[2]?(a=this.cardsMng.getCardName(t,e.index0),s=this.cardsMng.getCardName(t,e.index1),i=this.cardsMng.getCardName(t,e.index2),r.push({name:a,name1:s,name2:i,num:e[0]}),!0):!(1!==e[0]&&4!==e[0]||1!==e[1]&&4!==e[1]||1!==e[2]&&4!==e[2])&&(a=this.cardsMng.getCardName(t,e.index0),s=this.cardsMng.getCardName(t,e.index1),i=this.cardsMng.getCardName(t,e.index2),r.push({name:a,name1:s,name2:i,num:e[0]}),4===e[0]&&r.push({name:a,num:e[0]-1}),4===e[1]&&r.push({name:s,num:e[1]-1}),4===e[2]&&r.push({name:i,num:e[2]-1}),!0):3===e[0]&&3===e[1]&&3===e[2]&&(a=this.cardsMng.getCardName(t,e.index0),s=this.cardsMng.getCardName(t,e.index1),i=this.cardsMng.getCardName(t,e.index2),r.push({name:a,name1:s,name2:i,num:e[0]}),!0)},_justHasOverThreeCard:function(e,t,r){var s;return a.log3("_justHasOverThreeCard-降级前的3个参数：",e,t,r),s="f"===t||"j"===t?this._wordDegradeArr(e,t,r):this._degradeArr(e,t,r),a.log3("_justHasOverThreeCard-降级计算的返回结果：",s),a.log3("_justHasOverThreeCard-降级后的3个参数：",e,t,r),s!==!1&&("f"===t||"j"===t?e=TOOL.getNoZeroArr(e):TOOL.trimFrontZero(e),void a.log3("_justHasOverThreeCard-去掉0后的数组是：",e))},_checkAllCard:function(e,t,r){var s=!0;for(a.log3("_checkAllCard-"+t+"牌是：",e);0!==e.length;)switch(e.length){case 1:return s=this._justHasOneCard(e,t,r),s!==!1;case 2:return s=this._justHasTwoCard(e,t,r),s!==!1;case 3:return s=this._justHasThreeCard(e,t,r),s!==!1;case 4:case 5:case 6:case 7:case 8:case 9:if(s=this._justHasOverThreeCard(e,t,r),s===!1)return!1}return s!==!1},_wordDegradeArr:function(e,t,r){var a=0,s=0;switch(e[0]){case 0:case 3:return e[0]=0,!0;case 1:case 2:a=e[0];break;case 4:a=1}for(var i={},o=1;o<4;o++)e[o]>=a&&s<=2&&(e[o]-=a,s++,i["name"+s]=this.cardsMng.getCardName(t,e["index"+o]),i.num=a);return 2===s&&(i.name=this.cardsMng.getCardName(t,e.index0),4===e[0]&&r.push({name:this.cardsMng.getCardName(t,e.index0),num:3}),r.push(i),e[0]=0,!0)},_degradeArr:function(e,t,r){switch(a.log4("_degradeArr-序数牌的降级前的三个参数：",e,t,r),e[0]){case 0:return!0;case 1:if(e[0]=0,e[1]--,e[2]--,e[1]<0||e[2]<0)return!1;if(0===e[2]){if(3!==e[1]&&0!==e[1])return!1;3===e[1]&&(e[1]=0,r.push({name:t+(e.index1+1),num:3}))}else r.push({name:t+(e.index0+1),name1:t+(e.index1+1),name2:t+(e.index2+1),num:1});break;case 2:if(e[0]=0,e[1]-=2,e[2]-=2,e[1]<0||e[2]<0)return!1;if(0===e[2]){if(3!==e[1]&&0!==e[1])return!1;3===e[1]&&(e[1]=0,r.push({name:t+(e.index1+1),num:3}))}else r.push({name:t+(e.index0+1),name1:t+(e.index1+1),name2:t+(e.index2+1),num:2});break;case 3:e[0]=0,r.push({name:t+e.index0,num:3});break;case 4:if(e[0]=0,e[1]-=1,e[2]-=1,e[1]<0||e[2]<0)return!1;if(0===e[2]){if(3!==e[1]&&0!==e[1])return!1;3===e[1]&&(e[1]=0,r.push({name:t+(e.index1+1),num:3}))}else r.push({name:t+(e.index0+1),name1:t+(e.index1+1),name2:t+(e.index2+1),num:1}),r.push({name:t+(e.index0+1),num:3})}return a.log4("_degradeArr-序数牌的降级后的三个参数：",e,t,r),!0}});t.exports=s,cc._RFpop()},{}],cardsMng:[function(e,t,r){"use strict";cc._RFpush(t,"ad57c3eEpxIWK3BME7TTuOk","cardsMng");var a=e("combination"),s=e("outCards"),i=e("operateCards"),o=e("handCardsChild"),n=e("cardsAll"),c=e("calcHuType"),h=e("operateCards_operate"),l=e("outCards_operate"),d=e("calcHuMngFlow"),u=e("cardFace"),m=logConfig(4),g=cc.Class({name:"CardsMng","extends":a,ctor:function(){this.outCards=new s,this.operateCards=new i,this.handCards=new o,this.operateCards_operate=new h({handCards:this.handCards,operateCards:this.operateCards}),this.cardFace=new u({handCards:this.handCards,operateCards:this.operateCards,operateCards_operate:this.operateCards_operate}),this.outCards_operate=new l({outCards:this.outCards}),this.cardsAll=new n({outCards:this.outCards,handCards:this.handCards,operateCards:this.operateCards,operateCards_operate:this.operateCards_operate}),this.calcHuType=new c({handCards:this.handCards,operateCards_operate:this.operateCards_operate}),this.combination([{name:"handCardsChild",combineType:"method",type:"objectExist",config:{obj:this.handCards}},{name:"outCards_operate",combineType:"method",type:"objectExist",config:{obj:this.outCards_operate}},{name:"cardFace",combineType:"method",type:"objectExist",config:{obj:this.cardFace}},{name:"operateCards_operate",combineType:"method",type:"objectExist",config:{obj:this.operateCards_operate}},{name:"cardsAll",combineType:"method",type:"objectExist",config:{obj:this.cardsAll}},{name:"calcHuType",combineType:"method",type:"objectExist",config:{obj:this.calcHuType}}]),this.calcHuMng=new d({cardsMng:this}),this.combination([{name:"calcHuMng",combineType:"method",type:"objectExist",config:{obj:this.calcHuMng}}])},reset:function(){m.log4("cardsMng.js重置了。"),this.reset_other(),this.outCards.reset(),this.operateCards.reset()}});t.exports=g,cc._RFpop()},{calcHuMngFlow:"calcHuMngFlow",calcHuType:"calcHuType",cardFace:"cardFace",cardsAll:"cardsAll",combination:"combination",handCardsChild:"handCardsChild",operateCards:"operateCards",operateCards_operate:"operateCards_operate",outCards:"outCards",outCards_operate:"outCards_operate"}],combination:[function(e,t,r){"use strict";cc._RFpush(t,"65593z7NXZI2LTdqXGNsVIH","combination");var a=cc.Class({name:"Combination",ctor:function(){this.data=[],this.methodObj={},this.methodLen=0,this.oldMethodLen=this.methodLen},remove:function(e){for(var t=e,r=0;r<t.length;r++){for(var a=0;a<this.data.length;a++)this.data[a].name===t[r]&&(this.data.splice(a,1),a--);for(var s in this.methodObj){for(var i=this.methodObj[s],a=0;a<i.length;a++)i[a].name===t[r]&&(i.splice(a,1),a--);0===i.length&&(s.search(/_other$/)===-1&&delete this[s],delete this.methodObj[s])}}return this},combination:function(t){if(t&&t.length){for(var r=0;r<t.length;r++){var a=null;switch(t[r].type){case"class":this.className=e(t[r].name),a=void 0!==t[r].config?new this.className(t[r].config):new this.className;break;case"object":a=e(t[r].name);break;case"objectExist":a=t[r].config.obj}a.name=t[r].name,t[r].combineType.search(/data/)!==-1&&this.data.push(a),t[r].combineType.search(/method/)!==-1&&(this.oldMethodLen=this.methodLen,this._changeMethodObj_(a),this.oldMethodLen!==this.methodLen&&this._copyMethod_())}return this}},attr:function(e,t){if(e){if("object"==typeof e){for(var r in e)e[r]=this._attr_(r,e[r]);return e}return this._attr_(e,t)}},_attr_:function(e,t){for(var r=this.data,a=0;a<r.length;a++)if(void 0!==r[a][e])return void 0==t?r[a][e]:r[a][e]=t},_copyMethod_:function(){var e;for(var t in this.methodObj)e=this.methodObj[t].selfHave?t+"_other":t,e in this||(this[e]=function(e){return function(){for(var t=this.methodObj[e],r=0;r<t.length;r++){var a=t[r][e].apply(t[r],arguments);if(void 0!==a)return a}if("reset"===e)for(var t=this.data,r=0;r<t.length;r++)if(t[r][e]){var a=t[r][e].apply(t[r],arguments);if(void 0!==a)return a}}}(t))},_changeMethodObj_:function(e){for(var t in e)"function"!=typeof e[t]||"constructor"===t||t.match(/(^_)|(_$)/)||(t in this.methodObj?this.methodObj[t].push(e):(this.methodObj[t]=[e],this.methodLen++,t in this&&(this.methodObj[t].selfHave=!0)))}});t.exports=a,cc._RFpop()},{}],conditions:[function(e,t,r){"use strict";cc._RFpush(t,"4c24fdf29BGPY2F0LxqIRNz","conditions");var a={roomFinish_condition:["juScore","roomScore","napai","word","face","buGang","anGang","ting","hu","mingGang","chi","pong","specialGang","specialBuGang","guo","outCard","start","ready","dismissing","dismiss","wantBuGang","buGangCheck","ready","leaveLine","reConnect"],playing_conditin:[],existRoomUser_condition:["leaveLine","reConnect","exitRoom"],allResultShow_Condition:["roomScore"]},s={initConditions:function(){for(var e in a)for(var t=a[e],r=0;r<t.length;r++)t[r]in window.msgCondition?window.msgCondition[t[r]].push(e):window.msgCondition[t[r]]=[e]},roomFinish_condition:function(e){return getGI("roomSceneFinished")},existRoomUser_condition:function(e){var t=e.message;return window.room&&t&&room.getUser(t)},allResultShow_Condition:function(e){var t=room.attr("isCanShowAllResult");return t?(room.attr("isCanShowAllResult",!1),!0):t}};t.exports=s,cc._RFpop()},{}],controllerMap:[function(e,t,r){"use strict";cc._RFpush(t,"7d6665i+z1PUYEFnbLcdrM1","controllerMap");var a=cc.Class({name:"ControllerMap",ctor:function(){var e=arguments[0];this.controllerMap=e.controllerMap,this.controllerSave={},this.controllerObjArr=[],this._init_()},resetController:function(){for(var e=this.controllerObjArr,t=0;t<e.length;t++)e[t].reset&&e[t].reset()},accessController:function(e){var t=e.type,r=e.success?this.controllerSave[t]:this.controllerSave.error_controller,a=r.index,s=r[t+"_controller"];a&&a.call(r,e),s&&s.call(r,e),e.success||s||(console.log("---简单的输出错误信息---"+e.errMsg),socket.finishMsg("error_sample"))},_init_:function(){this.className;for(var t in controllerMap){this.className=e(t);var r=new this.className;if(r.fileName=t,this.controllerObjArr.push(r),"error_controller"===t)this.controllerSave.error_controller=r;else for(var a=this.controllerMap[t],s=0;s<a.length;s++)this.controllerSave[a[s]]=r}}});t.exports=a,cc._RFpop()},{}],dismissAlert_click:[function(e,t,r){"use strict";cc._RFpush(t,"d808656a+5HJ4zXAJ93j5AU","dismissAlert_click");var a=logConfig(4);cc.Class({"extends":cc.Component,dismissAlertClick:function(e,t){room.dismissAlert.dismissShow(t,"noVoice")},agreeClick:function(e,t){a.log4("执行了函数 agreeCallback, 传入的参数分别是："),"noVoice"!==t&&audio.play("waterClick"),clientUser.send({message:!0,type:"dismissing"}),room.dismissAlert.changeBtnState("disabled"),room.dismissAlert.showOperate(clientUser.attr("openId"),!0)},continueClick:function(){a.log4("执行了函数 continueCallback, 传入的参数分别是："),audio.play("waterClick"),clientUser.send({message:!1,type:"dismissing"}),room.dismissAlert.changeBtnState("disabled"),room.dismissAlert.showOperate(clientUser.attr("openId"),!1)}}),cc._RFpop()},{}],dismissAlert_display:[function(e,t,r){"use strict";cc._RFpush(t,"b9a6dtU3fRM+5Edcd6t1hqT","dismissAlert_display");var a=logConfig(4),s=cc.Class({name:"DismissAlert_display",ctor:function(){var e=arguments[0];this.dismissAtl=e.dismissAtl,this.dismissNode=cc.find("Canvas/dismissAlert"),this.contentNode=cc.find("alertContent/rect",this.dismissNode),this.grogressNodes=this.contentNode.getChildByName("progress").children,this.reset(),this.index=0,this.isShow=!1},getIsShow:function(){return this.isShow},reset:function(){for(var e=0;e<this.grogressNodes.length;e++)this.grogressNodes[e].active=!1;this.index=0,this.isShow=!1},dismissShow:function(e,t,r){if("noVoice"!==t&&"noVoice"!==r&&audio.play("waterClick"),e="show"===e,this.isShow=e,this.changeBtnState("enabled"),e)TOOL.alertToggleAni(this.dismissNode,this.dismissNode.getChildByName("alertContent"),e);else{var a=this;room.attr("dismissingNum",0),0===t?(a.dismissNode.active=!1,a.reset()):void 0===t?setTimeout(function(){TOOL.alertToggleAni(a.dismissNode,a.dismissNode.getChildByName("alertContent"),e),a.reset()},t):setTimeout(function(){TOOL.alertToggleAni(a.dismissNode,a.dismissNode.getChildByName("alertContent"),e),a.reset()},1e3)}},changeBtnState:function(e){a.log4("执行了函数 continueCallback, 传入的参数分别是：",e),e="enabled"===e,this.contentNode.getChildByName("dismiss").getComponent(cc.Button).interactable=e,this.contentNode.getChildByName("continue").getComponent(cc.Button).interactable=e},showOperate:function(e,t,r){a.log4("执行了函数 showOperate, 传入的参数分别是：",e,t,r),void 0!==r&&(this.index=r);var s=room.getUser(e).attr("nickName");this.grogressNodes[this.index].getChildByName("nick").getComponent(cc.Label).string=s,t&&0===this.index&&(this.contentNode.getChildByName("nick").getComponent(cc.Label).string=s);var i=this._getSrpitName_(t);this.grogressNodes[this.index].getComponent(cc.Sprite).spriteFrame=this.dismissAtl.getSpriteFrame(i),this.grogressNodes[this.index].active=!0,this.index++},_getSrpitName_:function(e){a.log4("执行了函数 _getSrpitName_, 传入的参数分别是：",e);var t;return t=e?0===this.index?"itemL":1===this.index||2===this.index?"itemGreen":"itemRGreen":0===this.index?"itemL":1===this.index||2===this.index?"itemRed":"itemRRed",a.log4("执行了函数 _getSrpitName_, 返回的结果是：",t),t}});t.exports=s,cc._RFpop()},{}],dismiss_controller:[function(e,t,r){"use strict";cc._RFpush(t,"6c3c4VhzG5B151VdYVOkJ+0","dismiss_controller");var a=logConfig(4),s=cc.Class({name:"Dismiss_controller",ctor:function(){arguments[0];this.disimssNum=0},ready_controller:function(e){a.log2("执行 ready_controller..."),room.attr("readyArr",e.message);var t=e.message;if("endJu"!==room.attr("period"))for(var r=0;r<t.length;r++)room.getUser(t[r]).displayHead("ok","show");else if(room.singleResult.isSingleAlertShow())room&&room.displayRoomInfo&&room.displayRoomInfo("reminder",room.getUser(t[t.length-1]).attr("nickName")+" 继续了游戏...");else for(var r=0;r<t.length;r++)room.getUser(t[r]).displayHead("ok","show");socket.finishMsg("ready")},dismissing_controller:function(e){a.log2("执行 dismissing_controller..."),a.log1(e),room.attr("dismissingNum",room.attr("dismissingNum")+1);var t=window.messageType.convert(e.message,"send_big");if(!room.msgIsMeSend(t.openId)){var r=room&&room.singleResult&&room.singleResult.isSingleAlertShow();r&&room.singleResult.singelResultShow("hide");var s=getGI("setAlert");if(s&&s.setAlertIsShow()&&s.settingClick(null,!1,!0),!room.dismissAlert.getIsShow()&&(room.dismissAlert.reset(),room.dismissAlert.dismissShow("show"),"endJu"===room.attr("period")&&clientUser.mahjongMng)){if(r){room.resetMah(),room.setZhuang(room.nextZhuang),room.forEach(function(e){e.displayHead("score",e.attr("roomScore")),e.displayHead("zhuang",e.attr("zhuang")?"show":"hide")});for(var i=room.attr("readyArr"),o=0;o<i.length;o++)room.getUser(i[o]).displayHead("ok","show")}room.timeShow("hide")}room.dismissAlert.showOperate(t.openId,t.message,room.attr("dismissingNum")-1)}t.message&&this.disimssNum++,4===this.disimssNum&&(room.attr("isCanShowAllResult",!0),this.disimssNum=0),socket.finishMsg("dismissing")},dismiss_controller:function(e){a.log2("执行 dismiss_controller..."),a.log1(e),this.disimssNum=0,e.message?cc.director.loadScene("hall",function(){window.reset(),getGI("hall").display({nickName:clientUser.attr("nickName"),userId:clientUser.attr("userId"),headIcon:clientUser.attr("faceIcon"),roomCardNum:clientUser.attr("roomCards")}),socket.finishMsg("dismiss")}):(room.dismissAlert.dismissShow("hide",800,"noVoice"),"endJu"===room.attr("period")&&(room.timeShow("hide"),room.attr("isCanShowAllResult",!0)),"endJu"===room.attr("period")&&clientUser.mahjongMng&&room.displayRoomInfo({readyBtn:clientUser.attr("isReady")?"hide":"showCenter",exitBtn:"hide"}),socket.finishMsg("dismiss"))}});t.exports=s,cc._RFpop()},{}],error_controller:[function(e,t,r){"use strict";cc._RFpush(t,"7ee24iwWN5J1pZsbs2fe7br","error_controller");var a=cc.Class({name:"Error_controller",join_controller:function(e){getGI("hall").errorReminder(e.errMsg),socket.finishMsg("error_join")},ready_controller:function(e){console.log("ready出错了...."),socket.finishMsg("error_ready")},create_controller:function(e){getGI("hall").errorReminder(e.errMsg),socket.finishMsg("error_create")},error_controller:function(e){console.log("error_controller出错了....",e),window.room?cc.director.loadScene("hall",function(){window.reset(),getGI("hall").display({nickName:clientUser.attr("nickName"),userId:clientUser.attr("userId"),headIcon:clientUser.attr("faceIcon"),roomCardNum:clientUser.attr("roomCards")}),socket.finishMsg("error_error")}):(TOOL.createSocket({type:"login",message:window.userInfo}),socket.finishMsg("error_error"))}});t.exports=a,cc._RFpop()},{}],farServer:[function(e,t,r){"use strict";cc._RFpush(t,"02cff3PpllLvYcdXNeFUZ6v","farServer");var a=e("sendMessageMng"),s=e("controllerMap"),i=e("log"),o=new i(5);o.setOutLevel(4);var n=cc.Class({name:"FarServer",ctor:function(){},createServer:function(){var e=new a({ID:0,procotolObj:window.messageType}),t=new s({controllerMap:window.controllerMap});return e.openLink(getGI("socketURL")).success(function(){this.send({type:"login"})}).receiveMessage(function(e,r){t.accessController(e)}).error().close(),e}});t.exports=n,cc._RFpop()},{controllerMap:"controllerMap",log:"log",sendMessageMng:"sendMessageMng"}],global:[function(e,t,r){"use strict";cc._RFpush(t,"44989Ws/b5J55WTllttmkoR","global"),window.MYGLOBAL={debug:1,model:"produce",consoleLevel:5,isBuildUserInfo:!0,socketURL:"ws://192.168.0.114:8080/Mahjong/ws/tnmj",shareConfig:null,bgMusic:"close",sizeVolume:.2,effectVolume:.4,extension:".mp3",hall:null,setAlert:null,offlineAlert:null,roomGlobalRes:null,roomSceneFinished:!1,napaiModel:"local",napaiEveryModel:"local",napaiFrom:"user",fromOneFile:!0},"produce"===window.MYGLOBAL.model&&(window.MYGLOBAL.consoleLevel=null,window.MYGLOBAL.socketURL="ws://120.24.57.27:8080/Mahjong/ws/tnmj",window.MYGLOBAL.bgMusic="open",window.MYGLOBAL.napaiModel="server",window.MYGLOBAL.napaiEveryModel="server",window.MYGLOBAL.isBuildUserInfo=!1),window.clientUser=null,window.room=null,window.socket=null,window.ajaxMng=null,window.audio=null,window.msgCache=null,window.MYGLOBAL.isBuildUserInfo&&(window.userInfo={openId:"10101",userId:10101,nickName:"玩家10101",faceIcon:"5350b36d56b6e054.jpg",sex:1,ip:"192.168.0.101",roomId:""}),window.setGI=function(e,t){window.MYGLOBAL[e]=t},window.getGI=function(e){return window.MYGLOBAL[e]},window.hasGlobalItem=function(e){return e in window.MYGLOBAL},window.reset=function(){TOOL.resetData(),window.audio&&window.audio.stopBgMusic(),clientUser&&clientUser.resetJu(),TOOL.replaceShareUrl("wx"),window.room=null,window.clientUser.resetJu(),window.socket.reset(),window.MYGLOBAL.roomGlobalRes=null,window.MYGLOBAL.roomSceneFinished=!1},function(){var t=e("napaiMng");window.naPaiMng=new t,getGI("fromOneFile")?window.naPaiMng.setUserCard(["usersCard"]):(window.naPaiMng.setUserCard(["userCard0","userCard1","userCard2","userCard3"]),"global"===getGI("napaiFrom")&&window.naPaiMng.setNapai("userNapai"))}(),window.controllerMap={error_controller:["join","error","ready"],napai_controller:["napai"],juEnd_controller:["juScore","roomScore"],msgSend_controller:["word","face"],operate_controller:["buGang","anGang","ting","hu","mingGang","chi","pong","specialGang","specialBuGang","guo"],outCard_controller:["outCard"],start_controller:["login","start"],dismiss_controller:["ready","dismissing","dismiss"],join_controller:["create","join"],buGangCheck_controller:["wantBuGang","buGangCheck"],record_controller:["record"],isOnline_controller:["leaveLine","reConnect","exitRoom"],rebuild_controller:["rebuild"],share_controller:["share"]},window.messageType={start:1,ready:2,join:3,login:4,create:5,full:6,outCard:7,hu:8,napai:9,huang:10,peng:11,gang:12,chi:13,juScore:20,roomScore:21,dismiss:30,dismissing:31,record:32,leaveLine:33,reConnect:34,rebuild:35,exitRoom:36,error:99,share:37,guo:50,operateClick:57,buGang:51,anGang:52,mingGang:58,ting:53,pong:54,face:55,word:56,wantBuGang:59,specialGang:62,specialBuGang:63},window.CONDITIONS=e("conditions"),window.msgCondition={},window.CONDITIONS.initConditions(),function(e){for(var t in e)e[e[t]]=t}(window.messageType),window.messageType.convert=function(e,t){var r;switch(t){case"send_small":r={},r.t=this[e.type],r.m=e.message,r.p=e.openId;break;case"send_big":r={},r.type=this[e.t],r.message=e.m,r.openId=e.p;break;case"receive":r=e,r.errMsg=e.e,r.type=this[e.t],r.message=e.m,r.success=e.s;break;case"":}return r},window.logConfig=function(t,r){1===arguments.length&&(r=t,t=6);var a=e("log"),s=new a(t,window.getGI("consoleLevel"));return s.setOutLevel(r),s},window.words=["你太牛了","快点, 等得我花儿都谢了","今天手气真好","快点出牌噢","不要吵了，有什么好吵的，专心玩游戏嘛","大家好，很高兴见到各位","各位，真不好意思，我要离开一会儿","和你合作真是太愉快了","你的牌打得太好了","下次再玩吧，我要走了","再见咯，我会想念大家的","怎么又断线了，网络怎么这么差呀"],window.rules1="一、基本用词说明\n    1.手牌：即自己手中的所有牌(自己可看见牌的正面，别人只能看见牌的背面)，庄家起始14张手牌，闲家起始13张手牌。\n    2.明牌：即自己 碰、明杠、暗杠、补杠、吃、亮杠、加杠 后，摆放在自己手牌旁边的所有牌。\n    2.庄家：每一局都有一个人是庄家，第一局的庄家是房间的创建者。庄家赢牌或输牌时，输赢要翻倍。\n    3.闲家：每一局都有三个人是闲家。庄家赢牌或输牌时，输赢按照正常的处分流程计算。\n    4.亮杠：在自己出第一张牌之前，如果自己的手牌中有：\n             1)一条、一筒、一万 各一张，则可亮杠，亮杠后 称这种亮杠为 “幺杠”\n             2)九条、九筒、九万 各一张，则可亮杠，亮杠后 称这种亮杠为 “九杠”\n             3)红中、发财、白板 各一张，则可亮杠，亮杠后 称这种亮杠为 “旋风杠”\n             3)白板、八条、九万 各一张，则可亮杠，亮杠后 称这种亮杠为 “白八九杠”\n    5.幺九杠: 幺杠 和 九杠 合称为 幺九杠。\n    6.序数牌：指 1筒~9筒、1条~9条、1万~9万。\n    7.箭牌：指 红中、发财、白板。\n    8.顺子：筒牌中连续三张牌可组成一个顺子，条牌中连续三张牌可组成一个顺子，万牌中连续三张牌可组成一个顺子，注意 一张红中+一张发财+一张白板不能组成一个顺子。\n            如：一张3筒+一张4筒+一张5筒为一顺，一张3筒+一张4条+一张5筒不是一顺。\n    9.一对或对子：指两张完全一样的牌。\n    10.刻子：指三张完全一样的牌。\n    11.杠子：指手中的四张完全一样的牌。\n    12.杠：指 明杠、暗杠、补杠、加杠、特殊杠。\n    13.一般的杠： 指 明杠、暗杠、补杠。\n    13.特殊杠：指 幺九杠、旋风杠、白八九杠、加杠。\n    14.缺1、9：指 手牌中没有 1条、1万、1筒、九条、九万、九筒 这六张牌中的任何一张牌\n                 并且 明牌中也没有 1条、1万、1筒、九条、九万、九筒 这六张牌中的任何一张牌。\n    15.不能缺1、9：指手牌或明牌中 必须至少要有 1条、1万、1筒、九条、九万、九筒 这六张牌中的一张或多张牌。\n    16.缺一门：指手牌和明牌合起来的所有牌中 只有筒牌、条牌、万牌这三类牌中的两类牌。(注意有没有中发白，和缺门没有关系)\n    17.缺二门：指手牌和明牌合起来的所有牌中 只有筒牌、条牌、万牌这三类牌中的一类牌。(注意有没有中发白，和缺门没有关系)\n    18.不缺门：指手牌和明牌合起来的所有牌中 包含了筒牌、条牌、万牌这三类牌。(注意有没有中发白，和缺门没有关系)\n    19.缺门：指 缺一门 或 缺二门。\n    20.一圈：指房间中的四个人每个人都当过一次庄家，算作打完了一圈。\n\n    21.夹胡：如果自己可以只能胡一张牌，并且最后胡牌了，称为夹胡。\n    22.屁胡：如果自己可以胡两张牌或以上，并且最后胡牌了，称为屁胡。\n    23.飘胡：即加上胡的那一张牌后，牌型是：明牌中没有吃(但明牌中可以有杠、碰)，手牌中只有对子或刻子。(注意杠的含义，见 基本用词说明)\n    24.站立胡：即 明牌中没有吃、一般的杠、碰(但明牌中可以有特殊杠)，最后胡牌了，称为站立胡。\n    25.开门胡：除了站立胡以外的情况，都算作开门胡。\n    26.自摸：自己摸了一张牌后，胡牌了，称为自摸。\n    27.放炮：自己打了一张牌被别人胡了，就称自己 放炮。\n    28.接炮：别人打了一张牌被自己胡了，就称自己 接炮。",window.rules2="\n二、基本规则\n    1.所有的牌共120张：其中 筒牌：1筒~9筒，每种牌4张，共计36张\n                          条牌：1条~9条，每种牌4张，共计36张\n                          万牌：1万~9万，每种牌4张，共计36张\n                          箭牌：红中 共4张，发财 共4张，白板 共4张， 共计12张\n                          没有东南西北。\n    2.有庄家和闲家之分。\n    3.可以碰：即 别人出了一张牌，而自己手中有 与这张牌完全相同的牌 两张，则自己可以选择碰，碰后要出一张牌。\n    4.可以明杠：即 别人出了一张牌，而自己手中有 与这张牌完全相同的牌 三张，则自己可以选择明杠，明杠后要拿一张牌。\n    5.可以暗杠：即 自己拿了一张牌后，而自己手中有 四张完全相同的牌， 则自己可以选择暗杠，暗杠后要拿一张牌。\n    6.可以补杠：即 自己拿了一张牌后，而自己以前碰过这张牌，则自己可以选择补碰，补后要拿一张牌。\n    7.可以加杠(也称攒杠)：即 自己拿了一张牌后，而自己手中有以前亮杠过的牌，则自己可以选择加杠，加杠后要拿一张牌。\n    8.可以吃：即 别人出了一张牌，而自己手中有两张牌能与出的那张牌组合成顺子，则自己可以选择吃，吃后要出一张牌。\n    9.没有听。\n    10.没有一炮多响(即别人出了一张牌后，只能有一个人可以胡这张牌)。\n    11.在一局中只要有人胡牌了 或 牌拿完了，这一局就结束。\n\n    12.玩家的坐位按加入房间的先后顺序顺时针依次确定。\n    13.轮流拿牌的顺序为逆时针方向。\n\n三、基本胡牌规则\n        1．除了飘胡以外，必须要三色俱全才能胡牌，即手牌中与必须条，饼，万三门花色都要有；\n        2．当有 中发白杠 或 胡牌类型是飘胡 的时候可缺1、9，其它情况不能缺1，9；\n        3. 可以飘胡，即加上胡的那一张牌后，牌型是：明牌中没有吃(但明牌中可以有杠、碰)，手牌中只有对子或刻子。(注意杠的含义，见 基本用词说明)\n            飘胡可以缺门，可以缺1、9。\n        4. 幺九杠(一条+一筒+一万 或 九条+九筒+九万)、中发白杠(也叫旋风杠)、白八九杠(白板+八条+九万)可以攒杠。\n        5.手牌+要胡的那张牌后：必须有一个对子，除去这个对子后，如果手中还有其它的牌，则其它牌的全部是顺子或刻子才能胡牌。\n四、庄家规则\n　     1．第一局由房间的创建者作为庄家；\n　     2．庄家胡牌，则下一局的庄家不变(还是他自己)。闲家胡牌则按逆时方向轮流坐庄。\n　     3．庄家胡牌多赢一番，别人胡牌多输一番。\n五、加番牌型\n    由底分、统计的番数、杠牌结算构成，即 总分 = 底分 * 番 + 杠牌得分。\n    算分步骤：\n        第一步：根据 是否是40算法、屁胡/夹胡/飘胡 确定底分。\n        第二步：根据每个人是否是 开门胡/站立胡、放炮者、庄家、自摸确定番数，以此乘以底分。\n        第三步：根据是否是责任制，确定放炮者和点杠者的分数情况。(是否是责任制只会影响点杠、放炮的相关计算，而不影响暗杠、特殊杠等)\n        第四步：计算每个人的杠牌分，再加上前面算的分即是总分。\n",window.rules3="\n六、算分规则说明:\n    1.算法：\n        非40算法：屁胡 -- 底分1分，夹胡 -- 底分2分，飘胡 -- 底分4分（注: 如果胡牌了，则胡牌的类型一定是这三种中的一种）;\n        40算法：屁胡 -- 底分5分，夹胡 -- 底分10分，飘胡 -- 底分20分;\n    2.番: 1番 = 底分 × 1; 2番= 底分 × 2; 3番= 底分 × 4; 4番= 底分 × 8;\n    3.杠:\n       普通杠：暗杠：5分; 明杠3分; 补杠3分 。如: 2个明杠6分,3个明杠9分;\n       特殊杠: 3分 ，每多加一杠，就多加3分; 如：只亮了一杠且没有加杠，则每家-3分, 亮杠者+9分，在此基础上加一杠：则 每家-6分, 亮杠者+18分;\n    4.责任制与非责任制:\n        非责任制：\n            玩家1 明杠玩家2: 玩家1=9分,其他三家=-3分;\n            玩家1暗杠: 玩家1=15分, 其他三家=-5分\n        责任制:\n            玩家1 明杠玩家2: 玩家1=9分,玩家2=-9分,其他2家=0分;\n            玩家1暗杠: 玩家1=15分, 其他三家=-5分\n    5.加番的情况：\n        胡牌分站立胡和开门胡两种\n        开门胡不加番。\n        站立胡：加一番。如 非责任制，非40算法，夹胡, 又是站立胡, 则牌型算分是4分。\n        放炮者牌型算分上要多加一番, 如 非责任制，非40算法，牌型算分是4分,则点炮者-8分。\n        庄家翻倍: 庄家点炮要翻倍(加一番)。注意，这里指的是庄家本身，点炮者也要翻倍，所以这里就番了2倍。\n                 庄家胡牌要翻倍(加一番)。\n        自摸翻倍：如：非责任制，非40算法，夹胡, 又是站立胡, 则牌型算分是4分，如果是自摸的，则牌型算分是4分×2 = 8分。\n    6.举例:\n        一.非责任制,非40算法\n            1.庄家自摸且是站立胡,胡牌类型为飘胡则分数:\n                牌型算分 = 4(飘胡底分) *2(庄家)*2(站立胡)*2(自摸)=32分\n                庄家得分 =32*3=96分\n                其他3家得分 =-32分\n            2.庄家胡牌且是站立胡,胡牌类型为飘胡则分数:\n                牌型算分 = 4(飘胡底分) *2(庄家)*2(站立胡) =16分\n                点炮者=-32分 = -(16(牌型算分)*2(点炮))\n                其他2家=-16分\n                庄家得分= 64分\n        二.责任制,非40算法\n            1.庄家自摸且是站立胡,胡牌类型为飘胡则分数:\n                牌型算分 = 4(飘胡底分) *2(庄家)*2(站立胡)*2(自摸)=32分\n                庄家得分 =32*3=96分\n                其他3家得分 =-32分\n            2.庄家胡牌且是站立胡,胡牌类型为飘胡则分数:\n                牌型算分 = 4(飘胡底分) *2(庄家)*2(站立胡) =16分\n                点炮者=-64分 = -(16(牌型算分)*2(点炮)+32(其他2家))\n                其他2家=0分\n                庄家得分= 64分\n",
cc._RFpop()},{conditions:"conditions",log:"log",napaiMng:"napaiMng"}],handCardsBase:[function(e,t,r){"use strict";cc._RFpush(t,"e2d2dAFlxNIh481ZbX3772a","handCardsBase");var a=logConfig(4),s=cc.Class({name:"HandCardsBase",ctor:function(){arguments[0];this._init()},_init:function(){this.order={f:0,j:1,o:2,t:3,w:4,0:"f",1:"j",2:"o",3:"t",4:"w",fe:0,fs:1,fx:2,fn:3,f0:"e",f1:"s",f2:"x",f3:"n",jz:0,jf:1,jb:2,j0:"z",j1:"f",j2:"b"},this.originalCardsHand=[],this.cardsHand=[[0,0,0,0],[0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]],this.cardsHandArr=[],this.cardsNum=0},setCards:function(e){"object"!=typeof e.originalCardsHand?(this.cardsNum=e.originalCardsHand,this.originalCardsHand=this.cardsNum):(this.originalCardsHand.length=0,TOOL.copyArray(this.originalCardsHand,e.originalCardsHand),this._clearCardsHand_(),this._convertToCardsHand_(),this.cardsNum=e.originalCardsHand.length)},reset:function(){a.log4("handCardsBase.js重置了。"),"object"==typeof this.originalCardsHand&&(this.originalCardsHand.length=0,this._clearCardsHand_(),this.cardsHandArr.length=0),this.cardsNum=0},operateCard:function(e,t,r){if("object"!=typeof this.originalCardsHand){switch(r){case"add":this.cardsNum+=t;break;case"set":break;case"sub":this.cardsNum-=t}return this.cardsNum}var a=this._getCardCoord(e);switch(r){case"add":this.cardsHand[a.i][a.j]+=t,this.cardsNum+=t;break;case"set":this.cardsHand[a.i][a.j]=t,this.cardsNum+=t-this.cardsHand[a.i][a.j];break;case"sub":this.cardsHand[a.i][a.j]-=t,this.cardsNum-=t}return this.cardsHand[a.i][a.j]},forEach:function(e,t){t=t||this;var r=null,a=this.cardsHand.length,s=null,i={num:0,cardName:"",typeName:"",i:0,j:0,arr:null,cardsHand:null};e:for(var o=0;o<a;o++){r=this.cardsHand[o];t:for(var n=0;n<r.length;n++)switch(i.num=r[n],i.cardName=this._getCardNameFromCoord(o,n),i.typeName=this.order[o],i.j=n,i.i=o,i.arr=r,i.cardsHand=this.cardsHand,s=e.call(t,i)){case"breakOuter":break e;case"breakInner":break t;case"continueInner":continue t;case"continumOuter":continue e}}},forEachReduce:function(e,t){t=t||this;var r=null,a=this.cardsHand.length,s=null,i={num:0,cardName:"",typeName:"",i:0,j:0,arr:null,cardsHand:null};e:for(var o=a-1;o>-1;o--){r=this.cardsHand[o];t:for(var n=r.length-1;n>-1;n--)switch(i.num=r[n],i.typeName=this.order[o],i.cardName=this._getCardNameFromCoord(o,n),i.j=n,i.i=o,i.arr=r,i.cardsHand=this.cardsHand,s=e.call(t,i)){case"breakOuter":break e;case"breakInner":break t;case"continueInner":continue t;case"continumOuter":continue e}}},outerForEach:function(e,t){t=t||this;var r=this.cardsHand.length,a=null,s={typeName:"",i:0,arr:null,cardsHand:null};e:for(var i=0;i<r;i++)switch(s.typeName=this.order[i],s.i=i,s.arr=this.cardsHand[i],s.cardsHand=this.cardsHand,a=e.call(t,s)){case"break":break e;case"continue":continue e}},getLen:function(){if("object"!=typeof this.originalCardsHand)return this.cardsNum;var e=0;return this.forEach(function(t){e+=t.num}),e},getCardNums:function(e){var t=this._getCardCoord(e);return this.cardsHand[t.i][t.j]},_getCardNameFromCoord:function(e,t){return"object"==typeof e&&(e=e.i,t=e.j),"f"===this.order[e]||"j"===this.order[e]?this.order[this.order[e]+t]:this.order[e]+(t+1)},_getCardCoord:function(e){var t=e,r=0,a=0,s=null;return 2==t.length?(a=t.charAt(1)-1,t=t.charAt(0),r=this.order[t]):(s="z"===t||"f"===t||"b"===t?"j":"f",r=this.order[s],a=this.order[s+t]),{i:r,j:a}},_convertToCardsHand_:function(){var e=this.originalCardsHand.length;a.log1("转换时："+this.originalCardsHand);for(var t=0;t<e;t++){var r=this.originalCardsHand[t];if(1===r.length)switch(r){case"e":case"x":case"s":case"n":this.cardsHand[this.order.f][this.order["f"+r]]++;break;case"z":case"f":case"b":this.cardsHand[this.order.j][this.order["j"+r]]++}else 2===r.length&&this.cardsHand[this.order[r.charAt(0)]][r.charAt(1)-1]++}},_clearCardsHand_:function(){this.forEach(function(e){e.arr[e.j]=0})}});t.exports=s,cc._RFpop()},{}],handCardsChild:[function(e,t,r){"use strict";cc._RFpush(t,"a1bfd6EBXFLfLDUAtlkITaS","handCardsChild");var a=e("handCards"),s=(logConfig(4),cc.Class({name:"HandCardsChild","extends":a,ctor:function(){this.cardsTypeNum=[0,0,0,0,0]},getCardNumFromType:function(e,t){t=t||this;var r=0;return this.cardTypeForEach(e,function(e){e.num>0&&r++},t),r},getCardHaveNumFromType:function(e,t){for(var r=0,a=0;a<e.length;a++)e[a].charAt(0)===t&&(r+=1);return r},getHaveCardFromType:function(e,t){for(var r=!1,a=[],s=0;s<e.length;s++)e[s].charAt(0)===t&&a.push(e[s]);for(var i=0;i<a.length;i++)if("1"===a[i].charAt(1)||"9"===a[i].charAt(1))return r=!0;return r},multiCardTypeForEach:function(e){for(var t=0;t<arguments.length&&"string"==typeof arguments[t];t++);for(var r,a=0;a<t;a++)switch(r=this.cardTypeForEach(arguments[a],arguments[t],arguments[t+1])){case"return":return}},getAllCardsStr:function(){return this.cardsHandConvertToArr().toString()},staticsCardsHand:function(){return this.forEach(function(e){this.cardsTypeNum[e.num]++}),this.cardsTypeNum}}));t.exports=s,cc._RFpop()},{handCards:"handCards"}],handCards:[function(e,t,r){"use strict";cc._RFpush(t,"6da4314wQJK96ARSA8YQcxS","handCards");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=logConfig(4),i=e("handCardsBase"),o=cc.Class({name:"HandCards","extends":i,ctor:function(){this.isZFBOrder=room.attr("isZFBOrder")},cardTypeForEach:function(e,t,r){r=r||this;var a=this.order[e],s=this.cardsHand[a],i=s.length,o=null,n={};e:for(var c=0;c<i;c++)switch(n.num=s[c],n.cardName=this._getCardNameFromCoord(a,c),n.typeName=this.order[a],n.j=c,n.i=a,n.arr=s,n.cardsHand=this.cardsHand,o=t.call(r,n)){case"break":break e;case"return":break e;case"continue":continue e}return o},checkHandCard:function(e,t,r){var a=this.getCardNums(e),i=[];if("fromOther"===t){if(r){var o=this._checkChi_(e);o&&(i.push(o),s.log1("checkCard: 可以进行吃。"))}2===a?(i.push({operateName:"pong",operateCard:e}),s.log1("checkCard: 可以进行碰。")):3===a&&(i.push({operateName:"pong",operateCard:e},{operateName:"mingGang",operateCard:e}),s.log1("checkCard: 可以进行碰或明扛。"))}else this.checkAnGang(i);return i},checkNum:function(e){var t=this.getCardNums(e);return t<1?(this.forEach(function(t){if(t.num>0)return e=t.cardName,"breakOuter"}),e):e},checkAnGang:function(e){var t=this._getFourCard_();if(t.length>0){for(var r=0;r<t.length;r++)e.push({operateName:"anGang",operateCard:t[r]});s.log1("checkCard: 可以进行暗扛。")}},_checkChi_:function(e){var t,r=this._getCardCoord(e),a=this.order[r.i];switch(a){case"f":case"j":this.isZFBOrder&&(t=this._checWordChi_(e,a));break;case"o":case"t":case"w":t=this._checkNumChi_(e,a)}return t},_checkNumChi_:function(e,t){var r={operateName:"chi",operateCard:e,cards:[]};return this.cardTypeForEach(t,function(t){if(e===t.cardName){if(t.arr[t.j-1]>0){var a=this._getCardNameFromCoord(t.i,t.j-1);if(t.arr[t.j-2]>0){var s=this._getCardNameFromCoord(t.i,t.j-2);r.cards.push([s,e,a])}if(t.arr[t.j+1]>0){var i=this._getCardNameFromCoord(t.i,t.j+1);r.cards.push([a,e,i])}}if(t.arr[t.j+1]>0&&t.arr[t.j+2]>0){var i=this._getCardNameFromCoord(t.i,t.j+1),o=this._getCardNameFromCoord(t.i,t.j+2);r.cards.push([i,e,o])}return"break"}}),0!==r.cards.length&&r},_checWordChi_:function(e,t){var r={operateName:"chi",operateCard:e,cards:[]},a=[];switch(this.cardTypeForEach(t,function(t){return e===t.cardName?"continue":void(t.num>0&&a.push(t.cardName))}),a.length){case 2:r.cards.push([a[0],e,a[1]]);break;case 3:r.cards.push([a[0],e,a[1]]),r.cards.push([a[0],e,a[2]]),r.cards.push([a[1],e,a[2]])}return 0!==r.cards.length&&r},_getFourCard_:function(){var e=[];return this.forEach(function(t){4===t.num&&e.push(t.cardName)}),e},cardsHandConvertToArr:function(){return this.cardsHandArr.length=0,this.forEach(function(e){for(var t=0;t<e.num;t++)this.cardsHandArr.push(e.cardName)}),this.cardsHandArr},getHandCard:function(){return"object"!==a(this.originalCardsHand)?this.cardsNum:(this.cardsHandArr.length=0,this.forEach(function(e){for(var t=0;t<e.num;t++)this.cardsHandArr.push(e.cardName)}),this.cardsHandArr)},getCardName:function(e,t){return"f"===e||"j"===e?this.order[e+t]:e+(t+1)},getSpecialGangAll:function(){for(var e,t=arguments,r=[],a=0;a<t.length;a++){switch(t[a]){case"xuanFengGang":e=this._specialGang_("z","f","b","xuanFengGang");break;case"yaoGang":e=this._specialGang_("o1","t1","w1","yaoGang");break;case"jiuGang":e=this._specialGang_("o9","t9","w9","jiuGang");break;case"baiJiuGang":e=this._specialGang_("b","t8","w9","baiJiuGang")}e.length>0&&r.push(e)}return r},_specialGang_:function(e,t,r,a){var s=[],i=0,o=0,n=0;return this.forEach(function(a){a.num>0&&(a.cardName===e?i+=1:a.cardName===t?o+=1:a.cardName===r&&(n+=1))}),i>0&&o>0&&n>0&&(s=[e,t,r],s.name=a),s}});t.exports=o,cc._RFpop()},{handCardsBase:"handCardsBase"}],hand_operatePanel:[function(e,t,r){"use strict";cc._RFpush(t,"91fcd//UltD54lgfFxdJ6KF","hand_operatePanel");var a=logConfig(4),s=cc.Class({name:"OperateEvent",ctor:function(){var e=arguments[0];this.gameMain_Atlas=e.userSelf.attr("gameMain_Atlas"),this.cards_Atlas=e.userSelf.attr("cards_Atlas"),this.userNode=e.userSelf.attr("userNode"),this.operateNode=this.userNode.getChildByName("operate"),this.operateNodeArr=this.operateNode.children,this.spaceX=this.operateNode.scaleX*(this.operateNodeArr[0].x-this.operateNodeArr[1].x),this.cardGroup=this.userNode.getChildByName("cardGroup"),this.cardGroup.active=!1,this.cardGroupX=this.cardGroup.x,this.buGangGroup=this.userNode.getChildByName("buGangGroup"),this.buGangGroup.active=!1,this.buGangGroupX=this.buGangGroup.x,this.buGangGroupWidth=this.buGangGroup.width,this.isShowing=!1,this.isCanShowPanel=!0,this.isShowBox=!1},reset:function(){a.log4("hand_operatePanel.js重置了。"),this.isShowing=!1,this.isCanShowPanel=!0,this.operateArr=null,this.isShowBox=!1,this.cardGroup.x=this.cardGroupX,this.buGangGroup.x=this.buGangGroupX,this.buGangGroup.width=this.buGangGroupWidth},showPanel:function(e){if(this.isCanShowPanel){var t=!1,r=!1;this.isShowing=!0,this.operateArr=e;for(var a=0;a<e.length;a++){var s=e[a].operateName;"chi"!==s&&"specialGang"!==s||(t=this._showChi_(e[a].cards)>0);var i=e[a].operateCard;"specialBuGang"===s&&(r=this._showSpecialBuGang_(e[a].operateCard)>0,i=""),this._setOperateWord_(this.operateNodeArr[a],s),this._showOperateCard_(this.operateNodeArr[a],s,i)}t&&(t=!1,this.cardGroup.active=!1),r&&(r=!1,this.buGangGroup.active=!1);for(var o=a;o<this.operateNodeArr.length;o++)this.operateNodeArr[o].active=!1;this.operateNode.active=!0}},_showChi_:function(e){for(var t=0;t<e.length;t++){for(var r=this.cardGroup.getChildByName("groupRect"+t),a=0;a<3;a++){var s=r.getChildByName("node"+a);s.getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame("mingmah_"+e[t][a])}r.active=!0}for(var a=t;a<4;a++)this.cardGroup.getChildByName("groupRect"+a).active=!1;return t},_showSpecialBuGang_:function(e){var t=this.buGangGroup.children.length-1,r=0;for(var a in e){var s=this.buGangGroup.getChildByName("node"+(t-r));s.getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame("mingmah_"+a),e[t-r]=a,s.active=!0,r++}for(var i=t-r;i>-1;i--)this.buGangGroup.getChildByName("node"+i).active=!1;return this.buGangGroup.width=r*s.width+20*r,r},setChiBox:function(e){"toggle"===e?this.isShowBox=!this.cardGroup.active:this.isShowBox="show"===e,this.cardGroup.active=this.isShowBox,this.isShowBox&&(this.buGangGroup.active=!1)},setSpecialBuBox:function(e){"toggle"===e?this.isShowBox=!this.buGangGroup.active:this.isShowBox="show"===e,this.buGangGroup.active=this.isShowBox,this.isShowBox&&(this.cardGroup.active=!1)},hidePanel:function(){this.isShowing=!1,this.operateNode.active=!1,this.cardGroup.active=!1,this.buGangGroup.active=!1},setIsCanShowPanel:function(e){this.isCanShowPanel=e},getIsCanShowPanel:function(){return this.isCanShowPanel},getIsShowing:function(){return this.isShowing},_setOperateWord_:function(e,t){var r="";switch(t){case"guo":r="guo";break;case"pong":r="Pong";break;case"chi":r="chi";break;case"buGang":case"anGang":case"mingGang":r="gang";break;case"hu":r="hu";break;case"ting":r="ting"}var a="button_"+r;"specialBuGang"===t?a="button_buGang":"specialGang"===t&&(a="liangxini"),e.getComponent(cc.Sprite).spriteFrame=this.gameMain_Atlas.getSpriteFrame(a),e.active=!0},_showOperateCard_:function(e,t,r){var a=e.getChildByName("operateCard");"guo"===t||"ting"===t?a.active=!1:(a.getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame("mingmah_"+r),a.active=!0)}});t.exports=s,cc._RFpop()},{}],hand_otherDisplay:[function(e,t,r){"use strict";cc._RFpush(t,"83e00npYudApL8IGM8cR0qw","hand_otherDisplay");var a=logConfig(4),s=cc.Class({name:"OtherDisplay",ctor:function(){var e=arguments[0];this.handNode=e.userSelf.attr("handNode"),this.handNodeArr=this.handNode.children,this.isHasMask=!!this.handNodeArr[0].getChildByName("mashMask")},reset:function(){a.log4("hand_otherDisplay.js重置了。"),this.setTingMask("hide")},setTingMask:function(e){if(this.isHasMask)for(var t=0;t<this.handNodeArr.length;t++)this.handNodeArr[t].getChildByName("mashMask").active="show"===e}});t.exports=s,cc._RFpop()},{}],hand_outCardEvent:[function(e,t,r){"use strict";cc._RFpush(t,"a3e74SYnxtE1Z07IsxD0g3k","hand_outCardEvent");var a=cc.Class({name:"OutCardEvent",properties:{handNode:null},ctor:function(){var e=arguments[0];this.handNode=e.userSelf.attr("handNode"),this.clickNum=0,this.clickNode=null,this.isCanOperate=!0,this.isCanPlay=!0,this.handCardNodes=this.handNode.children,this._andClick_()},reset:function(){this.clickNum=0,this.clickNode&&(this.clickNode.y=0),this.clickNode=null,this.isCanOperate=!0,this.isCanPlay=!0},mahRunBack:function(){this.clickNode&&(this.clickNode.y=0,this.clickNode=null)},outCardEventAttr:function(e,t){return void 0===t?this[e]:this[e]=t},_andClick_:function(){for(var e=0;e<14;e++)"touches"in cc.sys.capabilities?(console.log("outCardEvent--touches"),this.handCardNodes[e].on("touchstart",this._clickDown_,this),this.handCardNodes[e].on("touchend",this._clickUp_,this)):"mouse"in cc.sys.capabilities&&(console.log("outCardEvent--mouse"),this.handCardNodes[e].on("mousedown",this._clickDown_,this),this.handCardNodes[e].on("mouseup",this._clickUp_,this))},_clickDown_:function(e){if(this.isCanOperate){audio.play("select");var t=e.target;this.clickNode===t?this.clickNum=2:null===this.clickNode?(this.clickNode=t,this.clickNum=1,t.runAction(cc.moveBy(.03,0,15))):(this.clickNum=3,t.runAction(cc.moveBy(.03,0,15)),this.clickNode.y=0,this.clickNode=t)}},_clickUp_:function(e){if(this.isCanOperate){var t=e.target;if(2===this.clickNum&&this.isCanPlay){this.isCanPlay=!1;var r=clientUser.attr("cardsHandOrder")[t.name];console.log("点击选中的牌是："+r),clientUser.outCard(r,clientUser.attr("openId")),this.clickNode.y=0,this.clickNode=null}}}});t.exports=a,cc._RFpop()},{}],inputNumPanel:[function(e,t,r){"use strict";cc._RFpush(t,"35f65tiA5VMZp0sVbBaez7r","inputNumPanel");var a=cc.Class({name:"InputNumPanel",properties:{nums:null,numBtnNodes:null,hasInputedArr:[],maxLen:0},ctor:function(){this.nums=cc.find("Canvas/addRoomAlert/alertContent/line").children,this.numBtnNodes=cc.find("Canvas/addRoomAlert/alertContent/buttons").children,this.maxLen=this.nums.length,this.reset(),this._addClick_()},reset:function(){this.hasInputedArr.length=0,this.nums.forEach(function(e){e.getComponent(cc.Label).string=""})},_addClick_:function(){for(var e=0;e<this.numBtnNodes.length;e++)this.numBtnNodes[e].on("click",function(e){this._pressBtnClick_(e.target.name)},this)},_pressBtnClick_:function(e){switch(audio.play("waterClick"),e){case"del":0!==this.hasInputedArr.length&&this._del_();break;case"reset":this.reset();break;default:this.maxLen>this.hasInputedArr.length&&(this._add_(e),this.maxLen==this.hasInputedArr.length&&(clientUser?clientUser.send({message:this.hasInputedArr.join(""),type:"join"}):getGI("hall").errorReminder("未连接到服务器!")))}},_add_:function(e){var t=this.hasInputedArr.push(e)-1;this.nums[t].getComponent(cc.Label).string=e},_del_:function(){this.hasInputedArr.pop();var e=this.hasInputedArr.length;this.nums[e].getComponent(cc.Label).string=""}});t.exports=a,cc._RFpop()},{}],isOnline_controller:[function(e,t,r){"use strict";cc._RFpush(t,"fdc79Gh8ZRLnrW3kD1fRhO0","isOnline_controller");var a=logConfig(4),s=cc.Class({name:"IsOnline_controller",leaveLine_controller:function(e){a.log2("执行 leaveLine_controller..."),console.log(e);var t=e.message,r=room.getUser(t);r.attr("state",0),r.displayHead("leaveLine","show"),room.dismissAlert&&(room.dismissAlert.reset(),room.dismissAlert.dismissShow("hide")),room&&room.displayRoomInfo&&room.displayRoomInfo("reminder",r.attr("nickName")+" 离线了..."),clientUser.sleep(),socket.finishMsg("leaveLine")},reConnect_controller:function(e){a.log2("执行 reConnect_controller..."),console.log(e);var t=e.message,r=room.getUser(t);r.attr("state",1),r.displayHead("leaveLine","hide");var s=!0;room.forEach(function(e){if(e&&0===e.attr("state"))return s=!1,"break"}),r!==clientUser&&room&&room.displayRoomInfo&&room.displayRoomInfo("reminder",r.attr("nickName")+" 上线了..."),s&&clientUser&&clientUser.wake(),socket.finishMsg("reConnect")},exitRoom_controller:function(e){a.log2("执行 exitRoom_controller...");var t=e.message;if(!room||room.msgIsMeSend(t))return void socket.finishMsg("exitRoom");var r=room.getUser(t);r.attr("zhuang")?cc.director.loadScene("hall",function(){window.reset(),getGI("hall").display({nickName:clientUser.attr("nickName"),userId:clientUser.attr("userId"),headIcon:clientUser.attr("faceIcon"),roomCardNum:clientUser.attr("roomCards")}),socket.finishMsg("exitRoom")}):(this._resetUserHead_(r),room.removeUser(r),socket.finishMsg("exitRoom"))},_resetUserHead_:function(e){e.displayHead({zhuang:"hide",faceIcon:"man0",nickName:"hide",ting:"hide",score:"hide",ok:"hide",leaveLine:"hide"})}});t.exports=s,cc._RFpop()},{}],join_controller:[function(e,t,r){"use strict";cc._RFpush(t,"c79a5zZg9FCqJuZzBmv0qB4","join_controller");var a=logConfig(4),s=e("room"),i=e("user"),o=cc.Class({name:"Join_controller",create_controller:function(e){a.log2("执行 create_controller..."),this.join_controller(e)},join_controller:function(e){a.log2("执行 join_controller...");var t=e.message,r=e.message.roomUsers,i=t.meOrder-1;if(window.room)a.log1("后来，每加入一个人，就创建与其相应的用户，并显示出来"),this._andOneUser_(r[i],i),console.log("每一次加入房间的 ：",room),socket.finishMsg("join");else{a.log1("如果自己还没进入房间"),window.room=new s({roomId:t.roomId,totalJuNum:t.totalJuNum,totalQuan:t.totalQuanNum,currentQuan:1,currentJuNum:1}),this._initSetting_(t.opt);var o=this;cc.director.loadScene("room",function(){a.log1("场景加载完成"),TOOL.resetData(),"open"===getGI("bgMusic")&&audio.play("playingBg.mp3",!0),setGI("roomSceneFinished",!0),room.combineAction(),a.log1(room),room.displayRoomInfo({roomId:t.roomId,juCount:{currentJuNum:1,totalJuNum:t.totalQuanNum},arithmetic:"setting"}),TOOL.replaceShareUrl(room.roomId),o._addBeforeUsers_(r,i),room.attr("period","readying"),socket.finishMsg("join")})}},_initSetting_:function(e){for(var t=0;t<e.length;t++)switch(e[t]){case 5:room.attr("is40Arithmetic",!0);break;case 1:room.attr("isPromise",!0);break;case 2:room.attr("isAllowYaoJiu",!0);break;case 3:room.attr("isAllowXuanFeng",!0);break;case 4:room.attr("isAllowBaiJiu",!0)}},_addBeforeUsers_:function(e,t){for(var r,a=e.length,s="hide",o=4,n=0,c=a-1;c>-1;c--){s=0===c?"show":"hide";var h=e[c];if(c!==t){if(c<t)var l=--o;else var l=++n;r=new i({attr:{cards:h.cards,faceIcon:h.faceIcon,nickName:h.nickName,openId:h.openId,userId:h.userId,joinOrder:c,positionOrder:l,sex:1===h.sex?"man":"woman",ip:h.ip,whoseVoice:1===h.sex?"m1":"g1",zhuang:0===c,isClient:!1,isActive:!1,state:h.state,isReady:h.ready}})}else clientUser.attr({joinOrder:c,positionOrder:0,sex:1===h.sex?"man":"woman",whoseVoice:1===h.sex?"m1":"g1",zhuang:0===c,isActive:!0,state:h.state,isReady:h.ready}),r=clientUser,room.displayRoomInfo({inviteBtn:"show",readyBtn:"show"});r.combineAction(),this._displayHead_(r),room.addUser(r),console.log("第一次加入房间的 ：",room)}},_andOneUser_:function(e,t){var r=clientUser.attr("joinOrder");if(t<r)var a=4-(r-t);else var a=0-(r-t);var s=new i({attr:{cards:e.cards,faceIcon:e.faceIcon,nickName:e.nickName,openId:e.openId,userId:e.userId,joinOrder:t,positionOrder:a,sex:1===e.sex?"man":"woman",ip:e.ip,whoseVoice:1===e.sex?"m1":"g1",zhuang:!1,isClient:!1,isActive:!1,state:e.state,isReady:e.ready}});s.combineAction(),this._displayHead_(s),room.addUser(s)},_displayHead_:function(e){var t=e.attr({faceIcon:null,zhuang:null,sex:null,state:null,isReady:null,nickName:null});e.displayHead({zhuang:t.zhuang?"show":"hide",faceIcon:t.faceIcon,nickName:t.nickName,ting:"hide",score:0,ok:t.isReady?"show":"hide",leaveLine:0===t.state?"show":"hide"})}});t.exports=o,cc._RFpop()},{room:"room",user:"user"}],juEnd_controller:[function(e,t,r){"use strict";cc._RFpush(t,"c5a77zT0QVAfLB5YkPE6cnb","juEnd_controller");var a=logConfig(4),s=cc.Class({name:"JuEnd_controller",juScore_controller:function(e){a.log2("执行 juScore_controller..."),a.log1(e),room.attr("period","endJu"),room.singleResult.refreshMahResult(e.message.juResults),room.singleResult.singelResultShow("show"),room.displayPointer(-1),room.currentJuNum=e.message.useJuNum,room.totalJuNum=e.message.totalJuNum,room.totalQuan=e.message.totalQuanNum,room.currentQuan=e.message.useQuanNum,room.nextZhuang=e.message.zhuangId,socket.finishMsg("juScore")},roomScore_controller:function(e){a.log2("执行 roomScore_controller..."),a.log1(e),room.attr("dismissingNum",0),room.attr("period","endJu"),room.singleResult.singelResultShow("hide"),room.dismissAlert.dismissShow("hide",0),room.resultAlert.refreshMahResult(e.message),room.resultAlert.allResultShow("show"),room.displayPointer(-1),socket.finishMsg("roomScore")}});t.exports=s,cc._RFpop()},{}],localServer:[function(e,t,r){"use strict";cc._RFpush(t,"f7df0n3P9NA+IUl1zbuLydJ","localServer");var a=e("log"),s=new a(5);s.setOutLevel(4);var i=cc.Class({name:"LocalServer",ctor:function(){}});t.exports=i,cc._RFpop()},{log:"log"}],log:[function(e,t,r){"use strict";cc._RFpush(t,"566543zO+5IqofCUsxy8jbJ","log");var a=cc.Class({name:"Log",ctor:function(){var e=arguments[0];this.consoleLevel=arguments[1];for(var t=1;t<=e;t++)this["log"+t]=function(e){var t=this;return function(){null!=t.consoleLevel&&(e>=t.consoleLevel||e<=t.outLevel&&t._log.apply(t,[].concat(arguments,"log"+e)))}}.call(this,t);this.outLevel=window.debug},_log:function(){var e=this.isToJSON,t=0,r=[];if(arguments.length>2&&("json"===arguments[0]?(e=!0,t=1):"obj"===arguments[0]&&(e=!1,t=1)),e){for(var a=[],s=t;s<arguments.length-1;s++)"object"==typeof arguments[s]?a[s]=JSON.stringify(arguments[s]):a[s]=arguments[s];console.log.apply(console,a)}else{for(var s=t;s<arguments.length-1;s++)r.push(arguments[s]);console.log.apply(console,r)}},setOutLevel:function(e){this.outLevel=e},setIsToJSON:function(e){this.isToJSON=e}});t.exports=a,cc._RFpop()},{}],mahjongMngBase:[function(e,t,r){"use strict";cc._RFpush(t,"0b11201TahDV7pX7OOztS28","mahjongMngBase");var a=e("combination"),s=e("cardsMng"),i=logConfig(4),o=cc.Class({name:"MahjongMngBase",ctor:function(){var e=arguments[0];this.userSelf=e.userSelf,this.mahView=this._getMahView_(),this.mahModel=new s,this.animate=this._getAnimate_(),i.log1(this.mahView),i.log1(this.animate)},reset:function(){i.log4("mahjongMng.js重置了。"),this.mahView.reset(),this.mahModel.reset(),this.animate.reset()},setCards:function(){this.mahModel.setCards.apply(this.mahModel,arguments);var e=this.mahModel.getHandCard();if(i.log1(this.userSelf.attr("nickName")+" 的用户的牌是： "+e),this.mahView.displayHand(e),this.userSelf.attr("isClient")){var t=arguments[0].originalCardsHand;if(room.nextZhuang&&room.setZhuang(room.nextZhuang),this.mahView.outCardEventAttr("isCanPlay",this.userSelf.attr("zhuang")),this.userSelf.attr("zhuang")){var r=t[t.length-1];clientUser.attr("naPaiInfo").cardName=r,this.lianGangCheck(r)}else{var a=this.mahModel.getAllCanHuCards();if(i.log1("闲家的起手检查结果：",a),!room.attr("isSetTing"))return;if(0!==a.length){var s=this.mahModel.getAllJiao(),o=[{operateName:"guo"},{operateName:"ting",operateCard:s}];this.showPanel(o),this.userSelf.attr("operateArr",o)}}}},lianGangCheck:function(e,t){var r=this.checkCard(e,this.userSelf.attr("openId"),{isCalcHu:e,isCheckHu:"notCheckHu"!==t,isCheckChi:!1,isCheckLiangGang:""===this.userSelf.attr("firstOutCard")});r.hasOpt&&this.showPanel(r.optArr),i.log1("庄家的起手检查结果：",r.optArr)},inCard:function(e,t){if(console.log("执行了mahjongMngBase.inCard"+e),this.mahModel.inCard(e),this.mahView.inCard(e),this.userSelf.attr("haveCard")){var r=this.checkCard(e,this.userSelf.attr("openId"),{isCalcHu:t,isCheckHu:!0,isCheckChi:!1,isCheckLiangGang:""===this.userSelf.attr("firstOutCard")});i.log1("incard中的检查结果：",r),this.userSelf.attr("isClient")&&(r.hasOpt?r.ting?r.isCanHu?(this.userSelf.send({message:{huCard:e,from:this.userSelf.attr("openId")},type:"hu"}),this.userSelf.operateItem({operateName:"hu",operateCard:e})):this._autoOutCard_(e):(this.showPanel(r.optArr),this.mahView.outCardEventAttr("isCanPlay",!0)):(r.ting&&this._autoOutCard_(e),this.mahView.getIsShowing()&&this.mahView.hidePanel(),this.mahView.outCardEventAttr("isCanOperate",!0),this.mahView.outCardEventAttr("isCanPlay",!0)))}},_autoOutCard_:function(e){var t=this.userSelf;setTimeout(function(){t.outCard(e)},1500)},outCard:function(e,t,r){this.mahModel.outCard(e);var a=this.mahModel.getHandCard();this.mahView.displayHand(a);var s=this.mahView.operateOutCard("forward",e);this.animate.outCardAni(s,e,function(e){r&&r(),room.playOutSkipAni(e)}),this.userSelf.attr("haveCard")&&this.outCardPCheck(e,t)},rebuildOutCard:function(e,t){var r=this.mahView.getCurrentNode();r&&this.animate.outCardAni(r,e,function(e){room.playOutSkipAni(e)}),room.msgIsMeSend(t)&&this.outCardPCheck(e,t)},outCardPCheck:function(e,t){this.mahView.outCardEventAttr("isCanPlay",!1);var r=this.mahModel.getAllCanHuCards();if(i.log1("我打了一张牌后，胡的计算结果： ",r),room.attr("isSetTing")&&0!==r.length)if(this.userSelf.attr("ting")){var a=this.mahModel.checkHasHu(e);a&&this.userSelf.send({message:{huCard:e,from:t},type:"hu"})}else{var s=[{operateName:"guo"},{operateName:"ting",operateCard:this.mahModel.getAllJiao()}];this.userSelf.attr("operateArr",s),this.userSelf.attr("isClient")&&this.showPanel(s)}},_getMahView_:function(){var e=new a;return e.combination([{name:"mingCardMng",combineType:"method",type:"class",config:{userSelf:this.userSelf}},{name:"outCardMng",combineType:"method",type:"class",config:{userSelf:this.userSelf}},{name:"cardHandMng",combineType:"method",type:"class",config:{userSelf:this.userSelf}}]),this.userSelf.attr("isClient")?(console.log(112233),e.combination([{name:"hand_operatePanel",combineType:"method",type:"class",config:{userSelf:this.userSelf,mahjongMng:this}},{name:"hand_otherDisplay",combineType:"method",type:"class",config:{userSelf:this.userSelf}},{name:"hand_outCardEvent",combineType:"method",type:"class",config:{userSelf:this.userSelf,mahjongMng:this}}])):e},_getAnimate_:function(){var e=new a;return e.combination([{name:"animate_operate",combineType:"method",type:"class",config:{userSelf:this.userSelf}},{name:"animate_outCard",combineType:"method",type:"class",config:{userSelf:this.userSelf}}])}});t.exports=o,cc._RFpop()},{cardsMng:"cardsMng",combination:"combination"}],mahjongMng:[function(e,t,r){"use strict";cc._RFpush(t,"4e15bbvWQlDtbZ2s98nsxv6","mahjongMng");var a=e("mahjongMngBase"),s=logConfig(4),i=cc.Class({name:"MahjongMng","extends":a,ctor:function(){},checkCard:function(e,t,r){var a=room.msgIsMeSend(t)?"fromMe":"fromOther",i=r&&void 0!==r.isCheckChi&&r.isCheckChi||!1,o=r&&void 0!==r.isCheckHu&&r.isCheckHu||!1,n=r&&void 0!==r.isCalcHu&&r.isCalcHu||!1,c=r&&void 0!==r.isCheckLiangGang&&r.isCheckLiangGang||!1,h=this.mahModel.checkCard(e,a,i);if(n.length>0){this.mahModel.operateCard(n,1,"sub");var l=this.mahModel.getAllCanHuCards();this.mahModel.operateCard(n,1,"add"),console.log("计算了新的教！计算结果是：",l)}else""===n&&this.mahModel.getAllCanHuCards();var d=!1;o&&(d=this.mahModel.checkHasHu(e),d&&h.push({operateName:"hu",operateCard:e,from:t,cardFromWho:a}),s.log1("checkHuCard 检查结果：",h)),c&&this._checkSpecialGang_(h);var u={isCanHu:d,hasOpt:0!==h.length,isHasChi:!1,ting:this.userSelf.attr("ting"),optArr:h};return u.hasOpt&&(h.unshift({operateName:"guo"}),h.forEach(function(e,r){e.from=t}),this.userSelf.attr("operateArr",h)),u},checkNum:function(e){return this.mahModel.checkNum(e)},displayAllMing:function(e){0!==e.length&&(this.mahModel.setOperateCards(e),e=TOOL.convertMingCard(e),this.mahView.displayAllMing(e))},displayOutCard:function(e){this.mahView.operateAllOutCard(e)},displayAllCards:function(e,t,r){var a=e.operateArr,s=e.handCardArr,i=e.outCardArr,o=e.outCardArrM;a&&this.displayAllMing(a),o&&this.mahModel.setOutCards(o),i&&this.mahView.showAll(i,t,r),s&&this._displayHandOnce_(s)},_displayHandOnce_:function(e){var t={};clientUser===this.userSelf?t.originalCardsHand=e:t.originalCardsHand=e.length,t.cardsNum=e.length;var r=this.userSelf.attr("naPaiInfo").cardName;this.mahModel.setCards(t);var a=this.mahModel.getHandCard();if(s.log1(this.userSelf.attr("nickName")+" 的用户的牌是： "+a),a.length&&a.length%3===2||a%3===2?(this.mahView.displayHand(a,"wantOutCard"),r&&this.mahModel.operateCard(r,1,"sub")):this.mahView.displayHand(a),this.userSelf.attr("isClient")){var i=e;if(this.mahView.outCardEventAttr("isCanPlay",this.userSelf.attr("isActive")),this.userSelf.attr("isActive"))""===this.userSelf.attr("firstOutCard")&&(!r&&(r=i[i.length-1]),this.lianGangCheck(r));else{var o=this.mahModel.getAllCanHuCards();if(s.log1("闲家的起手检查结果：",o),!room.attr("isSetTing"))return;if(0!==o.length){var n=this.mahModel.getAllJiao(),c=[{operateName:"guo"},{operateName:"ting",operateCard:n}];this.showPanel(c),this.userSelf.attr("operateArr",c)}}}(a.length&&a.length%3===2||a%3===2)&&r&&this.mahModel.operateCard(r,1,"add")},operateItem:function(e){var t=e.operateName;switch(t){case"pong":this._pong_(e);break;case"chi":this._chi_(e);break;case"specialGang":this._specialGang_(e);break;case"specialBuGang":this._specialBuGang_(e);break;case"guo":break;case"mingGang":case"anGang":case"buGang":this._gang_(e);break;case"ting":this._ting_(e);break;case"hu":this._hu_(e)}},_pong_:function(e){this.mahModel.pong(e.operateCard,{from:e.from});var t=this.mahModel.getHandCard();this.mahView.displayHand(t,"wantOutCard"),this.animate.processCardAni(e.operateName),this.mahView.displayOneMing(e),this.userSelf.attr("isClient")&&(this.mahView.outCardEventAttr("isCanPlay",!0),this.mahView.outCardEventAttr("isCanOperate",!0))},_chi_:function(e){this.mahModel.chi(e.operateCard,{from:e.from,cards:e.cards});var t=this.mahModel.getHandCard();this.mahView.displayHand(t,"wantOutCard"),this.animate.processCardAni(e.operateName),this.mahView.displayOneMing(e),this.userSelf.attr("isClient")&&(this.mahView.outCardEventAttr("isCanPlay",!0),this.mahView.outCardEventAttr("isCanOperate",!0))},_specialGang_:function(e){this.mahModel.specialGang(e.operateCard,{from:this.userSelf.attr("openId"),cards:e.cards,childType:e.childType});var t=this.mahModel.getHandCard();this.mahView.displayHand(t,"wantOutCard"),this.animate.processCardAni(e.operateName),this.mahView.displayOneMing(e),this.userSelf.attr("isClient")&&(this.mahView.outCardEventAttr("isCanPlay",!0),this.mahView.outCardEventAttr("isCanOperate",!0))},_specialBuGang_:function(e){var t=this.mahModel.specialGang(e.operateCard,{from:this.userSelf.attr("openId"),index:e.index},"notSub");if(e.i=t.i,e.num=t.num,this.userSelf.attr("isClient")){var r=this.mahModel.getAllCanHuCards();console.log("计算了新的教！计算结果是：",r)}else this.animate.processCardAni(e.operateName);this.mahView.displayOneMing(e)},_gang_:function(e){"anGang"===e.operateName&&(room.msgIsMeSend(e.from)?e.fromWhere="me":e.fromWhere="other"),this.mahModel[e.operateName](e.operateCard,{from:e.from});var t=this.mahModel.getHandCard();if(this.mahView.displayHand(t),this.animate.processCardAni(e.operateName),this.mahView.displayOneMing(e),this.userSelf.attr("isClient")){var r=this.mahModel.getAllCanHuCards();
console.log("计算了新的教！计算结果是：",r)}},_ting_:function(e){this.animate.processCardAni(e.operateName),this.userSelf.displayHead("ting","show"),this.userSelf.attr("isClient")&&(this.mahView.outCardEventAttr("isCanOperate",!1),this.mahView.setTingMask("show"),this.userSelf.attr("operateArr",null),this.userSelf.send({type:"ting"}),this.userSelf.attr("ting",!0))},_hu_:function(e){this.animate.processCardAni(e.operateName)},_checkSpecialGang_:function(e){if(""===this.userSelf.attr("firstOutCard")){var t=[];room.attr("isAllowXuanFeng")&&t.push("xuanFengGang"),room.attr("isAllowYaoJiu")&&t.push("yaoGang"),room.attr("isAllowYaoJiu")&&t.push("jiuGang"),room.attr("isAllowBaiJiu")&&t.push("baiJiuGang");var r=this.mahModel.getSpecialGang.apply(this.mahModel,t);r.length>0&&e.push({operateName:"specialGang",operateCard:"",from:"",cards:r})}},showPanel:function(e){this.mahView.showPanel(e),this.mahView.outCardEventAttr("isCanOperate",!1)}});t.exports=i,cc._RFpop()},{mahjongMngBase:"mahjongMngBase"}],messageAlert_click:[function(e,t,r){"use strict";cc._RFpush(t,"0da9cw6HlJFx7esxCVIm4he","messageAlert_click");var a=logConfig(4);cc.Class({"extends":cc.Component,onLoad:function(){room.messageAlert.generateWord(this.wordBarClick,this),room.messageAlert.generateFace(this.faceClick,this)},messageClick:function(e,t){room.messageAlert.messageAlertShow(t)},wordBtnClick:function(e){audio.play("waterClick"),room.messageAlert.togglePanel("word")},faceBtnClick:function(e){audio.play("waterClick"),room.messageAlert.togglePanel("face")},sendBtnClick:function(e){audio.play("waterClick");var t=room.messageAlert.attr("editBox");""!==t&&(room.messageAlert.messageAlertShow("hide"),a.log3("发送了文字信息："+t),clientUser.send({message:t,type:"word"}))},wordBarClick:function(e){audio.play("waterClick");var t=e.target.name,r=room.messageAlert.attr("wordsIndex",t);room.messageAlert.attr("editBox",r)},faceClick:function(e){audio.play("waterClick");var t=e.target.name;a.log3("选中的表情的名字是："+t),room.messageAlert.messageAlertShow("hide"),clientUser.send({message:t,type:"face"})}}),cc._RFpop()},{}],messageAlert_display:[function(e,t,r){"use strict";cc._RFpush(t,"77b0ddWjWJAkokOsweaYqvg","messageAlert_display");var a=(logConfig(4),cc.Class({name:"MessageAlert_display",ctor:function(){var e=arguments[0];this.faceSA=e.faceSA,this.othersSA=e.othersSA,this.wordBar=e.wordBar,this.facePf=e.facePf,this.messageAlert=cc.find("Canvas/messageAlert"),this.words=window.words,this.wordBox=cc.find("alertContent/commonWordNode/view/wordBox",this.messageAlert),this.faceBox=cc.find("alertContent/faceNode/view/faceBox",this.messageAlert)},messageAlertShow:function(e){audio.play("waterClick");var e="show"===e;TOOL.alertToggleAni(this.messageAlert,this.messageAlert.getChildByName("alertContent"),e)},togglePanel:function(e){var t="word"===e,r=cc.find("alertContent/wordBtn",this.messageAlert),a=cc.find("alertContent/faceBtn",this.messageAlert);r.getComponent(cc.Sprite).spriteFrame=this.othersSA.getSpriteFrame(t?"chat_btn_normal":"chat_btn_select"),a.getComponent(cc.Sprite).spriteFrame=this.othersSA.getSpriteFrame(t?"chat_btn_select":"chat_btn_normal"),cc.find("alertContent/commonWordNode",this.messageAlert).active=t,cc.find("alertContent/faceNode",this.messageAlert).active=!t},attr:function(e,t){if("object"==typeof e){for(var r in e)e[r]=this._attrOne_(r,e[r]);return e}return this._attrOne_(e,t)},_attrOne_:function(e,t){switch(e){case"editBox":var r=cc.find("alertContent/commonWordNode/rect2/chat_input_bg/editBox",this.messageAlert);null!=t?r.getComponent(cc.EditBox).string=t:t=r.getComponent(cc.EditBox).string;break;case"wordsIndex":t=this.words[t]}return t},_addOneWord_:function(e,t,r,a){var s=cc.instantiate(this.wordBar);s.getChildByName("word").getComponent(cc.Label).string=e,s.name=""+t,s.on("click",r,a),s.parent=this.wordBox},generateWord:function(e,t){for(var r=this.words.length-1;r>-1;r--)this._addOneWord_(this.words[r],r,e)},_addOneFace_:function(e,t,r){var a=cc.instantiate(this.facePf);a.getComponent(cc.Sprite).spriteFrame=e,a.name=e.name,a.on("click",t,r),a.parent=this.faceBox},generateFace:function(e,t){for(var r=this.faceSA.getSpriteFrames(),a=0;a<r.length;a++)this._addOneFace_(r[a],e,t)}}));t.exports=a,cc._RFpop()},{}],messageConfig:[function(e,t,r){"use strict";cc._RFpush(t,"29632stV0hCkb6ovEWB3CPr","messageConfig"),cc._RFpop()},{}],mingCardMng:[function(e,t,r){"use strict";cc._RFpush(t,"2bf7cAcV2NKTpEeiwRKbJn2","mingCardMng");var a=(e("combination"),logConfig(4)),s=cc.Class({name:"MingCardMng",ctor:function(){var e=arguments[0];this.showNode=e.userSelf.attr("showNode"),this.cards_Atlas=e.userSelf.attr("cards_Atlas"),this.trangleNumPref=e.userSelf.attr("numJiao"),this.currentShowNodeArr=null,this.showPointer=-1,this.hideAllMingCard()},reset:function(){a.log4("mingCardMng.js重置了。"),this.showPointer=-1,this.hideAllMingCard()},hideAllMingCard:function(){for(var e=null,t=0;t<4;t++){e=this.showNode.getChildByName("three"+t);for(var r=0;r<3;r++){var a=e.getChildByName("mingmah"+r).getChildByName("numJiao");a&&a.removeFromParent()}e.active=!1,e.getChildByName("mingmah3").active=!1}},displayAllMing:function(e){for(var t=0;t<e.length;t++)this.displayOneMing(e[t])},displayOneMing:function(e){"buGang"===e.operateName||"specialBuGang"===e.operateName?this.currentShowNodeArr=this.showNode.getChildByName("three"+e.index).children:(this.showPointer++,this.currentShowNodeArr=this.showNode.getChildByName("three"+this.showPointer).children),this.currentShowNodeArr.sort(function(e,t){return e.name.slice(-1)-t.name.slice(-1)});var t=e.operateCard;switch(e.operateName){case"chi":for(var r=e.cards,a=0;a<r.length;a++)this.currentShowNodeArr[a].getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame("mingmah_"+r[a]);this.currentShowNodeArr[3].active=!1,this.currentShowNodeArr[3].parent.active=!0;break;case"pong":for(var a=0;a<3;a++)this.currentShowNodeArr[a].getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame("mingmah_"+t);this.currentShowNodeArr[3].active=!1,this.currentShowNodeArr[3].parent.active=!0;break;case"buGang":this.currentShowNodeArr[3].getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame("mingmah_"+t),this.currentShowNodeArr[3].active=!0,this.currentShowNodeArr[3].parent.active=!0;break;case"mingGang":for(var a=0;a<4;a++)this.currentShowNodeArr[a].getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame("mingmah_"+t);this.currentShowNodeArr[3].active=!0,this.currentShowNodeArr[3].parent.active=!0;break;case"anGang":for(var a=0;a<3;a++)this.currentShowNodeArr[a].getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame("mingmah_unknow");var s;s="other"===e.fromWhere?this.cards_Atlas.getSpriteFrame("mingmah_unknow"):this.cards_Atlas.getSpriteFrame("mingmah_"+t),this.currentShowNodeArr[3].getComponent(cc.Sprite).spriteFrame=s,this.currentShowNodeArr[3].active=!0,this.currentShowNodeArr[3].parent.active=!0;break;case"specialGang":var r=e.cards;if(r.length>3)for(var i=[1,1,1],o=3;o<r.length;o++)switch(r[o]){case r[0]:i[0]++;break;case r[1]:i[1]++;break;case r[2]:i[2]++}for(var a=0;a<3;a++)this.currentShowNodeArr[a].getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame("mingmah_"+r[a]),i&&i[a]>1&&this._creatNumNode_(this.currentShowNodeArr[a],i[a]);this.currentShowNodeArr[3].active=!1,this.currentShowNodeArr[3].parent.active=!0;break;case"specialBuGang":this._creatNumNode_(this.currentShowNodeArr[e.i],e.num)}},_creatNumNode_:function(e,t){var r=e.getChildByName("numJiao");r?r.getChildByName("num").getComponent(cc.Label).string=t:(r=cc.instantiate(this.trangleNumPref),r.name="numJiao",r.getChildByName("num").getComponent(cc.Label).string=t,r.parent=e)}});t.exports=s,cc._RFpop()},{combination:"combination"}],msgCache:[function(e,t,r){"use strict";cc._RFpush(t,"d7b47BRazlPIocn3Mlnnzaf","msgCache");var a=cc.Class({name:"MsgCache",ctor:function(){this.controllerMap=arguments[0],this.msgArr=[],this.timer=null,this.isProcessing=!1},reset:function(){0===this.msgArr.length,clearInterval(this.timer),this.timer=null,this.isProcessing=!1},pushMsg:function(e){if(this.isProcessing)this.msgArr.push(e),null===this.timer&&this._registerTimer_();else{if(!msgCondition[e.type])return this.isProcessing=!0,console.log("2开始处理 "+e.type+" 消息！"),void this.controllerMap.accessController(e);for(var t=msgCondition[e.type].length,r=!0,a=0;a<t;a++)if(!window.CONDITIONS[msgCondition[e.type][a]](e)){r=!1;break}if(r)return this.isProcessing=!0,console.log("1开始处理 "+e.type+" 消息！"),void this.controllerMap.accessController(e);this.msgArr.push(e),null===this.timer&&this._registerTimer_()}},_registerTimer_:function(){var e=this;this.timer=setInterval(function(){!e.isProcessing&&e.msgArr.length>0&&e._processMsg_(),0===e.msgArr.length&&(clearInterval(e.timer),e.timer=null)},100)},_processMsg_:function(){for(var e,t=-1,r=this.msgArr,a=0;a<r.length;a++){var s=r[a];if(msgCondition[s.type]){for(var i=msgCondition[s.type],o=!0,n=0;n<i.length;n++)if(!window.CONDITIONS[msgCondition[s.type][n]](s)){o=!1;break}o&&(t=a)}else t=a}return this.msgArr[t]&&(e=this.msgArr.splice(t,1)),!(e===r||!e||1!==e.length)&&(this.isProcessing=!0,console.log("3开始处理 "+s.type+" 消息！"),this.controllerMap.accessController(e[0]),!0)}});t.exports=a,cc._RFpop()},{}],msgSend_controller:[function(e,t,r){"use strict";cc._RFpush(t,"b2697dGIztLu45tAALfqPh8","msgSend_controller");var a=logConfig(4),s=cc.Class({name:"MsgSend_controller",word_controller:function(e){a.log2("执行 word_controller...");var t=window.messageType.convert(e.message,"send_big"),r=room.getUser(t.openId);r.say({type:"word",value:t.message}),socket.finishMsg("word")},face_controller:function(e){a.log2("执行 face_controller...");var t=window.messageType.convert(e.message,"send_big"),r=room.getUser(t.openId);r.say({type:"face",value:t.message}),socket.finishMsg("face")}});t.exports=s,cc._RFpop()},{}],napaiMng:[function(e,t,r){"use strict";cc._RFpush(t,"b41e8durANPU4Eb+8g9fkNY","napaiMng");var a=cc.Class({name:"NapaiMng",ctor:function(){this.cards=[],this.order={f:0,j:1,o:2,t:3,w:4,0:"f",1:"j",2:"o",3:"t",4:"w",fe:0,fs:1,fx:2,fn:3,f0:"e",f1:"s",f2:"x",f3:"n",jz:0,jf:1,jb:2,j0:"z",j1:"f",j2:"b"},this.napaiArr=[],this.napaiIndex=0,this.hasGet=0},getOneCard:function(e){if("user"===getGI("napaiFrom")){var t=this.napaiArr[e],r=t.napaiIndex++;return t[r]}return this.napaiArr[this.napaiIndex++]},getRestCard:function(){if("user"===getGI("napaiFrom")){for(var e=[],t=0;t<4;t++){var r=this.napaiArr[t];e.push(r.length-r.napaiIndex)}return e.join(",")}return this.napaiArr.length-this.napaiIndex},setNapai:function(t){var r=e(t);this.napaiArr=r[0]},getUserCard:function(e){return void 0===e&&(e=this.hasGet),this.hasGet++,this.cards[e]},getUserOperate:function(e){var t;room.forEach(function(r,a){if(e===r.attr("joinOrder"))return t=r.attr("openId"),"break"});for(var r=this.cards[e].operateArr,a=0;a<r.length;a++)r[a].msg.from=t;return r},setUserCard:function(e){if(1===e.length)this._setUserCardSingle_.apply(this,arguments);else{if(4!==e.length)throw Error("必须传入一个或四个文件名");this._setUserCardMulti_.apply(this,arguments)}},_setUserCardSingle_:function(t){for(var t=arguments[0],r=getGI("napaiFrom"),a=e(t[0]),s=0;s<4;s++)this.cards.push(this._convertToArr_(a["user"+s])),"user"===r&&(this.napaiArr[s]=a["user"+s+"Cards"],this.napaiArr[s].napaiIndex=0),this.cards[s].operateArr=a["user"+s+"Operate"];"global"===r&&(this.napaiArr=a.globalCards,this.napaiIndex=0)},_setUserCardMulti_:function(){for(var t=arguments[0],r=getGI("napaiFrom"),a=0;a<t.length;a++){var s=e(t[a]);this.cards.push(this._convertToArr_(s[0])),this.cards[a].operateArr=s.operateArr,"user"===r&&(this.napaiArr[a]=s.napaiArr[0],s.napaiArr[0].napaiIndex=0)}},_convertToArr_:function(e){for(var t=[],r=0;r<e.length;r++){var a=this.order[r];switch(a){case"f":case"j":for(var s=0;s<e[r].length;s++)for(var i=0;i<e[r][s];i++)t.push(this.order[a+s]);break;default:for(var s=0;s<e[r].length;s++)for(var i=0;i<e[r][s];i++)t.push(a+(s+1))}}return t}});t.exports=a,cc._RFpop()},{}],napai_controller:[function(e,t,r){"use strict";cc._RFpush(t,"f8ddauJu25G2ZfihAD9ZrnI","napai_controller");var a=logConfig(1),s=cc.Class({name:"InCard_controller",napai_controller:function(e){var t=e.message;this._getOneCard_(t);var r=room.getUser(t.who);if(room.attr("restCardNum",t.cardNum),room.setActiveUser(t.who),room.displayPointer(room.getNextActiveIndex(t.who)),null==t.card){clientUser.juEnd(null);var a=room.zhuang-1<0?3:room.zhuang-1;return room.nextZhuang=room.getUser(a).attr("openId"),void socket.finishMsg("napai")}t.card&&(clientUser.attr("naPaiInfo").cardName=t.card),r.inCard(t.card,t.cardNum),socket.finishMsg("napai")},_getOneCard_:function(e){var t=getGI("napaiEveryModel");"server"===t?a.log1("从服务器拿一张牌！"):"local"===t&&(e.card=window.naPaiMng.getOneCard(room.getUser(e.who).attr("joinOrder")),e.cardNum=window.naPaiMng.getRestCard(),room.msgIsMeSend(e.who)||(e.card=""),a.log1("从本地拿一张牌！"+e.card))}});t.exports=s,cc._RFpop()},{}],node_hall_display:[function(e,t,r){"use strict";cc._RFpush(t,"0f60fl4ggtKRa/YyYWrEzg+","node_hall_display");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("inputNumPanel");cc.Class({"extends":cc.Component,properties:{mainGameAtls:cc.SpriteAtlas},display:function(e,t){if("object"===("undefined"==typeof e?"undefined":a(e)))for(var r in e)this._displayOne_(r,e[r]);else this._displayOne_(e,t)},_displayOne_:function(e,t){switch(e){case"nickName":cc.find("main/headBox/nick",this.node).getComponent(cc.Label).string=t;break;case"userId":cc.find("main/headBox/ID",this.node).getComponent(cc.Label).string="ID: "+t;break;case"headIcon":TOOL.setUserHeadIcon(cc.find("main/headBox/headIcon",this.node),t,this.mainGameAtls);break;case"roomCardNum":cc.find("main/houseCardBox/houseCardNum",this.node).getComponent(cc.Label).string=t}},showRecordAlert:function(e){e="show"===e,this.node.getChildByName("recordAlert").active=e,this.node.getChildByName("main").active=!e},onLoad:function(){this.inputNumPanel=new s,setGI("hall",this),this.msgNode=cc.find("Canvas/main/messageBox/mask/message"),this.msgNode.x=(this.msgNode.parent.width+this.msgNode.width)/2,this.num=0,this.isFinished=!0,this.broadcastAni(),this.timer=setInterval(this.broadcastAni.bind(this),3e4),console.log("调整hall的高度"),this.node.height=cc.winSize.height;var e=this;cc.view.setResizeCallback(function(){console.log("调整hall的高度"),e.node.height=cc.winSize.height,console.log(cc.winSize),getGI("hall").errorReminder(cc.winSize.height+""+cc.winSize.width)})},disableHall:function(){cc.find("Canvas/main/operateBg/addHome").getComponent(cc.Button).interactable=!1,cc.find("Canvas/main/operateBg/createHome").getComponent(cc.Button).interactable=!1},onDestroy:function(){clearInterval(this.timer),this.isFinished=!0,console.log("销毁了...")},broadcastAni:function(e){this.num++,this.num>15&&(clearInterval(this.timer),this.isFinished=!0);var t=this.msgNode;if(e&&(t.getComponent(cc.Label).string=e,clearInterval(this.timer),this.timer=setInterval(this.broadcastAni.bind(this),3e4),t.x=(t.parent.width+t.width)/2),this.isFinished){this.isFinished=!1;var r=t.width/100*1.5,a=t.getPosition(),s=a.sub(cc.v2(t.parent.width+t.width,0));console.log("运行了广告！"),t.runAction(cc.sequence(cc.delayTime(1.5),cc.moveTo(r,s),cc.callFunc(function(){t.setPosition(a),this.isFinished=!0},this)))}},errorReminder:function(e){var t=cc.find("Canvas/reminder");t.active=!0,t.getChildByName("describe").getComponent(cc.Label).string=e,this.getComponent(cc.Animation).play("reminder")},reminderFinished:function(){cc.find("Canvas/reminder").active=!1}}),cc._RFpop()},{inputNumPanel:"inputNumPanel"}],node_recordAlert:[function(e,t,r){"use strict";cc._RFpush(t,"73e09T0xkxAqJTUu/Y952q8","node_recordAlert"),cc.Class({"extends":cc.Component,properties:{recordAtlas:cc.SpriteAtlas,recordItemPref:cc.Prefab},showRecords:function(e,t){var r=cc.find("recordAlert/alertContent/recordBox/view/content",this.node),a=r.getChildByName("recordItem");if(a&&a.removeFromParent(),"append"===t)this._createRecordItem_(e,r);else{for(var s=e.length-r.childrenCount,i=r.children,o=Math.min(e.length,r.childrenCount),n=0;n<o;n++)this._showOneItem_(e[n],i[n]);if(s>=0)this._createRecordItem_(e.slice(n),r);else for(var c=n;c<r.childrenCount;c++)i[n].active=!1}this.node.getChildByName("recordAlert").active=!0,this.node.getChildByName("main").active=!1},_createRecordItem_:function(e,t){for(var r=0;r<e.length;r++){var a=cc.instantiate(this.recordItemPref);this._showOneItem_(e[r],a),a.name="recordItem"+r,a.parent=t}},_showOneItem_:function(e,t){t.active=!0,t.getChildByName("roomId").getComponent(cc.Label).string=e.roomId,t.getChildByName("time").getComponent(cc.Label).string=e.time;for(var r,a,s,i=t.getChildByName("scores").children,o=0;o<4;o++)if(r=i[o],a=e.usersInfo[o].nickName,r.getComponent(cc.Label).string=a+":",s=e.usersInfo[o].score,r.getChildByName("scores").getComponent(cc.Label).string=s>0?"+"+s:s,a===clientUser.attr("nickName")){var n=s>0?"win":"failure";t.getChildByName("result").getComponent(cc.Sprite).spriteFrame=this.recordAtlas.getSpriteFrame(n)}},onLoad:function(){getGI("hall").recordAlert=this}}),cc._RFpop()},{}],offlineAlert:[function(e,t,r){"use strict";cc._RFpush(t,"88421fNwMRCXJTcZB4W2tBv","offlineAlert"),cc.Class({"extends":cc.Component,showOfflineAlertClick:function(e,t){audio.play("waterClick"),this.showOfflineAlert(t)},showOfflineAlert:function(e){var t=cc.find("Canvas/offlineAlert");"show"===e?cc.find("alertContent/loading",t).getComponent(cc.Animation).play("offlineLoading"):cc.find("alertContent/loading",t).getComponent(cc.Animation).stop("offlineLoading"),e="show"===e,t.active=e},onLoad:function(){setGI("offlineAlert",this)}}),cc._RFpop()},{}],operateCards_operate:[function(e,t,r){"use strict";cc._RFpush(t,"db60aWObmxLVZxUCKyuyNip","operateCards_operate");var a=logConfig(4),s=cc.Class({name:"OperateCards_operate",ctor:function(){var e=arguments[0];this.operateCards=e.operateCards,this.handCards=e.handCards},getCardsOperateArr:function(){return this.operateCards.cardsOperateArr},checkBuGang:function(){var e=[],t=this;return this.operateCards.forEach(function(r){"pong"===r.type&&t.handCards.getCardNums(r.cardName)>0&&(e.push({operateName:"buGang",operateCard:r.cardName,index:r.i}),a.log1("checkCard: 可以进行补扛。"))}),e},checkSpecialBuGang:function(){var e=this,t={operateName:"specialBuGang",hasBuGang:!1,operateCard:{}},r=t.operateCard;return this.operateCards.forEach(function(a){if("specialGang"===a.type)for(var s=a.msg.cards,i=0;i<3;i++){var o=s[i];e.handCards.getCardNums(o)>0&&!(o in r)&&(r[s[i]]=a.i,t.hasBuGang=!0)}}),t},isHasSpecialGang:function(e){var t=!1;return this.operateCards.forEach(function(r){if(e){if("specialGang"===r.type&&r.msg.childType===e)return t=!0,"break"}else if("specialGang"===r.type)return t=!0,"break"}),t},isHasOperate:function(e){var t=!1;return this.operateCards.forEach(function(r){if(r.type===e)return t=!0,"break"}),t},staticsCardsShow:function(){var e=[0,0,0,0];this.cardsOperateArr;return this.operateCards.forEach(function(t){var r=t.cardName;1===r.length?e[0]++:"o"===r.charAt(0)?e[1]++:"t"===r.charAt(0)?e[2]++:"w"===r.charAt(0)&&e[3]++}),e}});t.exports=s,cc._RFpop()},{}],operateCards:[function(e,t,r){"use strict";cc._RFpush(t,"bd614KRj9FCDrXCr9B4u2Cu","operateCards");var a=(logConfig(4),cc.Class({name:"OperateCards",ctor:function(){arguments[0];this.cardsOperateArr=[]},setOperateCards:function(e){this.cardsOperateArr=e},reset:function(){console.log("operateCards.js重置了。。"),this.cardsOperateArr.length=0},pong:function(e,t){this.cardsOperateArr.push({cardName:e,type:"pong",msg:{from:t.from}})},anGang:function(e,t){this.cardsOperateArr.push({cardName:e,type:"anGang",msg:{from:t.from}})},specialGang:function(e,t){if(e){var r=this.cardsOperateArr[t.index].msg.cards,a={i:null,num:0};r.push(e);for(var s=0;s<r.length;s++)r[s]===e&&(null===a.i&&(a.i=s),a.num++);return a}this.cardsOperateArr.push({cardName:"",type:"specialGang",msg:{from:t.from,childType:t.childType,cards:t.cards}})},mingGang:function(e,t){this.cardsOperateArr.push({cardName:e,type:"mingGang",msg:{from:t.from}})},buGang:function(e,t){for(var r=0;r<this.cardsOperateArr.length;r++)if("pong"===this.cardsOperateArr[r].type&&this.cardsOperateArr[r].cardName===e)return this.cardsOperateArr[r].type="buGang",this.cardsOperateArr[r].msg.from=t.from,r;return-1},chi:function(e,t){this.cardsOperateArr.push({cardName:e,type:"chi",msg:{from:t.from,cards:t.cards}})},forEach:function(e,t){t=t||this;for(var r,a=this.cardsOperateArr,s={cardName:"",type:"",i:0,arr:null,msg:null},i=0;i<a.length;i++)switch(s.type=a[i].type,s.cardName=a[i].cardName,s.i=i,s.msg=a[i].msg,s.arr=a,r=e.call(t,s)){case"break":break;case"continue":continue}}}));t.exports=a,cc._RFpop()},{}],operate_controller:[function(e,t,r){"use strict";cc._RFpush(t,"ccda8SjBLxKpYdlDaMd3LwK","operate_controller");var a=logConfig(4),s=cc.Class({name:"Operate_controller",pong_controller:function(e){a.log2("执行 pong_controller...");var t=e.message.p,r={};r.operateName="pong",r.operateCard=e.message.c,r.cards=e.message.m,r.from=e.message.from;var s=room.getUser(t);s.operateItem({operateName:"pong",operateCard:r.operateCard,from:e.message.from});var i=room.getNextActiveIndex(t);a.log1("operate: 下一当前用户是： "+i),room.setActiveUser(i),room.displayPointer(i),socket.finishMsg("pong")},guo_controller:function(e){a.log2("执行 guo_controller...");var t=room.getNextActiveIndex();a.log1("operate: 下一当前用户是： "+t),room.setActiveUser(t),room.displayPointer(t),0===t&&clientUser.send({type:"napai"}),socket.finishMsg("guo")},mingGang_controller:function(e){a.log2("执行 mingGang_controller...");var t=e.message.p,r=e.message.c,s=e.message.from,i=room.getUser(t),o=room.getNextActiveIndex(t);i.operateItem({operateName:"mingGang",operateCard:r,from:s}),a.log1("operate: 下一当前用户是： "+o),room.setActiveUser(o),room.displayPointer(o),socket.finishMsg("mingGang")},chi_controller:function(e){a.log2("执行 chi_controller...");var t=e.message.p,r={};r.operateName="chi",r.operateCard=e.message.c,r.cards=e.message.m,r.from=e.message.from;var s=room.getUser(t);s.operateItem(r);var i=room.getNextActiveIndex(t);a.log1("operate: 下一当前用户是： "+i),room.setActiveUser(i),room.displayPointer(i),socket.finishMsg("chi")},specialGang_controller:function(e){a.log2("执行 specialGang_controller...");var t=window.messageType.convert(e.message,"send_big");if(room.msgIsMeSend(t.openId)){var r=clientUser.attr("naPaiInfo").cardName;return r=clientUser.mahjongMng.checkNum(r),clientUser.mahjongMng.lianGangCheck(r),void socket.finishMsg("specialGang")}var s=room.getUser(t.openId);s.operateItem(t.message);var i=room.getNextActiveIndex(t.openId);a.log1("operate: 下一当前用户是： "+i),room.setActiveUser(i),room.displayPointer(i),socket.finishMsg("specialGang")},specialBuGang_controller:function(e){a.log2("执行 specialGang_controller...");var t=e.message.from,r={};r.operateName="specialBuGang",r.operateCard=e.message.c,r.index=e.message.index,r.from=e.message.from;var s=room.getUser(t);s.operateItem(r);var i=room.getNextActiveIndex(t);a.log1("operate: 下一当前用户是： "+i),room.setActiveUser(i),room.displayPointer(i),socket.finishMsg("specialBuGang")},buGang_controller:function(e){a.log2("执行 buGang_controller...");var t=e.message.from,r={};r.operateName="buGang",r.operateCard=e.message.c,r.index=e.message.index,r.from=e.message.from;var s=room.getUser(t);s.operateItem(r);var i=room.getNextActiveIndex(t);a.log1("operate: 下一当前用户是： "+i),room.setActiveUser(i),room.displayPointer(i),socket.finishMsg("buGang")},anGang_controller:function(e){a.log2("执行 anGang_controller...");var t=window.messageType.convert(e.message,"send_big");if(room.msgIsMeSend(t.openId))return void socket.finishMsg("anGang");var r=room.getUser(t.openId);r.operateItem(t.message);var s=room.getNextActiveIndex(t.openId);a.log1("operate: 下一当前用户是： "+s),room.setActiveUser(s),room.displayPointer(s),socket.finishMsg("anGang")},ting_controller:function(e){a.log2("执行 ting_controller...");var t=window.messageType.convert(e.message,"send_big");if(room.msgIsMeSend(t.openId))return void socket.finishMsg("ting");var r=room.getUser(t.openId);r.operateItem({operateName:"ting"}),socket.finishMsg("ting")},hu_controller:function(e){a.log2("执行 hu_controller...");var t={};t.operateName="hu",t.huCard=e.message.c,t.from=e.message.from,t.openId=e.message.p;var r=!0;if(room.msgIsMeSend(t.openId)&&t.openId===t.from);else{var s=room.getUser(t.openId);s.operateItem({operateName:"hu",operateCard:t.huCard,from:t.from});var i=room.getNextActiveIndex(t.openId);a.log1("operate: 下一当前用户是： "+i),room.setActiveUser(i),room.displayPointer(i)}if(r){var o={type:"hu",message:{huCard:t.huCard,from:t.from},openId:t.openId};clientUser.juEnd(o),clientUser.attr("isReady",!1)}socket.finishMsg("hu")}});t.exports=s,cc._RFpop()},{}],outCardMng:[function(e,t,r){"use strict";cc._RFpush(t,"a3336O3+shKPYJaqDiWGpOq","outCardMng");var a=logConfig(4),s=cc.Class({name:"OutCardMng",ctor:function(){var e=arguments[0];this.userNode=e.userSelf.attr("userNode"),this.userSelf=e.userSelf,this.cards_Atlas=e.userSelf.attr("cards_Atlas"),this.outNodes1=this.userNode.getChildByName("out1"),this.outNodes2=this.userNode.getChildByName("out2"),this.outPointerIndex=-1,this._hideAllNodes_(this.outNodes1),this._hideAllNodes_(this.outNodes2),this.maxIndex=8,this.allMaxIndex=2*this.maxIndex+1},reset:function(){a.log4("outCardMng.js重置了。"),this.outPointerIndex=-1,this._hideAllNodes_(this.outNodes1),this._hideAllNodes_(this.outNodes2),this.maxIndex=8,this.allMaxIndex=2*this.maxIndex+1},_hideAllNodes_:function(e){for(var t=e.children,r=0;r<t.length;r++)t[r].active=!1},operateOutCard:function(e,t){var r;switch(e){case"forward":if(this.outPointerIndex++,r=this._changeShow_())return r;this.outPointerIndex!==this.maxIndex+1||room.attr("showChange")||(this.outPointerIndex=15),r=this.outPointerIndex>this.maxIndex?this.outNodes2.getChildByName("mingmah_"+this.outPointerIndex):this.outNodes1.getChildByName("mingmah_"+this.outPointerIndex),r.active=!1,r.getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame("mingmah_"+t);break;case"backward":if(r=this.outPointerIndex>this.maxIndex?this.outNodes2.getChildByName("mingmah_"+this.outPointerIndex):this.outNodes1.getChildByName("mingmah_"+this.outPointerIndex),!r)return"chiangBuGang";r.active=!1,15!==this.outPointerIndex||room.attr("showChange")?this.outPointerIndex--:this.outPointerIndex=8}return r},getOutPointerIndex:function(){return this.outPointerIndex},getCurrentNode:function(){var e;return this.outPointerIndex!==this.maxIndex+1||room.attr("showChange")||(this.outPointerIndex=15),e=this.outPointerIndex>this.maxIndex?this.outNodes2.getChildByName("mingmah_"+this.outPointerIndex):this.outNodes1.getChildByName("mingmah_"+this.outPointerIndex)},resetAll:function(){this.reset(),this.maxIndex=14,this.allMaxIndex=2*this.maxIndex+1},_changeShow_:function(e){var t,r=arguments[1];if((e||this.outPointerIndex>=24)&&!room.attr("showChange")){room.attr("showChange",!0),t=this.outNodes2.getChildByName("mingmah_18");var a=cc.find("Canvas").getComponent(cc.Animation);a.on("finished",function(){room.forEach(function(e,t){e.mahjongMng.mahView.resetAll(),e.mahjongMng.mahView.operateAllOutCard(e.mahjongMng.mahModel.getOutCards())}),r&&r()},this);var s=a.getAnimationState("outCardShow").duration;return a.play("outCardShow",s),this.outNodes2.getChildByName("mingmah_18")}return!1},operateAllOutCard:function(e){for(var t,r=0;r<e.length;r++)this.outPointerIndex++,this.outPointerIndex!==this.maxIndex+1||room.attr("showChange")||(this.outPointerIndex=15),t=this.outPointerIndex>this.maxIndex?this.outNodes2.getChildByName("mingmah_"+this.outPointerIndex):this.outNodes1.getChildByName("mingmah_"+this.outPointerIndex),t.active=!0,t.getComponent(cc.Sprite).spriteFrame=this.cards_Atlas.getSpriteFrame("mingmah_"+e[r])},showAll:function(e,t,r){t>=18?this._changeShow_(!0,r):this.operateAllOutCard(e)}});t.exports=s,cc._RFpop()},{}],outCard_controller:[function(e,t,r){"use strict";cc._RFpush(t,"fe9c3vqeS9CILRqnRmDC8c7","outCard_controller");var a=logConfig(4),s=cc.Class({name:"OutCard_controller",ctor:function(){arguments[0]},outCard_controller:function(e){a.log2("执行 outCard_controller...");var t=window.messageType.convert(e.message,"send_big");if(!room.msgIsMeSend(t.openId)){var r=room.getUser(t.openId);r.outCard(t.message,t.openId),clientUser.outCardCheck(t.message,t.openId),room.displayPointer(-1)}socket.finishMsg("outCard")}});t.exports=s,cc._RFpop()},{}],outCards_operate:[function(e,t,r){"use strict";cc._RFpush(t,"8a762ggy2BB0JDb0Z3h0u0y","outCards_operate");var a=e("log"),s=new a(5);s.setOutLevel(4);var i=cc.Class({name:"OutCards_operate",ctor:function(){var e=arguments[0];this.outCards=e.outCards},getOutCardNum:function(){return this.outCards.originalCardsOut.length}});t.exports=i,cc._RFpop()},{log:"log"}],outCards:[function(e,t,r){"use strict";cc._RFpush(t,"8216dkt/kpMjLDsqltdjPXF","outCards");var a=e("log"),s=new a(5);s.setOutLevel(4);var i=cc.Class({name:"OutCards",ctor:function(){this.originalCardsOut=[],this.cardsOut=[]},setOutCards:function(e){for(var t=0;t<e.length;t++)this.cardsOut.push(e[t]),this.originalCardsOut.push(e[t])},reset:function(){this.cardsOut.length=0,this.originalCardsOut.length=0},pushCard:function(e){return this.originalCardsOut.push(e),this.cardsOut.push(e)},popCard:function(){return this.cardsOut.pop()}});t.exports=i,cc._RFpop()},{log:"log"}],randomCards:[function(e,t,r){"use strict";cc._RFpush(t,"e5d57SBzxlHMKSw36AR2m8r","randomCards");var a=cc.Class({name:"RandomCards",ctor:function(){this.cards=[[0,0,0,0],[4,4,4],[4,4,4,4,4,4,4,4,4],[4,4,4,4,4,4,4,4,4],[4,4,4,4,4,4,4,4,4]],this.order={f:0,j:1,o:2,t:3,w:4,0:"f",1:"j",2:"o",3:"t",4:"w",fe:0,fs:1,fx:2,fn:3,f0:"e",f1:"s",f2:"x",f3:"n",jz:0,jf:1,jb:2,j0:"z",j1:"f",j2:"b"},this.cardsArr=[],this.restNum=0},generateCardsArr:function(){for(var e=0;e<this.cards.length;e++)for(var t=this.cards[e],r=0;r<t.length;r++)t[r]>0&&this.cardsArr.push(this.order[e][r]);this.restNum=this.cardsArr.length},getOneCard:function(e){if(!e){var t=Math.floor(Math.random()*this.restNum);e=this.cardsArr[t]}var r=this._subCard_(e);if(r<1){if(e)var t=this.cardsArr.indexOf(e);this.cardsArr.splice(t,1),this.restNum=this.cardsArr.length}return e},_subCard_:function(e){var t=-1;if(1===e.length)switch(e){case"z":case"f":case"b":t=--this.cards[this.order.j][this.order["j"+e]];break;case"x":case"n":case"s":case"e":t=--this.cards[this.order.f][this.order["f"+e]]}else t=--this.cards[this.order[e.charAt(0)]][this.order[e.charAt(1)-1]];if(t<0)throw Error("已经没有"+e+"了")},getCards:function(e){if("number"==typeof e){for(var t=[],r=0;r<num;r++)t.push(this.getOneCard());return t}for(var r=0;r<e.length;r++)this.getOneCard(e[r]);return e}});t.exports=a,cc._RFpop()},{}],rebuild_controller:[function(e,t,r){"use strict";cc._RFpush(t,"83ac7gCz2FHyayQAj6n+1bC","rebuild_controller");var a=logConfig(4),s=e("room"),i=e("user"),o=e("rebuild_msg_controller"),n=cc.Class({name:"Rebuild_controller",_calc_:function(e){if(0===room.acitveIndex)switch(e.room.status){case 1:var t=e.players[e.meIndex].napai;clientUser.mahjongMng.mahModel.operateCard(t,1,"sub");var r=e.room.cardNum;clientUser.inCard(t,r,t);break;case 2:if(e.msg)return;var a=e.players[e.meIndex].handCards.length;switch(a%3){case 1:clientUser.send({type:"napai"});break;case 2:clientUser.attr("isCanPlay",!0)}break;case 3:break;case 4:if(e.msg)return;var a=e.players[e.meIndex].handCards.length;a%3===1&&clientUser.send({type:"napai"})}},rebuild_controller:function(e){a.log2("执行 rebuild_controller...");var t=e.message,r=t.p,s=t.players;s.sort(function(e,t){return e.order-t.order});for(var i=!0,o=0;o<s.length;o++)s[o].napai&&r!==s[o].userInfo.openId?s[o].napai="":s[o].handCards&&14===s[o].handCards.length&&(s[o].napai=s[o].handCards[13]),0===s[o].userInfo.state&&(i=!1);var n=this._getMeInfo_(s,r);t.meIndex=n,t.room.activeIndex=t.room.activer-1;var c=s[n].userInfo;
this._initHall_(c),this._initRoom_(t);var h=this;switch(t.room.step){case 1:room.attr("period","readying");var l=setInterval(function(){if(getGI("roomSceneFinished")){clearInterval(l);var e=clientUser.attr("isReady");room.displayRoomInfo({inviteBtn:e?"showCenter":"show",readyBtn:e?"hide":"show",exitBtn:e?"hide":"show"}),socket.finishMsg("rebuild")}},50);break;case 2:room.attr("period","playing");var l=setInterval(function(){getGI("roomSceneFinished")&&(clearInterval(l),h._startRun_(t,i))},50);break;case 3:room.attr("period","endJu");var l=setInterval(function(){getGI("roomSceneFinished")&&(clearInterval(l),room.displayRoomInfo({inviteBtn:"hide",readyBtn:clientUser.attr("isReady")?"hide":"showCenter",exitBtn:"hide"}),socket.finishMsg("rebuild"))},50)}},_startRun_:function(e,t){a.log2("执行 _startRun_...");var r=e.room.cardNum;room.attr("restCardNum",r);var s=0;room.forEach(function(t,r){var a=e.players[t.attr("joinOrder")],i=a.cardsShow;t.combineMahjong(i),s=s>a.outCards.length?s:a.outCards.length,1===e.room.status&&e.msg&&t.attr("isActive",!1),t.displayAllCards({handCardArr:a.handCards,outCardArrM:a.outCards}),t.displayHead({ok:"hide"})}),room.displayRoomInfo({inviteBtn:"hide",readyBtn:"hide",exitBtn:"hide",playingLayer:"show"}),room.runHeadNoTime(function(){if(room.forEach(function(t,r){var a=e.players[t.attr("joinOrder")];t.displayAllCards({outCardArr:a.outCards},s,function(){if(e.msg){var t=new o,r=window.messageType[e.msg.t]+"_controller";r&&t[r](e.msg)}})}),e.msg&&s<18){var t=new o,r=window.messageType[e.msg.t]+"_controller";r&&t[r](e.msg)}socket.finishMsg("rebuild")}),room.displayRoomInfo({juCount:{currentJuNum:room.currentQuan,totalJuNum:room.totalQuan},restCardNum:"剩"+r+"张"}),room.displayRoomInfo("restCardNum","show");var i=e.players[e.meIndex].order-1,n=e.room.activeIndex;room.acitveIndex=n>=i?n-i:4+n-i,room.timeShow("show"),room.displayPointer(room.acitveIndex),room.setActiveUser(room.acitveIndex),this._calc_(e),t?0===room.acitveIndex&&clientUser.wake():clientUser.sleep();var c=e.players[e.meIndex].handCards.length;c%3===1&&clientUser.mahjongMng.mahModel.getAllCanHuCards(),room.attr("isCanShowAllResult",!1)},_initRoom_:function(e){var t=e.room;e.players;if(!window.room){a.log1("如果自己还没进入房间"),window.room=new s({roomId:t.roomId,totalJuNum:t.totalJuNum,currentJuNum:t.useJuNum,totalQuan:t.totalQuanNum,currentQuan:t.useQuanNum}),this._initSetting_(t.opt);var r=this;cc.director.loadScene("room",function(){a.log1("场景加载完成"),"open"===getGI("bgMusic")&&audio.play("playingBg.mp3",!0),setGI("roomSceneFinished",!0),room.combineAction(),a.log1(room),room.displayRoomInfo({roomId:t.roomId,juCount:{currentJuNum:t.useQuanNum,totalJuNum:t.totalQuanNum},arithmetic:"setting"}),TOOL.replaceShareUrl(room.roomId),r._addBeforeUsers_(e)})}},_addBeforeUsers_:function(e){for(var t,r,a,s,o,n,c=e.room,h=e.players,l=e.meIndex,d=h.length,u=!1,m=h[l].order-1,g=d-1;g>-1;g--)r=h[g].userInfo,o=h[g].outAllCards.length>0?h[g].outAllCards[0]:"",n=h[g].order-1,u=r.openId===c.zhuangId,a=n>=m?n-m:4+n-m,s=c.activeIndex===n,g!==l?t=new i({attr:{roomCards:r.cards,faceIcon:r.faceIcon,nickName:r.nickName,openId:r.openId,userId:r.userId,joinOrder:n,positionOrder:a,sex:1===r.sex?"man":"woman",ip:r.ip,whoseVoice:1===r.sex?"m1":"g1",zhuang:u,isClient:!1,isActive:s,isReady:r.ready,state:r.state,firstOutCard:o,isCanPlay:s}}):(clientUser.attr({joinOrder:n,positionOrder:a,sex:1===r.sex?"man":"woman",whoseVoice:1===r.sex?"m1":"g1",zhuang:u,isActive:s,isReady:r.ready,firstOutCard:o,state:r.state,isCanPlay:s}),t=clientUser),t.combineAction(),t.attr("naPaiInfo").cardName=h[g].napai,this._displayHead_(t,h[g]),room.addUser(t)},_displayHead_:function(e,t){var r=t.userInfo;e.displayHead({zhuang:e.attr("zhuang")?"show":"hide",faceIcon:r.faceIcon,nickName:r.nickName,ting:"hide",score:t.roomScore,ok:e.attr("isReady")?"show":"hide",leaveLine:0===r.state?"show":"hide"})},_initSetting_:function(e){for(var t=0;t<e.length;t++)switch(e[t]){case 5:room.attr("is40Arithmetic",!0);break;case 1:room.attr("isPromise",!0);break;case 2:room.attr("isAllowYaoJiu",!0);break;case 3:room.attr("isAllowXuanFeng",!0);break;case 4:room.attr("isAllowBaiJiu",!0)}},_initHall_:function(e){var t=new i({attr:{roomCards:e.cards,faceIcon:e.faceIcon,nickName:e.nickName,openId:e.openId,userId:e.userId,sex:1===e.sex?"man":"woman",ip:e.ip,isClient:!0}});t.combineSend(),window.clientUser=t,t.send({type:"share",message:window.location.href}),getGI("hall").display({nickName:t.attr("nickName"),userId:t.attr("userId"),headIcon:t.attr("faceIcon"),roomCardNum:t.attr("roomCards")}),getGI("hall").disableHall()},_getMeInfo_:function(e,t){for(var r=0;r<e.length;r++)if(e[r].userInfo.openId===t)return r}});t.exports=n,cc._RFpop()},{rebuild_msg_controller:"rebuild_msg_controller",room:"room",user:"user"}],rebuild_msg_controller:[function(e,t,r){"use strict";cc._RFpush(t,"5e8e17fRn9EaIG3g74ZUkNT","rebuild_msg_controller");var a=logConfig(4),s=cc.Class({name:"Rebuild_msg_controller",outCard_controller:function(e){a.log2("执行 重构的 outCard_controller...");var t=window.messageType.convert(e.m,"send_big"),r=room.getUser(t.openId);r.outCardNoChange(t.message,t.openId),room.msgIsMeSend(t.openId)||clientUser.outCardCheck(t.message,t.openId),room.displayPointer(-1)},wantBuGang_controller:function(e){a.log2("执行 wantBuGang_controller...");var t=e.m.m,r={};r.operateName="wantBuGang",r.operateCard=t.c,r.index=t.index,r.from=t.from;var s=e.m.p;if("specialBuGang"===window.messageType[t.t]){var i=room.getUser(s),o=i.mahjongMng;o.mahModel.operateCard(r.operateCard,1,"sub");var n=o.mahModel.getHandCard();o.mahView.displayHand(n)}room.msgIsMeSend(s)||clientUser.othersBuGangCheck({type:50,message:r,openId:s}),room.displayPointer(-1)},hu_controller:function(e){a.log2("执行 hu_controller...");var t={};t.operateName="hu",t.huCard=e.m.c,t.from=e.m.from,t.openId=e.m.p;var r=!1;t.openId===t.from?(r=!0,room.nextZhuang=t.openId):(room.nextZhuang=t.openId,r=!0);var s;s=t.openId===t.from?"fromMe":t.from;var i=room.getUser(t.openId);i.operateItem({operateName:"hu",operateCard:t.huCard,from:s},!0);var o=room.getNextActiveIndex(t.openId);if(a.log1("operate: 下一当前用户是： "+o),room.setActiveUser(o),room.displayPointer(o),r){var n={type:"hu",message:{huCard:t.huCard,from:t.from},openId:t.openId};clientUser.juEnd(n),clientUser.attr("isReady",!1)}}});t.exports=s,cc._RFpop()},{}],record_controller:[function(e,t,r){"use strict";cc._RFpush(t,"54f01cXmWZD66neE6YPIRSo","record_controller");var a=cc.Class({name:"Record_controller",record_controller:function(e){console.log("战绩查询记录数据:",e),getGI("hall").recordAlert.showRecords(e.message),socket.finishMsg("record")}});t.exports=a,cc._RFpop()},{}],resultAlert_click:[function(e,t,r){"use strict";cc._RFpush(t,"6d187wPujxGBY1iQScvqP2Z","resultAlert_click");logConfig(4);cc.Class({"extends":cc.Component,closeResultClick:function(e){room.resetMah(),cc.director.loadScene("hall",function(){window.reset(),getGI("hall").display({nickName:clientUser.attr("nickName"),userId:clientUser.attr("userId"),headIcon:clientUser.attr("faceIcon"),roomCardNum:clientUser.attr("roomCards")})})},shareResultClick:function(){audio.play("waterClick"),room.displayRoomInfo({shareFriend:"show"})}}),cc._RFpop()},{}],resultAlert_display:[function(e,t,r){"use strict";function a(){var e=[{normalNum:0,totalJuNum:8,useJuNum:2,juResults:[{cardsShow:[{cardName:"",msg:{cards:["o1","t1","w1"],childType:"yaoGang",from:"518099"}}],currentScore:3,handCards:["o2","o3","t2","t3","t4","t5","t6","w2","w3","w6"],huType:{isZhanLiHu:!0,card:null,color:"other_color",fourNum:0,from:null,type:null},openId:room.getUser(0).attr("openId"),roomScore:3,type:{huCardState:"",isHasOutCard:!1,isQianShao:!1,isTing:!1,isZhuang:!1,optType:"normal"}},{cardsShow:[],currentScore:-19,handCards:["o2","o3","t2","t3","t4","t5","t6","w2","w3","w6","o3","t2","t3","t4"],huType:{isZhanLiHu:!0,card:null,color:"other_color",fourNum:0,from:null,type:null},openId:room.getUser(1).attr("openId"),roomScore:123,type:{huCardState:"",isHasOutCard:!0,isQianShao:!1,isTing:!1,isZhuang:!1,optType:"fangPao"}},{cardsShow:[],currentScore:19,handCards:["o2","o3","t2","t3","t4","t5","t6","w2","w3","w6","o3","t2","t3","t4"],huType:{isZhanLiHu:!0,card:null,color:"other_color",fourNum:0,from:null,type:null},openId:room.getUser(2).attr("openId"),roomScore:3,type:{huCardState:"",isHasOutCard:!1,isQianShao:!1,isTing:!1,isZhuang:!1,optType:"normal"}},{cardsShow:[],currentScore:3,handCards:["o2","o3","t2","t3","t4","t5","t6","w2","w3","w6","w3","w2","t6"],huType:{isZhanLiHu:!0,card:"t7",color:"other_color",fourNum:0,from:room.getUser(1).attr("openId"),type:"pengPengHu"},openId:room.getUser(3).attr("openId"),roomScore:3,type:{huCardState:"",isHasOutCard:!0,isQianShao:!1,isTing:!1,isZhuang:!0,optType:"jiePao"}}]}];return e}cc._RFpush(t,"6da9e0MDG5Aqr2qR9PYBt86","resultAlert_display");var s=logConfig(4),i=cc.Class({name:"ResultAlert",ctor:function(){this.allResult=cc.find("Canvas/resultAlert"),this.userPref=getGI("roomGlobalRes").resultUserBox,this.linePref=getGI("roomGlobalRes").linePref,this.mainGame_Atlas=getGI("roomGlobalRes").mainGame_Atlas,this.userBoxs=[],s.log3("用户节点：",this.userBoxs),this.isShow=!1,this.actialTotalJun=0,this.allUserData=null,this.shareObj=[]},reset:function(){this.isShow=!1,this.shareObj.length=0},allResultShow:function(e){this.isShow="show"===e,this.allResult.active=this.isShow,this.isShow||TOOL.replaceShareUrl(room?room.roomId:"wx")},refreshMahResult:function(e){this.allUserData=e||a(),this.actialTotalJun=this.allUserData.length,this._setDetails_(),this._forEachRefresh_(),TOOL.replaceShareUrl(this.shareObj)},_forEachRefresh_:function(){for(var e=0;e<this.userBoxs.length;e++){var t=this.allUserData[this.actialTotalJun-1].juResults[e];this._setHeadAndTotal_(this.userBoxs[e],t.openId,t.roomScore),this._getShareObj_(t.openId,t.roomScore)}},_getShareObj_:function(e,t){var r={};r.name=room.getUser(e).attr("nickName"),r.score=t,this.shareObj.push(r)},_setHeadAndTotal_:function(e,t,r){var a=e.getChildByName("user"),s=room.getUser(t);TOOL.setUserHeadIcon(a,s.attr("faceIcon"),this.mainGame_Atlas),a.getChildByName("nick").getComponent(cc.Label).string=s.attr("nickName"),a.getChildByName("juNum").getComponent(cc.Label).string=this.actialTotalJun,cc.find("allScord/num",e).getComponent(cc.Label).string=(r>0?"+":"")+r},_setDetails_:function(){for(var e,t,r,a=this.actialTotalJun,s=0;s<4;s++){var i=cc.instantiate(this.userPref);i.name="userBox"+s,console.log(i.name),t=cc.find("scrollView/view/userContent",i);for(var o=0;o<a;o++)e=cc.instantiate(this.linePref),r=this.allUserData[o].juResults[s].currentScore,r=r>0?"+"+r:r,e.getChildByName("score").getComponent(cc.Label).string=r,e.getChildByName("num").getComponent(cc.Label).string=o+1,e.name="juNode"+o,e.parent=t;i.parent=cc.find("alertContent/userBox",this.allResult),this.userBoxs.push(i)}}});t.exports=i,cc._RFpop()},{}],roomData:[function(e,t,r){"use strict";cc._RFpush(t,"12253fzO1VA/YckZzPeQug3","roomData");var a=(logConfig(4),cc.Class({name:"RoomData",ctor:function(){this.isSetTing=!1,this.isZFBOrder=!1,this.is40Arithmetic=!1,this.isPromise=!1,this.isAllowYaoJiu=!1,this.isAllowXuanFeng=!1,this.isAllowBaiJiu=!1,this.nextZhuang="",this.readyArr=[],this.period="playing",this.showChange=!1,this.dismissingNum=0,this.isCanShowAllResult=!1,this.restCardNum=83}}));t.exports=a,cc._RFpop()},{}],roomDisplay:[function(e,t,r){"use strict";cc._RFpush(t,"987edZlBkNIlrTd8fDrP0WY","roomDisplay");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("log"),i=new s(4);i.setOutLevel(1);var o=cc.Class({name:"RoomDisplay",ctor:function(){this.restCardNum=cc.find("Canvas/playingLayer/restCardNum"),this.num=0},displayRoomInfo:function(e,t){if(i.log3("执行了函数 displayRoomInfo",e,t),"object"===("undefined"==typeof e?"undefined":a(e)))for(var r in e)this._setOneAttrDisplay_(r,e[r]);else this._setOneAttrDisplay_(e,t)},_setOneAttrDisplay_:function(e,t){switch(i.log3("执行了函数 _setOneAttrDisplay_",e,t),e){case"roomId":cc.find("Canvas/bg/roomId").getComponent(cc.Label).string="房号："+t;break;case"juCount":cc.find("Canvas/bg/count").getComponent(cc.Label).string="圈："+t.currentJuNum+"/"+t.totalJuNum;break;case"readyBtn":"show"===t||"hide"===t?cc.find("Canvas/bg/readyBtn").active="show"===t:"showCenter"===t&&(cc.find("Canvas/bg/readyBtn").x=0,cc.find("Canvas/bg/readyBtn").active=!0);break;case"inviteBtn":"show"===t||"hide"===t?cc.find("Canvas/bg/inviteBtn").active="show"===t:"moveCenter"===t?cc.find("Canvas/bg/inviteBtn").x=0:"showCenter"===t&&(cc.find("Canvas/bg/inviteBtn").active=!0,cc.find("Canvas/bg/inviteBtn").x=0);break;case"exitBtn":cc.find("Canvas/bg/exitRoom").active="show"===t;break;case"reminder":cc.find("Canvas/reminderAni").getComponent(cc.Label).string=t,room.offFinish(),cc.find("Canvas").getComponent(cc.Animation).play("reminderAni");break;case"playingLayer":cc.find("Canvas/playingLayer").active="show"===t;break;case"shareFriend":cc.find("Canvas/shareFriendLayer").active="show"===t;break;case"restCardNum":"show"===t||"hide"===t?this.restCardNum.active="show"===t:this.restCardNum.getComponent(cc.Label).string=t;break;case"arithmetic":var r=cc.find("Canvas/bg/arithmetic/arithParent");if(0===this.num){var a=room.attr({is40Arithmetic:null,isPromise:null,isAllowXuanFeng:null,isAllowYaoJiu:null,isAllowBaiJiu:null});this.num=0;for(var s in a)a[s]&&this.num++;if(this.num<=3){var o=cc.find("Canvas/bg/arithmetic");o.getComponent(cc.Widget).horizontalCenter=o.getComponent(cc.Widget).horizontalCenter+r.width/6,r.width=r.width/2}}if("changeAdd"===t&&this.num<=3){var o=cc.find("Canvas/bg/arithmetic");o.getComponent(cc.Widget).horizontalCenter=o.getComponent(cc.Widget).horizontalCenter+r.width/5}if("changeSub"===t&&this.num<=3){var o=cc.find("Canvas/bg/arithmetic");o.getComponent(cc.Widget).horizontalCenter=o.getComponent(cc.Widget).horizontalCenter-r.width/5}"setting"===t&&(r.getChildByName("40arith").active=a.is40Arithmetic,r.getChildByName("promise").active=a.isPromise,r.getChildByName("xuanFeng").active=a.isAllowXuanFeng,r.getChildByName("yaoJiu").active=a.isAllowYaoJiu,r.getChildByName("baiBaJiu").active=a.isAllowBaiJiu)}}});t.exports=o,cc._RFpop()},{log:"log"}],roomGlobalRes:[function(e,t,r){"use strict";cc._RFpush(t,"ade59IgmRVM1JrAaqhlgG5K","roomGlobalRes");logConfig(4);cc.Class({"extends":cc.Component,properties:{MTCards_Atlas:cc.SpriteAtlas,LCards_Atlas:cc.SpriteAtlas,RCards_Atlas:cc.SpriteAtlas,mainGame_Atlas:cc.SpriteAtlas,others_Atlas:cc.SpriteAtlas,face_Atlas:cc.SpriteAtlas,playingLayer:cc.Node,dismissAtl:cc.SpriteAtlas,facePf:cc.Prefab,wordBar:cc.Prefab,numJiao0:cc.Prefab,numJiao1:cc.Prefab,numJiao2:cc.Prefab,numJiao3:cc.Prefab,resultUserBox:cc.Prefab,linePref:cc.Prefab},onLoad:function(){setGI("roomGlobalRes",this),console.log("存入全局")}}),cc._RFpop()},{}],room_click:[function(e,t,r){"use strict";cc._RFpush(t,"4e27c5646JAb5238iGaHTFu","room_click");var a=e("log"),s=new a(4);s.setOutLevel(1);cc.Class({"extends":cc.Component,onLoad:function(){console.log("调整room的高度"),this.node.height=cc.winSize.height;var e=this;cc.view.setResizeCallback(function(){console.log("调整room的高度"),e.node.height=cc.winSize.height,console.log(cc.winSize)})},exitClick:function(e){audio.play("waterClick"),clientUser.send({type:"exitRoom"}),cc.director.loadScene("hall",function(){window.reset(),getGI("hall").display({nickName:clientUser.attr("nickName"),userId:clientUser.attr("userId"),headIcon:clientUser.attr("faceIcon"),roomCardNum:clientUser.attr("roomCards")})})},inviteClick:function(e){audio.play("waterClick"),room.displayRoomInfo({shareFriend:"show"})},shareFriendLayer:function(){cc.find("Canvas/shareFriendLayer").active=!1}});cc._RFpop()},{log:"log"}],room:[function(e,t,r){"use strict";cc._RFpush(t,"fba82zvOaFFkJ3kyVGSqZR7","room");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("combination"),i=(e("roomDisplay"),e("dismissAlert_display")),o=e("messageAlert_display"),n=e("singleResult_display"),c=e("resultAlert_display"),h=logConfig(4),l=cc.Class({name:"Room","extends":s,properties:{roomId:0,totalJuNum:0,currentJuNum:0,totalQuan:0,currentQuan:0,usersArr:[],acitveIndex:0,openIdOrder:null,zhuang:0},ctor:function(){var e=arguments[0];if(e){for(var t in e)void 0!==this[t]&&(this[t]=e[t]);this.openIdOrder={},this.currentUser=this.usersArr[0],this.combination([{name:"roomData",combineType:"data",type:"class"}])}},combineAction:function(){this.combination([{name:"animate_head",combineType:"method",type:"class"},{name:"animate_skip",combineType:"method",type:"class"},{name:"animate_countDown",combineType:"method",type:"class"},{name:"roomDisplay",combineType:"method",type:"class"}]);var e=getGI("roomGlobalRes");this.dismissAlert=new i({dismissAtl:e.dismissAtl}),this.messageAlert=new o({faceSA:e.face_Atlas,othersSA:e.others_Atlas,wordBar:e.wordBar,facePf:e.facePf}),this.singleResult=new n,this.resultAlert=new c},reset:function(){this.reset_other()},resetMah:function(){this.reset();for(var e=0;e<4;e++)this.usersArr[e].reset()},addUser:function(e){this.usersArr.push(e),this.openIdOrder[e.attr("openId")]=e,e.attr("zhuang")&&(this.acitveIndex=e.attr("positionOrder"),this.zhuang=this.acitveIndex);var t=this.usersArr.length;4===t&&this.usersArr.sort(function(e,t){return e.attr("positionOrder")-t.attr("positionOrder")}),h.log3(this.userArr)},removeUser:function(e){var t;if(4===this.usersArr)t=e.attr("positionOrder");else for(var r=e.attr("joinOrder"),a=0;a<this.usersArr.length;a++)if(this.usersArr[a].attr("joinOrder")===r){t=a;break}"number"==typeof t&&this.usersArr.splice(t,1)},otherUserForEach:function(e){for(var t=1;t<4;t++)e.call(this,this.usersArr[t],t)},forEach:function(e){var t;e:for(var r=0;r<4;r++)switch(t=e.call(this,this.usersArr[r],r)){case"break":break e;case"continue":continue e}},setActiveUser:function(e){switch(this.usersArr[this.acitveIndex].attr("isActive",!1),"undefined"==typeof e?"undefined":a(e)){case"number":this.acitveIndex=e;break;case"object":this.acitveIndex=e.attr("positionOrder");break;case"string":this.acitveIndex=this.openIdOrder[e].attr("positionOrder")}return this.usersArr[this.acitveIndex].attr("isActive",!0),this.acitveIndex},getPositionOrder:function(e){switch("undefined"==typeof e?"undefined":a(e)){case"string":return this.openIdOrder[e].attr("positionOrder");case"object":return e.attr("positionOrder");case"number":for(var t=0;t<this.usersArr.length;t++)if(this.usersArr[t].userId===e)return this.usersArr[t].attr("positionOrder")}},getUser:function(e){switch("undefined"==typeof e?"undefined":a(e)){case"number":if(4===this.usersArr.length)return this.usersArr[e];for(var t=this.usersArr,r=0;r<t.length;r++)if(t[r].attr("positionOrder")===e)return t[r];break;case"object":return e;case"string":return this.openIdOrder[e]}},getNextActiveIndex:function(e){switch("undefined"==typeof e?"undefined":a(e)){case"string":return this.openIdOrder[e].attr("positionOrder");case"object":return e.attr("positionOrder");case"number":for(var t=0;t<this.usersArr.length;t++)if(this.usersArr[t].userId===e)return this.usersArr[t].attr("positionOrder");break;default:return this.acitveIndex-1<0?3:this.acitveIndex-1}},msgIsMeSend:function(e){return clientUser.attr("openId")===e},meIsZhuang:function(){},setZhuang:function(e){var t=this.getUser(e);this.acitveIndex=t.attr("positionOrder"),this.usersArr[this.zhuang].attr("zhuang",!1),this.zhuang=this.acitveIndex,t.attr("zhuang",!0)},convertJtoP:function(e){for(var t=0;t<this.usersArr.length;t++)if(this.usersArr[t].attr("joinOrder")===e)return this.usersArr[t].attr("positionOrder")}});t.exports=l,cc._RFpop()},{combination:"combination",dismissAlert_display:"dismissAlert_display",messageAlert_display:"messageAlert_display",resultAlert_display:"resultAlert_display",roomDisplay:"roomDisplay",singleResult_display:"singleResult_display"}],sendMessageMng:[function(e,t,r){"use strict";cc._RFpush(t,"aab54BBNrFFEL9iVbfe9WDu","sendMessageMng");var a=cc.Class({name:"SendMessageMng",ctor:function(){var e=arguments[0];this.ID=e.ID,this.procotolObj=e.procotolObj,this.wsObj=null,this.sendData={t:"",m:"",p:this.ID},this.msgCache=null,this.sendDataArr=[]},finishMsg:function(e){console.log(e+"消息处理完成！"),this.msgCache.isProcessing=!1},setID:function(e){return this.ID=e,this},reset:function(){this.controllerMap.resetController()},setControllerMap:function(e){this.controllerMap=e},openLink:function(e){return this.wsObj=new WebSocket(e||""),this},success:function(e){var t=this;return this.wsObj.onopen=function(){console.log("打开成功！"),e&&"function"==typeof e&&e.call(t),clientUser&&clientUser.combineSend(!0);for(var r=0;r<t.sendDataArr.length;r++)console.log("要发送的消息："),console.log(t.sendDataArr[r]),t.wsObj.send(t.sendDataArr[r]);t.sendDataArr.length=0,t.wsObj.onmessage=function(e){console.log("收到一条消息！");var r=JSON.parse(e.data);t.procotolObj.convert(r,"receive"),console.log(r),t.receiveMessageFunc&&"function"==typeof t.receiveMessageFunc&&t.receiveMessageFunc.call(t,r,e)}},this},receiveMessage:function(e){return this.receiveMessageFunc=e,this},error:function(e){var t=this;return this.wsObj.onerror=function(r){console.log("连接失败！"),console.log(r),e&&"function"==typeof e&&e.call(t,r)},this},close:function(e){var t=this;return this.wsObj.onclose=function(){console.log("已经关闭连接！"),clientUser&&window.room&&clientUser.displayHead&&(clientUser.attr("state",0),clientUser.displayHead("leaveLine","show"),room.dismissAlert&&(room.dismissAlert.reset(),room.dismissAlert.dismissShow("hide")),clientUser.sleep()),e&&"function"==typeof e&&e.call(t),t.wsObj=void 0},this},send:function(e){console.log("要发送的消息："),"hu"===e.type,this.sendData.t=void 0===e.type?"":this.procotolObj[e.type],this.sendData.p=this.ID,this.sendData.m=void 0===e.message?"":e.message,console.log(this.sendData);var t=JSON.stringify(this.sendData);return this.wsObj?(this.wsObj.send(t),this):(console.log("send连接已关闭 ！"),"produce"===getGI("model")?window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxa0c15c83d5c0f91f&redirect_uri=http://www.uitrs.com/Mahjong/tnmj&response_type=code&scope=snsapi_userinfo&state=wx&connect_redirect=1#wechat_redirect":window.location.href=window.location.href,this)}});t.exports=a,cc._RFpop()},{}],serverMng:[function(e,t,r){"use strict";cc._RFpush(t,"5bf00Xwa7VLJYCG3ZxnLZfq","serverMng");var a=e("log"),s=new a(5);s.setOutLevel(4);var i=cc.Class({name:"ServerMng",ctor:function(){},reset:function(){}});t.exports=i,cc._RFpop()},{log:"log"}],settingAlert:[function(e,t,r){"use strict";cc._RFpush(t,"a8ca0b3pUBOD6mRxBp/fYD2","settingAlert");var a=logConfig(4);cc.Class({"extends":cc.Component,properties:{soundEffectNode:cc.Node,soundSizeNode:cc.Node},settingClick:function(e,t,r){!r&&audio.play("waterClick"),"boolean"!=typeof t&&(t="true"===t),this.isShow=t,console.log("执行settingClick");var a=this.node,s=this.node.getChildByName("alertContent");TOOL.alertToggleAni(a,s,t)},setAlertIsShow:function(){return this.isShow},soundEffectCallback:function(e){a.log3(e.progress),this._setVolume_(e.progress,"effect"),this.soundEffectBar.width=e.progress*this.totalWidth},_setVolume_:function(e,t){if(0===e)var r=.001;else var r=e;this.currentVolume=r,this.pressing?(this.oldVolume||(this.oldVolume=r),this.isSliding=!0,Math.abs(this.oldVolume-r)>.05&&(this.count++,this.oldVolume=r,"effect"===t?(audio.effectVolume=r,setGI("effectVolume",r),audio.setBgVolume(r)):(audio.sizeVolume=r,setGI("sizeVolume",r),audio.play("waterClick")))):"effect"===t?(audio.effectVolume=r,audio.setBgVolume(r),setGI("effectVolume",r)):(audio.sizeVolume=r,setGI("sizeVolume",r),audio.play("waterClick"))},_clickDown_:function(){this.count=0,this.pressing=!0},_clickUp_:function(e){var t="soundEffectSlider"===e.target.parent.name?"effect":"sizeVol";this.isSliding&&(this.isSliding=!1,0===this.count&&("effect"===t?(audio.effectVolume=this.currentVolume,setGI("effectVolume",this.currentVolume),audio.setBgVolume(this.currentVolume)):(audio.sizeVolume=this.currentVolume,setGI("effectVolume",this.sizeVolume),audio.play("waterClick")))),this.pressing=!1,this.oldVolume=void 0},soundSizeCallback:function(e){a.log3(e.progress),this._setVolume_(e.progress,"sizeVol"),this.soundSizeBar.width=e.progress*this.totalWidth},dismissClick:function(e){this.settingClick(null,!1,!0)},_andClick_:function(){"touches"in cc.sys.capabilities?(this.effHand.on("touchstart",this._clickDown_,this),this.effHand.on("touchend",this._clickUp_,this),this.sizeHand.on("touchstart",this._clickDown_,this),this.sizeHand.on("touchend",this._clickUp_,this)):"mouse"in cc.sys.capabilities&&(this.effHand.on("mousedown",this._clickDown_,this),this.effHand.on("mouseup",this._clickUp_,this),this.sizeHand.on("mousedown",this._clickDown_,this),this.sizeHand.on("mouseup",this._clickUp_,this))},onLoad:function(){this.oldVolume=getGI("volume"),this.count=0,this.currentVolume=this.oldVolume,this.isSliding=!1,a.log2("settingAlert onload....."),this.totalWidth=this.soundEffectNode.getChildByName("Background").width,this.soundEffectBar=this.soundEffectNode.getChildByName("setting_bar"),this.soundSizeBar=this.soundSizeNode.getChildByName("setting_bar"),this.effHand=this.soundEffectNode.getChildByName("Handle"),this.sizeHand=this.soundSizeNode.getChildByName("Handle"),this._andClick_(),this.pressing=!1;var e=getGI("sizeVolume"),t=getGI("effectVolume");this.soundSizeNode.getComponent(cc.Slider).progress=e,this.soundEffectNode.getComponent(cc.Slider).progress=t,this.soundEffectBar.width=t*this.totalWidth,this.soundSizeBar.width=e*this.totalWidth,this.isShow=!0,setGI("setAlert",this)}}),cc._RFpop()},{}],share_controller:[function(e,t,r){"use strict";cc._RFpush(t,"9f0f1adUWZOO7R7SFuMn/Fn","share_controller");var a=logConfig(4),s=cc.Class({name:"Share_controller",share_controller:function(e){if(a.log4("分享消息：",e),"produce"!==getGI("model"))return void socket.finishMsg("share");a.log4("微信对象：",wx);var t=JSON.parse(e.message);a.log4("收到的分享数据：",t);var r={title:"洮南麻将",link:t.url,desc:"洮南麻将非常非常的好玩，大家快来玩呀",imgUrl:"http://www.uitrs.com/Mahjong/img/shareIcon.png",trigger:function(e){a.log4("请点击浏览器右上角的分享到朋友圈")},success:function(e){a.log4("分享成功")},cancel:function(e){a.log4("已取消分享")},fail:function(e){a.log4("分享失败")}};setGI("shareConfig",r);var s={debug:!1,appId:t.appid,timestamp:t.timestamp,nonceStr:t.noncestr,signature:t.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"]};wx.config(s),a.log4("获得了分享的数据：",s),wx.ready(function(){wx.onMenuShareTimeline(r),wx.onMenuShareAppMessage(r),a.log4("添加了分享的数据：",r)}),socket.finishMsg("share")}});t.exports=s,cc._RFpop()},{}],singleResult_click:[function(e,t,r){"use strict";cc._RFpush(t,"01798tYjGtOj5dQOwN0KPmT","singleResult_click"),cc.Class({"extends":cc.Component,readyClick:function(e){audio.play("waterClick"),e.target.active=!1,clientUser.send({message:"准备好了",type:"ready"}),clientUser.attr("isReady",!0),clientUser.displayHead("ok","show"),room.displayRoomInfo({inviteBtn:"moveCenter",exitBtn:"hide"})},continueClick:function(e){audio.play("waterClick"),room.attr("isCanShowAllResult",!0),room.singleResult.singelResultShow("hide"),room.resetMah(),room.timeShow("hide"),room.setZhuang(room.nextZhuang),room.displayRoomInfo({readyBtn:"hide",inviteBtn:"hide",exitBtn:"hide"}),clientUser.send({message:"准备好了",type:"ready"}),clientUser.attr("isReady",!0),clientUser.displayHead("ok","show"),room.forEach(function(e){e.displayHead("score",e.attr("roomScore")),e.displayHead("zhuang",e.attr("zhuang")?"show":"hide")});for(var t=room.attr("readyArr"),r=0;r<t.length;r++)room.getUser(t[r]).displayHead("ok","show")},dismissClick:function(e,t){audio.play("waterClick"),room.attr("isCanShowAllResult",!1),room.singleResult.singelResultShow("hide"),clientUser.send({message:!0,type:"dismissing"}),room.dismissAlert.reset(),room.resetMah(),room.dismissAlert.showOperate(clientUser.attr("openId"),!0,0),room.dismissAlert.dismissShow("show","noReset"),room.dismissAlert.changeBtnState("disabled"),room.setZhuang(room.nextZhuang),room.timeShow("hide"),room.forEach(function(e){e.displayHead("score",e.attr("roomScore"))});for(var r=room.attr("readyArr"),a=0;a<r.length;a++)room.getUser(r[a]).displayHead("ok","show")}}),cc._RFpop()},{}],singleResult_display:[function(e,t,r){"use strict";cc._RFpush(t,"ad0047AlQtIHb2/nA8vPK0V","singleResult_display");var a=e("log"),s=new a(4);s.setOutLevel(3);var i=cc.Class({name:"SingleResult",ctor:function(){this.singleResult=cc.find("Canvas/singleResult"),this.meAndOpporite=getGI("roomGlobalRes").MTCards_Atlas,this.trangleNumPref=getGI("roomGlobalRes").numJiao0,this.mainGame_Atlas=getGI("roomGlobalRes").mainGame_Atlas,this.itemNodes=[],this._getItemNodes_(),this.scores=[0,0,0,0],this.isShow=!1,this.juResults=null},isSingleAlertShow:function(){return this.isShow},singelResultShow:function(e){this.isShow="show"===e,this.isShow&&room.displayRoomInfo("restCardNum","hide"),this.singleResult.active=this.isShow},refreshMahResult:function(e){this._showRoom_(),e.sort(function(e,t){return room.getPositionOrder(e.openId)-room.getPositionOrder(t.openId)}),this.juResults=e,s.log1(this.juResults),this._setUserInfo_();for(var t=0;t<this.juResults.length;t++)this.scores[t]=this.juResults[t].roomScore,room.getUser(t).attr({currentScore:this.juResults[t].currentScore,roomScore:this.juResults[t].roomScore})},_getItemNodes_:function(){this.itemNodes.length=0;for(var e=0;e<4;e++)this.itemNodes.push(cc.find("alertContent/item"+e,this.singleResult))},_setUserInfo_:function(){for(var e=0;e<4;e++)this._setUserHeadInfo_(e),this._setMash_(e),this._setTypeAndScore_(e)},_setUserHeadInfo_:function(e){var t=this.itemNodes[e].getChildByName("user"),r=room.getUser(e);TOOL.setUserHeadIcon(t,r.attr("faceIcon"),this.mainGame_Atlas),t.getChildByName("nick").getComponent(cc.Label).string=r.attr("nickName");var a=this.juResults[e].roomScore,s=a>0?"+":"";t.getChildByName("preScore").getComponent(cc.Label).string="积 "+s+a,t.getChildByName("headBack").getChildByName("zhuang").active=r.attr("zhuang")},_setMash_:function(e){var t=this.itemNodes[e].getChildByName("hand"),r=t.children;this._reset_(t);var a="mingmah_",s="handmah_",i=this.juResults[e].handCards,o=this.juResults[e].cardsShow,n=0;n=this._setCardsShow_(r,a,o,n);for(var c=0;c<i.length;c++)!r[n],r[n].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(s+i[c]),n++;n=this._showHuCard_(r,n,e),this._hideRest_(r,n)},_showHuCard_:function(e,t,r){if(!(t>13)){var a=this.juResults[r].type.optType;return"zimo"!==a&&"jiePao"!==a||(e[t].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame("handmah_"+this.juResults[r].huType.card),e[t].active=!0,t++),t}},_hideRest_:function(e,t){for(var r=t;r<e.length;r++)e[t].active=!1,t++},_setCardsShow_:function(e,t,r,a){for(var s,i,o=0;o<r.length;o++)switch(s=r[o],i=t+s.cardName,s.type){case"pong":for(var n=a;n<a+3;n++)e[n].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(i);a+=3;break;case"mingGang":e[a].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(i),a++,e[a].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(i),e[a].getChildByName("mashMask").getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(i),e[a].getChildByName("mashMask").active=!0,a++,e[a].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(i),a++;break;case"buGang":e[a].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(i),a++,e[a].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(i),e[a].getChildByName("mashMask").getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(t+"unknow"),e[a].getChildByName("mashMask").active=!0,a++,e[a].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(i),a++;break;case"anGang":e[a].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(t+"unknow"),
a++,e[a].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(t+"unknow"),e[a].getChildByName("mashMask").getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(i),e[a].getChildByName("mashMask").active=!0,a++,e[a].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(t+"unknow"),a++;break;case"chi":for(var n=a;n<a+3;n++)e[n].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(t+s.msg.cards[n-a]);a+=3;break;case"specialGang":for(var c=s.msg.cards,h=[0,0,0],n=0;n<c.length;n++)c[0]===c[n]?h[0]++:c[1]===c[n]?h[1]++:c[2]===c[n]&&h[2]++;for(var n=a;n<a+3;n++){e[n].getComponent(cc.Sprite).spriteFrame=this.meAndOpporite.getSpriteFrame(t+c[n-a]);var l=h[n-a];if(l>1){var d=cc.instantiate(this.trangleNumPref);d.name="numJiao",d.getChildByName("num").getComponent(cc.Label).string=l,d.parent=e[n]}}a+=3}return a},_setTypeAndScore_:function(e){var t=this.itemNodes[e].getChildByName("right"),r=this.juResults[e].type.optType;"fangPao"===r?t.getChildByName("type").getComponent(cc.Label).string="放炮":"jiePao"===r?t.getChildByName("type").getComponent(cc.Label).string="接炮":"zimo"===r?t.getChildByName("type").getComponent(cc.Label).string="自摸":t.getChildByName("type").active=!1,t.getChildByName("type").active="normal"!==r;var a=this.juResults[e].currentScore,s=a>0?"+":"";t.getChildByName("score").getComponent(cc.Label).string=s+a;var i=this.itemNodes[e].getChildByName("huType");"zimo"===r||"jiePao"===r?(i.getComponent(cc.Label).string=this._getHuType_(this.juResults[e].huType.type,this.juResults[e].huType.isZhanLiHu),i.active=!0):i.active=!1},_getHuType_:function(e,t){var r;switch(e){case"thirty":r="十三烂";break;case"sevenThirty":r="七星十三烂";break;case"pingHu":r="平胡";break;case"sevenPair":r="七对";break;case"pengPengHu":r="飘胡";break;case"jiaHu":r="假胡";break;case"jHu":r="夹胡";break;case"piHu":r="屁胡";break;default:r="others"}return t?r+" 站立胡":r+" 开门胡"},_reset_:function(e){for(var t=e.children,r=0;r<t.length;r++){t[r].getChildByName("mashMask").active=!1;var a=t[r].getChildByName("numJiao");a&&a.removeFromParent()}this.isShow=!1},_showRoom_:function(){s.log1(room),cc.find("alertContent/roomId",this.singleResult).getComponent(cc.Label).string="房间号:"+room.roomId,cc.find("alertContent/juNum",this.singleResult).getComponent(cc.Label).string="局数:"+room.currentJuNum+"/"+room.totalJuNum}});t.exports=i,cc._RFpop()},{log:"log"}],start_controller:[function(e,t,r){"use strict";cc._RFpush(t,"d774bO9SLhMF5LhFTKTAJC6","start_controller");var a=logConfig(4),s=e("user"),i=cc.Class({name:"Start_controller",start_controller:function(e){a.log2("已经收到start消息"),this._startRun_(e),socket.finishMsg("start")},_startRun_:function(e){a.log2("执行 _startRun_..."),room.attr("period","playing");var t=this._getCards_(e),r=window.naPaiMng.getUserOperate(clientUser.attr("joinOrder"));clientUser.mahjongMng||clientUser.combineMahjong(r),clientUser.showCards({originalCardsHand:t}),clientUser.displayHead({ok:"hide"});var s=this;if(room.otherUserForEach(function(e,t){var r=window.naPaiMng.getUserOperate(e.attr("joinOrder"));e.mahjongMng||e.combineMahjong(r),e.showCards({originalCardsHand:s._getCardsOthers_(e)}),e.displayHead({ok:"hide"})}),room.runHead(),room.displayRoomInfo({inviteBtn:"hide",readyBtn:"hide",playingLayer:"show"}),room.displayRoomInfo({juCount:{currentJuNum:room.currentQuan,totalJuNum:room.totalQuan},restCardNum:"show"}),room.timeShow("show"),room.displayPointer(room.acitveIndex),room.setActiveUser(room.acitveIndex),room.attr("readyArr").length=0,room.attr("isCanShowAllResult",!1),1===room.currentJuNum&&0===room.zhuang){var i=clientUser.attr("roomCards");switch(room.totalJuNum){case 8:clientUser.attr("roomCards",i-1);break;case 16:clientUser.attr("roomCards",i-2)}}room.attr("restCardNum",83)},_getCards_:function(e){var t,r=getGI("napaiModel");if("server"===r){var t=e.message;a.log1("从服务器发牌！")}else if("local"===r){var t=window.naPaiMng.getUserCard(clientUser.attr("joinOrder"));a.log1("从本地发牌！"),!clientUser.attr("zhuang")&&t.length>=14&&(t=t.slice(0,13))}return a.log1("start-socket：开始发牌时，收到的牌是: ",t),t},_getCardsOthers_:function(e){var t,r=getGI("napaiModel");if("server"===r)t=e.attr("zhuang")?14:13,a.log1("从服务器发牌！");else if("local"===r){var s=window.naPaiMng.getUserCard(e.attr("joinOrder"));t=s.length,!e.attr("zhuang")&&t>=14&&(t=13),a.log1("从本地发牌！")}return a.log1("start-socket：开始发牌时，收到的牌是: ",t),t},login_controller:function(e){a.log2("执行 login_controller...");var t=e.message,r=new s({attr:{roomCards:t.cards,faceIcon:t.faceIcon,nickName:t.nickName,openId:t.openId,userId:t.userId,sex:1===t.sex?"man":"woman",ip:t.ip,isClient:!0}});r.combineSend(),window.clientUser=r,r.send({type:"share",message:window.location.href}),getGI("hall").display({nickName:r.attr("nickName"),userId:r.attr("userId"),headIcon:r.attr("faceIcon"),roomCardNum:r.attr("roomCards")}),socket.finishMsg("login")}});t.exports=i,cc._RFpop()},{user:"user"}],tools:[function(e,t,r){"use strict";cc._RFpush(t,"9b63bz2doVORIEvUXKYC2Mg","tools");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("sendMessageMng"),i=e("controllerMap"),o=e("msgCache"),n={data:{alertAniFinished:!0,aniArr:[],timer:null},resetData:function(){this.data.alertAniFinished=!0,this.data.aniArr&&(this.data.aniArr.length=0),clearInterval(this.data.timer),this.data.timer=null},copyArray:function(e,t){for(var r=0;r<t.length;r++)e.push(t[r])},getNoZeroArr:function(e){var t=[];return e.forEach(function(r,a){0!==r&&(t.push(r),void 0!==e[a]?t["index"+(t.length-1)]=e[a]:t["index"+(t.length-1)]=a)}),t},getSplitAll:function(e){var t=[],r=null,a=!1;return e.forEach(function(e,s){0!==e?(a||(a=!0,r=[],t.push(r)),r.push(e),r["index"+(r.length-1)]=s):a=!1}),t},trimFrontZero:function(e){for(var t=-1;0===e[0];)e.shift(),t++;if(t>-1&&void 0!==e.index0)for(var r=0;r<e.length;r++)e["index"+r]=e["index"+t]},isZeroArr:function(e){for(var t=0;t<e.length;t++)if(0!==e[t])return!1;return!0},copyArr:function(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];t.length=e.length},convertParamToObj:function(e){for(var t={},r=e.split("&"),a=0;a<r.length;a++){var s=r[a].split("=");t[s[0]]=s[1]}return t},convertObjToParam:function(e){var t=[];for(var r in e)t.push(r+"="+e[r]);return t.join("&")},setUserHeadIcon:function(e,t,r){var a;switch(t){case"man0":case"man1":case"man2":case"man3":a="single-man";break;case"woman0":a="single-cute";break;case"woman1":a="single-meng";break;case"woman2":case"woman3":a="single-nextMM";break;default:if("produce"!==getGI("model"))a="single-man";else{var s=t;cc.loader.load(s,function(t,r){var a=new cc.SpriteFrame(r);e.getComponent(cc.Sprite).spriteFrame=a,e.width=72,e.height=72})}}a&&(e.getComponent(cc.Sprite).spriteFrame=r.getSpriteFrame(a))},convertOutCardClick:function(e){switch(e.operateName){case"hu":return{t:window.messageType.hu,from:e.from,c:e.operateCard};case"chi":return{t:window.messageType.chi,from:e.from,c:e.operateCard,m:e.cards};case"pong":return{t:window.messageType.pong,from:e.from,c:e.operateCard,m:[e.operateCard,e.operateCard]};case"mingGang":return{t:window.messageType.mingGang,from:e.from,c:e.operateCard,m:[e.operateCard,e.operateCard,e.operateCard]};case"buGang":return{t:window.messageType.buGang,index:e.index,from:e.from,c:e.operateCard,m:[e.operateCard]};case"specialBuGang":return{t:window.messageType.specialBuGang,index:e.index,from:e.from,c:e.operateCard,m:[e.operateCard]}}},convertMingCard:function(e){for(var t=[],r=0;r<e.length;r++){var a={};switch(a.operateName=e[r].type,a.operateCard=e[r].cardName,a.from=e[r].msg.from,a.operateName){case"buGang":a.index=r;break;case"chi":case"specialGang":a.cards=e[r].msg.cards}t.push(a)}return t},alertToggleAni:function(e,t,r,a){if(this.data&&this.data.aniArr)if(this.data.alertAniFinished){this.data.aniArr.shift(),this.data.alertAniFinished=!1;var s=t.scaleX;r?(t.setScale(.4*s),t.opacity=100,e.active=!0,t.runAction(cc.sequence(cc.spawn(cc.sequence(cc.scaleTo(.2,1.02*s).easing(cc.easeQuarticActionOut()),cc.delayTime(.05),cc.scaleTo(.06,s).easing(cc.easeInOut(1))),cc.fadeTo(.2,255)),cc.callFunc(function(){this.data.alertAniFinished=!0,a&&a()},this)))):t.runAction(cc.sequence(cc.spawn(cc.scaleTo(.2,.4*s),cc.fadeTo(.2,100)),cc.callFunc(function(){e.active=!1,t.setScale(s),this.data.alertAniFinished=!0,a&&a()},this)))}else{var i=!0,o=this.data.aniArr[this.data.aniArr.length-1];if(o&&o.length===arguments.length)for(var n=0;n<arguments.length;n++){arguments[n]!==o[n],i=!1;break}else i=!1;if(i)return;if(this.data.aniArr.length>5&&this.resetData(),this.data.aniArr.push(arguments),null===this.data.timer){var c=this;this.data.timer=setInterval(function(){c.data.alertAniFinished&&c.data.aniArr.length>0&&c.alertToggleAni.apply(c,c.data.aniArr[0]),c.data.aniArr.length<=0&&(clearInterval(c.data.timer),c.data.timer=null)},200)}}},replaceShareUrl:function(e){if("produce"===getGI("model")){var t=getGI("shareConfig");if(!t)return void(this.timer1=setTimeout(function(){n.replaceShareUrl(e)},500));clearTimeout(this.timer1);var r="洮南麻将非常非常的好玩，大家快来玩呀 ";if("wx"===e)t.link=t.link.replace(/state=\d{6}/,"state=wx"),t.title="【"+clientUser.attr("nickName")+"】邀请你一起来玩 【洮南麻将】",t.desc=r;else if("number"==typeof e||"string"==typeof e)t.link=t.link.replace("state=wx","state="+e),t.title="【"+clientUser.attr("nickName")+"】邀请你加入房间："+room.roomId+" - 【洮南麻将】",t.desc=r+this._getArithmeticStr_();else if("object"===("undefined"==typeof e?"undefined":a(e))){e.sort(function(e,t){return t.score-e.score});var s="",i="大赢家-",o=e[0].score;o=o>0?"+"+o:o;for(var c=0;c<e.length;c++){var h=e[c];h.score=h.score>0?"+"+h.score:h.score,h.score===o?i+=h.name+":"+o+"分 ":s+=h.name+":"+h.score+"分 "}t.title=i,t.desc=s+this._getArithmeticStr_(),t.link=t.link.replace(/state=\d{6}/,"state=wx")}else t.title="【"+clientUser.attr("nickName")+"】邀请你一起来玩 【洮南麻将】",t.desc=r}},_getArithmeticStr_:function(){var e=room.attr({is40Arithmetic:null,isPromise:null,isAllowXuanFeng:null,isAllowYaoJiu:null,isAllowBaiJiu:null}),t=[];for(var r in e)switch(r){case"is40Arithmetic":e.is40Arithmetic&&t.push("40算法");break;case"isPromise":e.isPromise&&t.push("责任制");break;case"isAllowXuanFeng":e.isAllowXuanFeng&&t.push("旋风杠");break;case"isAllowYaoJiu":e.isAllowYaoJiu&&t.push("幺九杠");break;case"isAllowBaiJiu":e.isAllowBaiJiu&&t.push("白八九杠")}0===t.length&&t.push("普通");var a="玩法："+t.join("，");return a},createSocket:function(e,t){"reLink"===t&&window.socket||(window.socket=new s({ID:0,procotolObj:window.messageType}),window.socket.setControllerMap(new i({controllerMap:window.controllerMap})),window.msgCache=new o(window.socket.controllerMap),window.socket.msgCache=window.msgCache),window.socket.openLink(getGI("socketURL")).success(function(){getGI("offlineAlert").showOfflineAlert("hide"),this.send(e)}).receiveMessage(function(e,t){this.msgCache.pushMsg(e)}).error(function(){getGI("offlineAlert").showOfflineAlert("show")}).close(function(){room&&clientUser.sleep()})}};window.TOOL=n,cc._RFpop()},{controllerMap:"controllerMap",msgCache:"msgCache",sendMessageMng:"sendMessageMng"}],userBase:[function(e,t,r){"use strict";cc._RFpush(t,"d7df1ntA/JALYuP2zBOvFXb","userBase");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("combination"),i=e("mahjongMng"),o=e("calcScore"),n=logConfig(4),c=cc.Class({name:"UserBase","extends":s,ctor:function(){var e=arguments[0];this.combination([{name:"userInfo",combineType:"data",type:"class",config:e.attr},{name:"userState",combineType:"data",type:"class",config:e.attr}]),this.mahjongMng=null,this.calcScore=null,n.log1(this)},reset:function(){n.log1("执行了userBase.reset方法"),this.reset_other(),this.mahjongMng&&this.mahjongMng.reset(),this.calcScore&&this.calcScore.reset()},resetJu:function(){this.mahjongMng=null,this.calcScore=null,this.remove(["userResource","userHeadShow","userMsgShow"])},sleep:function(){this.mahjongMng&&(this.attr("isCanPlay",this.mahjongMng.mahView.outCardEventAttr("isCanPlay")),this.mahjongMng.mahView.outCardEventAttr("isCanPlay",!1)),this.attr("isCanOperateClick",!1)},wake:function(){this.mahjongMng&&this.mahjongMng.mahView.outCardEventAttr("isCanPlay",this.attr("isCanPlay")),this.attr("isCanOperateClick",!0)},inCard:function(e,t,r){audio.play("tray"),console.log("执行了userBase.inCard"+e+","+t),this.mahjongMng.inCard(e,r),room.displayRoomInfo("restCardNum","剩"+t+"张")},outCard:function(e,t){var r=this;this.mahjongMng.outCard(e,t,function(){audio.play(r.attr("whoseVoice"),e)}),this.attr("haveCard")&&(this.send({message:e,type:"outCard"}),room.displayPointer(-1),clientUser.attr("chooseIten",null)),this.attr("firstOutCard")||this.attr("firstOutCard",e)},outCardNoChange:function(e,t){this.mahjongMng.rebuildOutCard(e,t),room.msgIsMeSend(t)&&(room.displayPointer(-1),clientUser.attr("chooseIten",null)),this.attr("firstOutCard")||this.attr("firstOutCard",e)},othersBuGangCheck:function(e){var t,r=e.message,a=this.mahjongMng.mahModel.checkHasHu(r.operateCard),s=this.mahjongMng.mahModel.checkPong(r.operateCard);if(s.length>0){t=s;for(var i=0;i<t.length;i++)t[i].from=r.from}else t=[];if(t.unshift({operateName:"guo",from:r.from}),a&&t.push({operateName:"hu",operateCard:r.operateCard,from:r.from}),t.length>1)if(this.attr("ting")&&a){this.send({message:TOOL.convertOutCardClick({operateName:"hu",operateCard:r.operateCard,from:r.from}),type:"operateClick"}),this.send({message:{huCard:r.operateCard,from:r.from},type:"hu"}),this.mahjongMng.mahView.outCardEventAttr("isCanOperate",!1);var o={huCard:r.operateCard,cardFrom:r.from,huType:"jiePao"};this.attr("huInfoArr").push(o)}else this.attr("finishCheckClick",!1),this.attr("operateArr",t),this.mahjongMng.showPanel(t);else this.send({type:"operateClick"})},outCardCheck:function(e,t){var r=this.mahjongMng.checkCard(e,t,{isCalcHu:!1,isCheckHu:!0,isCheckChi:0===room.getNextActiveIndex(),isCheckLiangGang:!1});r.hasOpt?r.ting?r.isCanHu?(this.send({message:TOOL.convertOutCardClick({operateName:"hu",operateCard:e,from:t}),type:"operateClick"}),this.mahjongMng.mahView.outCardEventAttr("isCanOperate",!1)):this.send({type:"operateClick"}):(this.attr("finishCheckClick",!1),this.mahjongMng.showPanel(r.optArr)):this.send({type:"operateClick"})},showPanel:function(e){this.mahjongMng.showPanel(e)},showCards:function(e){this.mahjongMng.setCards.apply(this.mahjongMng,arguments),this.attr("originalCards",e.originalCardsHand),this.attr("haveCard","object"===a(e.originalCardsHand))},displayAllCards:function(e,t,r){this.mahjongMng.displayAllCards(e,t,r),this.attr("originalCards",e.handCardArr),this.attr("haveCard",this.attr("isClient"))},combineSend:function(e){this.attr("isHasCombined")||e||(this.sendMessageMng=socket.setID(this.attr("openId")),this.send=function(e){return this.sendMessageMng.send(e),this})},combineAction:function(){n.log1("执行了 userBase - combineAction。。"),console.log("结合了combineAction"),this.combination([{name:"userResource",combineType:"data",type:"class",config:{userSelf:this}},{name:"userHeadShow",combineType:"method",type:"class",config:{userSelf:this}},{name:"userMsgShow",combineType:"method",type:"class",config:{userSelf:this}}])},combineMahjong:function(e){n.log1("执行了 userBase - combineMahjong。。"),this.attr("isHasCombined",!0),this.mahjongMng=new i({userSelf:this}),this.calcScore=new o({userSelf:this}),e&&this.mahjongMng.displayAllMing(e)}});t.exports=c,cc._RFpop()},{calcScore:"calcScore",combination:"combination",mahjongMng:"mahjongMng"}],userCard0:[function(e,t,r){"use strict";cc._RFpush(t,"ae04aD8MxJID7CN5klZp+7B","userCard0");var a=[[[2,0,0,0],[0,2,0],[1,1,1,0,0,0,0,0,0],[0,1,1,1,0,3,0,1,0],[0,0,0,0,0,0,0,0,0]]];a.napaiArr=[["o1","w8","t1","o7","t5","z"]],a.operateArr=[{cardName:"e",type:"pong",msg:{from:0}}],t.exports=a,cc._RFpop()},{}],userCard1:[function(e,t,r){"use strict";cc._RFpush(t,"41b3ahCvHxH06+eXmDATZTs","userCard1");var a=[[[0,1,1,0],[0,1,0],[0,0,3,0,3,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,1,1,0,1,0,0,0,0]]];a.napaiArr=[["x","n","t9","t7","t6","w6","w6","z"]],a.operateArr=[{cardName:"e",type:"pong",msg:{from:0}}],t.exports=a,cc._RFpop()},{}],userCard2:[function(e,t,r){"use strict";cc._RFpush(t,"a5e7e9xkfRNK5Z9tq71OlN2","userCard2");var a=[[[1,0,0,0],[0,0,3],[0,0,0,0,2,1,1,0,0],[0,0,1,0,3,0,0,0,0],[0,0,0,0,1,0,0,0,0]]];a.napaiArr=[["o3","b","e","t5","w3"]],a.operateArr=[{cardName:"e",type:"pong",msg:{from:0}}],t.exports=a,cc._RFpop()},{}],userCard3:[function(e,t,r){"use strict";cc._RFpush(t,"01598JtHYFDOIXxh1tkyA/f","userCard3");var a=[[[1,0,0,0],[0,1,1],[0,0,1,0,0,0,0,0,3],[0,0,1,0,2,0,0,0,0],[0,0,1,0,0,0,0,0,2]]];a.napaiArr=[["x","w3","n","w2","t8","t7","s"]],a.operateArr=[{cardName:"e",type:"pong",msg:{from:0}}],t.exports=a,cc._RFpop()},{}],userHeadShow:[function(e,t,r){"use strict";cc._RFpush(t,"7c23eJkn+FB14p4ARAKyyS7","userHeadShow");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=logConfig(4),i=cc.Class({name:"UserHeadShow",ctor:function(){var e=arguments[0];this.userNode=e.userSelf.attr("userHeadNode"),this.mainGame_Atlas=getGI("roomGlobalRes").mainGame_Atlas},reset:function(){s.log4("userHeadShow.js重置了。")},displayHead:function(e,t){if(s.log3("执行了displayHead",e,t),"object"===("undefined"==typeof e?"undefined":a(e)))for(var r in e)this._setOneAttrDisplay_(r,e[r]);else this._setOneAttrDisplay_(e,t)},_setOneAttrDisplay_:function(e,t){switch(e){case"zhuang":cc.find("headBack/zhuang",this.userNode).active="show"===t;break;case"faceIcon":TOOL.setUserHeadIcon(this.userNode,t,this.mainGame_Atlas);break;case"nickName":var r=this.userNode.getChildByName("nick");this._setNick_(r,t);break;case"ting":cc.find("headBack/ting",this.userNode).active="show"===t;break;case"score":var r=cc.find("raidal/preScore",this.userNode);this._setScore_(r,t);break;case"ok":this.userNode.getChildByName("status").active="show"===t;break;case"leaveLine":cc.find("headBack/isOnline",this.userNode).active="show"===t}},_setNick_:function(e,t){"show"===t?e.active=!0:"hide"===t?e.active=!1:(e.active=!0,e.getComponent(cc.Label).string=(t>0?"+":"")+t)},_setScore_:function(e,t){"show"===t?e.parent.active=!0:"hide"===t?e.parent.active=!1:(e.parent.active=!0,e.getComponent(cc.Label).string=(t>0?"+":"")+t)}});t.exports=i,cc._RFpop()},{}],userInfoAlert:[function(e,t,r){"use strict";cc._RFpush(t,"e96c3rwIQxEs4aUyFi8MDhy","userInfoAlert");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};cc.Class({"extends":cc.Component,properties:{atlas:cc.SpriteAtlas},onLoad:function(){this.headNode=null},showUserInfoAlertClick:function(e,t){audio.play("waterClick");var r=t.split(",");if(t=r[0],"show"===t){var a;switch(r[1]){case"hall":a=clientUser;break;case"room":a=room.getUser(parseInt(e.target.name.slice(-1)))}if(this.headNode=cc.find("alertContent/headBox/headIcon",this.node),!a)return;var s=a.attr({nickName:null,userId:null,ip:null,faceIcon:null});this.setserInfoAlertData(s)}this.isShow="show"===t,TOOL.alertToggleAni(this.node,this.node.getChildByName("alertContent"),this.isShow)},setserInfoAlertData:function(e,t){if("object"===("undefined"==typeof e?"undefined":a(e))){var r=e;for(var s in r)this._showOne_(s,r[s])}else this._showOne_(e,t)},_showOne_:function(e,t){var r;switch(e){case"faceIcon":return void TOOL.setUserHeadIcon(this.headNode,t,this.atlas);case"nickName":r="nick";break;case"userId":r="ID",t="ID: "+t;break;case"ip":r="Ip",t="IP: "+t}cc.find("alertContent/headBox/"+r,this.node).getComponent(cc.Label).string=t}}),cc._RFpop()},{}],userInfo:[function(e,t,r){"use strict";cc._RFpush(t,"d89fb/sqmpEgo7yOF4rOjlJ","userInfo");var a=logConfig(4),s=cc.Class({name:"UserInfo",ctor:function(){var e=arguments[0];if(this.faceIcon="",this.nickName="",this.openId="",this.userId=0,this.roomCards=0,this.ip="",this.joinOrder=0,this.positionOrder=0,this.sex="man",this.whoseVoice="m1",this.state=0,this.haveCard=!1,this.isClient=!1,this.isActive=!1,this.isHasCombined=!1,e)for(var t in e)void 0!==this[t]&&(this[t]=e[t])},reset:function(){a.log1("userInfo.js重置了。。"),this.isActive=!1}});t.exports=s,cc._RFpop()},{}],userMsgShow:[function(e,t,r){"use strict";cc._RFpush(t,"513c4gmhmtO644BzZ7cmUC3","userMsgShow");var a=(logConfig(4),cc.Class({name:"UserMsgShow",ctor:function(){var e=arguments[0];this.userNode=e.userSelf.attr("userHeadNode"),this.roomComponent=getGI("roomGlobalRes"),this.face_Atlas=e.userSelf.attr("face_Atlas"),this.msgShowTime=3},say:function(e){"show"===e?this._setMsgState_(!0):"hide"===e?this._setMsgState_(!1):"face"===e.type?this._showFace_(e.value):"word"===e.type&&this._showMsg_(e.value)},_setMsgState_:function(e){this.userNode.getChildByName("msgAlert").active=e},_showFace_:function(e){var t=this;this.roomComponent.scheduleOnce(function(){t._setMsgState_(!1)},this.msgShowTime),this.userNode.getChildByName("msgAlert").active=!0;var r=cc.find("msgAlert/face",this.userNode);r.getComponent(cc.Sprite).spriteFrame=this.face_Atlas.getSpriteFrame(e),r.active=!0,cc.find("msgAlert/word",this.userNode).active=!1},_showMsg_:function(e){var t=this;this.roomComponent.scheduleOnce(function(){t._setMsgState_(!1)},this.msgShowTime),!this.userNode.getChildByName("msgAlert"),this.userNode.getChildByName("msgAlert").active=!0;var r=cc.find("msgAlert/word",this.userNode);r.getComponent(cc.Label).string=e,r.active=!0,cc.find("msgAlert/face",this.userNode).active=!1}}));t.exports=a,cc._RFpop()},{}],userNapai:[function(e,t,r){"use strict";cc._RFpush(t,"6bb7adUYvpHeYyJjC1YTe82","userNapai");var a=[["z","w2","t6","t9","t8","t6","z","w2","t7"]];t.exports=a,cc._RFpop()},{}],userResource:[function(e,t,r){"use strict";cc._RFpush(t,"1f57aL++OVH7LGfFkHis4V8","userResource");var a=cc.Class({name:"UserResource",ctor:function(){var e=arguments[0],t=e.userSelf.attr("positionOrder"),r=getGI("roomGlobalRes");switch(this.playingLayer=r.playingLayer,this.userNode=this.playingLayer.getChildByName("user"+t),this.showNode=this.userNode.getChildByName("show"),this.handNode=this.userNode.getChildByName("hand"),this.userHeadNode=cc.find("Canvas/bg/user"+t),this.numJiao=r["numJiao"+t],t){case 0:case 2:this.cards_Atlas=r.MTCards_Atlas;break;case 1:this.cards_Atlas=r.LCards_Atlas;break;case 3:this.cards_Atlas=r.RCards_Atlas}if(this.gameMain_Atlas=r.mainGame_Atlas,this.others_Atlas=r.others_Atlas,this.face_Atlas=r.face_Atlas,e)for(var a in e)void 0!==this[a]&&(this[a]=e[a])}});t.exports=a,cc._RFpop()},{}],userStateBase:[function(e,t,r){"use strict";cc._RFpush(t,"3f9b2oofvZP3I/SIuj3K2kU","userStateBase");var a=logConfig(4),s=cc.Class({name:"UserStateBase",ctor:function(){var e=arguments[0];if(this.zhuang=!1,this.ting=!1,this.originalCards=null,this.currentScore=0,this.roomScore=0,this.isReady=!1,e)for(var t in e)void 0!==this[t]&&(this[t]=e[t])},reset:function(){a.log1("userStateBase.js重置了。。"),this.zhuang=!1,this.ting=!1,this.originalCards=null,this.isReady=!1}});t.exports=s,cc._RFpop()},{}],userState:[function(e,t,r){"use strict";cc._RFpush(t,"51c1c3KImhMEb0MfsdBTpW5","userState");var a=e("userStateBase"),s=logConfig(4),i=cc.Class({name:"UserState","extends":a,ctor:function(){var e=arguments[0];if(this.cardsHandOrder={},this.firstOutCard="",this.finishCheckClick=!0,this.huInfoArr=[],this.naPaiInfo={cardName:""},this.operateArr=null,this.chooseIten=null,this.isCanPlay=!1,this.isCanOperateClick=!0,e)for(var t in e)void 0!==this[t]&&(this[t]=e[t])},reset:function(){s.log1("userState.js重置了。。"),this._super(),this.firstOutCard="",this.finishCheckClick=!0,this.huInfoArr.length=0,this.operateArr=null,this.chooseIten=null,this.isCanPlay=!1,this.isCanOperateClick=!0,this.naPaiInfo={cardName:""}}});t.exports=i,cc._RFpop()},{userStateBase:"userStateBase"}],usersCard:[function(e,t,r){"use strict";cc._RFpush(t,"934cdpAnZNAvpLC5HhxQSlN","usersCard");var a={user0:[[0,0,0,0],[0,0,0],[0,3,0,1,1,1,0,0,0],[0,1,1,1,0,0,0,0,2],[1,1,1,0,0,0,0,0,0]],user0Cards:["o4","o5","w3","o7","t5","z","o8","o2","z","w3"],user0Operate:[],user3:[[0,0,0,0],[0,3,0],[1,0,1,1,1,0,0,0,0],[0,0,0,0,0,1,1,1,0],[0,3,0,0,0,0,0,0,0]],user3Cards:["o1","o1","t5","w2","t8","t7","o2","x","w1","t3","t4","n"],user3Operate:[],user2:[[0,0,0,0],[0,0,0],[3,0,0,0,1,1,1,0,0],[0,0,0,0,2,0,0,1,0],[2,0,0,0,0,3,0,0,0]],user2Cards:["t8","t5","e","t5","w3","t8","t8","z","w5","w5","t7","b"],user2Operate:[],user1:[[0,0,0,0],[0,0,2],[0,0,1,1,1,0,2,0,0],[1,1,1,0,0,0,0,0,0],[0,0,3,0,0,0,0,0,0]],user1Cards:["b","z","t9","t7","t6","w6","w6","z","t5","t1","w9"],user1Operate:[],globalCards:["z","w2","t6","t9","t8","t6","z","w2","t7"]};t.exports=a,cc._RFpop()},{}],user:[function(e,t,r){"use strict";cc._RFpush(t,"0dbeag/FOpClK1qaAd40OYK","user");var a=logConfig(4),s=e("userBase"),i=cc.Class({name:"User","extends":s,ctor:function(){},_getHuObj_:function(e){var t={cardsShow:null,handCards:null,huType:null,type:null};return t.cardsShow=this.mahjongMng.mahModel.getCardsOperateArr(),t.huType=this.calcScore.getHuType(),t.type=this.calcScore.getType(e),t.handCards=this.mahjongMng.mahModel.cardsHandConvertToArr(),t},juEnd:function(e){a.log1("发送了一局结束的消息"),room.displayPointer(-1);var t=this._getHuObj_(e);this.send({message:t,type:"juScore"}),a.log1("胡牌的最终数据",clientUser.attr("huInfoArr"))},_pong_:function(e){audio.play(this.attr("whoseVoice"),"pong"),room.getUser(e.from).backOutCard()},_chi_:function(e){audio.play(this.attr("whoseVoice"),"chi"),room.getUser(e.from).backOutCard()},_specialGang_:function(e){audio.play(this.attr("whoseVoice"),"gang")},_mingGang_:function(e){audio.play(this.attr("whoseVoice"),"gang"),room.getUser(e.from).backOutCard(),this.attr("haveCard")&&this.send({type:"napai"})},_anGang_:function(e){audio.play(this.attr("whoseVoice"),"gang"),this.attr("haveCard")&&(this.send({type:e.operateName,message:e}),this.send({type:"napai"}))},_specialBuGang_:function(e){audio.play(this.attr("whoseVoice"),"gang"),this.attr("haveCard")&&this.send({type:"napai"})},_buGang_:function(e){audio.play(this.attr("whoseVoice"),"gang"),this.attr("haveCard")&&this.send({type:"napai"})},_ting_:function(e){audio.play(this.attr("whoseVoice"),"ting")},_hu_:function(e,t){if(audio.play(this.attr("whoseVoice"),"hu"),this.attr("isClient")){var r=this.attr("huInfoArr");if("fromMe"===e.cardFromWho){var a=this.attr("naPaiInfo");r.push({huCard:a.cardName,cardFrom:this.attr("openId"),huType:"zimo"}),!t&&this.send({message:{huCard:a.cardName,from:this.attr("openId")},type:"hu"})}else{var s={huCard:e.operateCard,cardFrom:e.from,huType:"jiePao"};r.push(s)}}},operateItem:function(e){this._choose_(e),this.mahjongMng.operateItem(e)},_choose_:function(e){var t=e.operateName;switch(t){case"pong":this._pong_(e);break;case"chi":this._chi_(e);break;case"specialGang":this._specialGang_(e);break;case"specialBuGang":this._specialBuGang_(e);break;case"guo":break;case"mingGang":this._mingGang_(e);break;case"anGang":this._anGang_(e);break;case"buGang":this._buGang_(e);break;case"ting":this._ting_(e);break;case"hu":this._hu_(e)}},backOutCard:function(){var e=this.mahjongMng.mahView.operateOutCard("backward");"chiangBuGang"!==e&&room.finishOutSkipAni()}});t.exports=i,cc._RFpop()},{userBase:"userBase"}]},{},["audioMng","audioPlay","ajax","combination","conditions","global","log","messageConfig","msgCache","napaiMng","randomCards","userCard0","userCard1","userCard2","userCard3","userNapai","usersCard","tools","_node_hall_click","inputNumPanel","node_hall_display","node_recordAlert","_node_login","controllerMap","mahjongMng","mahjongMngBase","buGangCheck_controller","dismiss_controller","error_controller","isOnline_controller","join_controller","juEnd_controller","msgSend_controller","napai_controller","operate_controller","outCard_controller","rebuild_controller","rebuild_msg_controller","record_controller","share_controller","start_controller","sendMessageMng","user","userBase","calcScore","handCards","handCardsBase","operateCards","outCards","calcHuMngFlow","cardFace","cardFace_common","calcHuMng","cardsHu_other","cardsHu_pair","cardsMng","calcHuType","cardsAll","handCardsChild","operateCards_operate","outCards_operate","room","roomData","userInfo","userResource","userState","userStateBase","dismissAlert_click","dismissAlert_display","messageAlert_click","messageAlert_display","offlineAlert","resultAlert_click","resultAlert_display","settingAlert","singleResult_click","singleResult_display","userInfoAlert","_node_operatePanelEvent","hand_outCardEvent","roomDisplay","roomGlobalRes","animate_countDown","animate_head","animate_skip","room_click","animate_operate","animate_outCard","cardHandMng","hand_operatePanel","hand_otherDisplay","mingCardMng","outCardMng","userHeadShow","userMsgShow","farServer","localServer","serverMng"]);